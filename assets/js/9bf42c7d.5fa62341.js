"use strict";(self.webpackChunkmy_wiki=self.webpackChunkmy_wiki||[]).push([[4619],{3905:(n,a,t)=>{t.d(a,{Zo:()=>s,kt:()=>d});var e=t(7294);function r(n,a,t){return a in n?Object.defineProperty(n,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[a]=t,n}function o(n,a){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);a&&(e=e.filter((function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),t.push.apply(t,e)}return t}function i(n){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){r(n,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(t,a))}))}return n}function c(n,a){if(null==n)return{};var t,e,r=function(n,a){if(null==n)return{};var t,e,r={},o=Object.keys(n);for(e=0;e<o.length;e++)t=o[e],a.indexOf(t)>=0||(r[t]=n[t]);return r}(n,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(e=0;e<o.length;e++)t=o[e],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var l=e.createContext({}),N=function(n){var a=e.useContext(l),t=a;return n&&(t="function"==typeof n?n(a):i(i({},a),n)),t},s=function(n){var a=N(n.components);return e.createElement(l.Provider,{value:a},n.children)},p={inlineCode:"code",wrapper:function(n){var a=n.children;return e.createElement(e.Fragment,{},a)}},u=e.forwardRef((function(n,a){var t=n.components,r=n.mdxType,o=n.originalType,l=n.parentName,s=c(n,["components","mdxType","originalType","parentName"]),u=N(t),d=r,T=u["".concat(l,".").concat(d)]||u[d]||p[d]||o;return t?e.createElement(T,i(i({ref:a},s),{},{components:t})):e.createElement(T,i({ref:a},s))}));function d(n,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof n||r){var o=t.length,i=new Array(o);i[0]=u;var c={};for(var l in a)hasOwnProperty.call(a,l)&&(c[l]=a[l]);c.originalType=n,c.mdxType="string"==typeof n?n:r,i[1]=c;for(var N=2;N<o;N++)i[N]=t[N];return e.createElement.apply(null,i)}return e.createElement.apply(null,t)}u.displayName="MDXCreateElement"},1472:(n,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>N});var e=t(7462),r=(t(7294),t(3905));const o={},i="Nacos\u96c6\u7fa4\u642d\u5efa",c={unversionedId:"SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/Nacos\u96c6\u7fa4\u642d\u5efa",id:"SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/Nacos\u96c6\u7fa4\u642d\u5efa",title:"Nacos\u96c6\u7fa4\u642d\u5efa",description:"Nacos\u751f\u4ea7\u73af\u5883\u4e0b\u4e00\u5b9a\u8981\u90e8\u7f72\u4e3a\u96c6\u7fa4\u72b6\u6001",source:"@site/docs/SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/02-Nacos\u96c6\u7fa4\u642d\u5efa.md",sourceDirName:"SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406",slug:"/SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/Nacos\u96c6\u7fa4\u642d\u5efa",permalink:"/MyWiki/docs/SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/Nacos\u96c6\u7fa4\u642d\u5efa",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/02-Nacos\u96c6\u7fa4\u642d\u5efa.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Nacos\u914d\u7f6e\u7ba1\u7406",permalink:"/MyWiki/docs/SpringCloud Alibaba/Nacos\u914d\u7f6e\u7ba1\u7406/Nacos\u7edf\u4e00\u914d\u7f6e\u7ba1\u7406"},next:{title:"seata\u5206\u5e03\u5f0f\u4e8b\u52a1",permalink:"/MyWiki/docs/category/seata\u5206\u5e03\u5f0f\u4e8b\u52a1"}},l={},N=[{value:"\u96c6\u7fa4\u7ed3\u6784\u56fe",id:"\u96c6\u7fa4\u7ed3\u6784\u56fe",level:2},{value:"\u5b98\u65b9\u7ed9\u51fa\u7684Nacos\u96c6\u7fa4\u56fe",id:"\u5b98\u65b9\u7ed9\u51fa\u7684nacos\u96c6\u7fa4\u56fe",level:3},{value:"\u4f7f\u7528Nginx\u505a\u8d1f\u8f7d\u5747\u8861\u5668\u540e\u7684Nacos\u96c6\u7fa4\u56fe",id:"\u4f7f\u7528nginx\u505a\u8d1f\u8f7d\u5747\u8861\u5668\u540e\u7684nacos\u96c6\u7fa4\u56fe",level:3},{value:"\u6b65\u9aa4",id:"\u6b65\u9aa4",level:2},{value:"\u521d\u59cb\u5316\u6570\u636e\u5e93",id:"\u521d\u59cb\u5316\u6570\u636e\u5e93",level:3},{value:"\u4e0b\u8f7dnacos",id:"\u4e0b\u8f7dnacos",level:3},{value:"\u914d\u7f6eNacos",id:"\u914d\u7f6enacos",level:3},{value:"\u5728nacos\u7684conf\u76ee\u5f55\uff1a",id:"\u5728nacos\u7684conf\u76ee\u5f55",level:4},{value:"\u4fee\u6539conf\u76ee\u5f55\u4e0b\u7684application.properties\u6587\u4ef6",id:"\u4fee\u6539conf\u76ee\u5f55\u4e0b\u7684applicationproperties\u6587\u4ef6",level:4},{value:"\u542f\u52a8Nacos",id:"\u542f\u52a8nacos",level:3},{value:"Nginx\u53cd\u5411\u4ee3\u7406",id:"nginx\u53cd\u5411\u4ee3\u7406",level:3},{value:"\u4fee\u6539Nacos\u4e3a\u96c6\u7fa4\u6a21\u5f0f",id:"\u4fee\u6539nacos\u4e3a\u96c6\u7fa4\u6a21\u5f0f",level:3},{value:"\u4fee\u6539\u4ee3\u7801",id:"\u4fee\u6539\u4ee3\u7801",level:3},{value:"\u4f18\u5316",id:"\u4f18\u5316",level:2}],s={toc:N};function p(n){let{components:a,...t}=n;return(0,r.kt)("wrapper",(0,e.Z)({},s,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"nacos\u96c6\u7fa4\u642d\u5efa"},"Nacos\u96c6\u7fa4\u642d\u5efa"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Nacos\u751f\u4ea7\u73af\u5883\u4e0b\u4e00\u5b9a\u8981\u90e8\u7f72\u4e3a\u96c6\u7fa4\u72b6\u6001")),(0,r.kt)("h2",{id:"\u96c6\u7fa4\u7ed3\u6784\u56fe"},"\u96c6\u7fa4\u7ed3\u6784\u56fe"),(0,r.kt)("h3",{id:"\u5b98\u65b9\u7ed9\u51fa\u7684nacos\u96c6\u7fa4\u56fe"},"\u5b98\u65b9\u7ed9\u51fa\u7684Nacos\u96c6\u7fa4\u56fe"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220204134928986.png?raw=true",alt:"image-20220204134928986"})),(0,r.kt)("p",null,"\u5176\u4e2d\u5305\u542b3\u4e2anacos\u8282\u70b9\uff0c\u7136\u540e\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\u4ee3\u74063\u4e2aNacos\u3002\u8fd9\u91cc\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u4f7f\u7528nginx\u3002"),(0,r.kt)("h3",{id:"\u4f7f\u7528nginx\u505a\u8d1f\u8f7d\u5747\u8861\u5668\u540e\u7684nacos\u96c6\u7fa4\u56fe"},"\u4f7f\u7528Nginx\u505a\u8d1f\u8f7d\u5747\u8861\u5668\u540e\u7684Nacos\u96c6\u7fa4\u56fe"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220204135141189.png?raw=true",alt:"image-20220204135141189"})),(0,r.kt)("p",null,"\u5728\u4e00\u53f0\u7535\u8111\u4e0a\u6a21\u62df\u4e09\u4e2anacos\u8282\u70b9\uff0c\u5b9e\u9645\u73af\u5883\u4e2d\u4e09\u4e2a\u8282\u70b9\u5e94\u5bf9\u5e94\u4e09\u53f0\u670d\u52a1\u5668"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u8282\u70b9"),(0,r.kt)("th",{parentName:"tr",align:null},"ip"),(0,r.kt)("th",{parentName:"tr",align:null},"port"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"nacos1"),(0,r.kt)("td",{parentName:"tr",align:null},"xxx.xxx.xxx.xxx"),(0,r.kt)("td",{parentName:"tr",align:null},"8845")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"nacos2"),(0,r.kt)("td",{parentName:"tr",align:null},"xxx.xxx.xxx.xxx"),(0,r.kt)("td",{parentName:"tr",align:null},"8846")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"nacos3"),(0,r.kt)("td",{parentName:"tr",align:null},"xxx.xxx.xxx.xxx"),(0,r.kt)("td",{parentName:"tr",align:null},"8847")))),(0,r.kt)("h2",{id:"\u6b65\u9aa4"},"\u6b65\u9aa4"),(0,r.kt)("p",null,"\u642d\u5efa\u96c6\u7fa4\u7684\u57fa\u672c\u6b65\u9aa4\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u642d\u5efa\u6570\u636e\u5e93\uff0c\u521d\u59cb\u5316\u6570\u636e\u5e93\u8868\u7ed3\u6784"),(0,r.kt)("li",{parentName:"ul"},"\u4e0b\u8f7dnacos\u5b89\u88c5\u5305"),(0,r.kt)("li",{parentName:"ul"},"\u914d\u7f6enacos"),(0,r.kt)("li",{parentName:"ul"},"\u542f\u52a8nacos\u96c6\u7fa4"),(0,r.kt)("li",{parentName:"ul"},"nginx\u53cd\u5411\u4ee3\u7406")),(0,r.kt)("h3",{id:"\u521d\u59cb\u5316\u6570\u636e\u5e93"},"\u521d\u59cb\u5316\u6570\u636e\u5e93"),(0,r.kt)("p",null,"Nacos\u9ed8\u8ba4\u6570\u636e\u5b58\u50a8\u5728\u5185\u5d4c\u6570\u636e\u5e93Derby\u4e2d\uff0c\u4e0d\u5c5e\u4e8e\u751f\u4ea7\u53ef\u7528\u7684\u6570\u636e\u5e93\u3002\u5b98\u65b9\u63a8\u8350\u7684\u6700\u4f73\u5b9e\u8df5\u662f\u4f7f\u7528\u5e26\u6709\u4e3b\u4ece\u7684\u9ad8\u53ef\u7528\u6570\u636e\u5e93\u96c6\u7fa4\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee5\u5355\u70b9\u7684\u6570\u636e\u5e93\u4e3a\u4f8b\u3002"),(0,r.kt)("p",null,"\u65b0\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u547d\u540d\u4e3anacos\uff0c\u7136\u540e\u6267\u884c\u4e0b\u5217sql\u8bed\u53e5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mysql"},"CREATE TABLE `config_info` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(255) DEFAULT NULL,\n  `content` longtext NOT NULL COMMENT 'content',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  `app_name` varchar(128) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  `c_desc` varchar(256) DEFAULT NULL,\n  `c_use` varchar(64) DEFAULT NULL,\n  `effect` varchar(64) DEFAULT NULL,\n  `type` varchar(64) DEFAULT NULL,\n  `c_schema` text,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_aggr   */\n/******************************************/\nCREATE TABLE `config_info_aggr` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(255) NOT NULL COMMENT 'group_id',\n  `datum_id` varchar(255) NOT NULL COMMENT 'datum_id',\n  `content` longtext NOT NULL COMMENT '\u5185\u5bb9',\n  `gmt_modified` datetime NOT NULL COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `app_name` varchar(128) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u589e\u52a0\u79df\u6237\u5b57\u6bb5';\n\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_beta   */\n/******************************************/\nCREATE TABLE `config_info_beta` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL COMMENT 'content',\n  `beta_ips` varchar(1024) DEFAULT NULL COMMENT 'betaIps',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_beta';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_tag   */\n/******************************************/\nCREATE TABLE `config_info_tag` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT 'tenant_id',\n  `tag_id` varchar(128) NOT NULL COMMENT 'tag_id',\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL COMMENT 'content',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_tag';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_tags_relation   */\n/******************************************/\nCREATE TABLE `config_tags_relation` (\n  `id` bigint(20) NOT NULL COMMENT 'id',\n  `tag_name` varchar(128) NOT NULL COMMENT 'tag_name',\n  `tag_type` varchar(64) DEFAULT NULL COMMENT 'tag_type',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT 'tenant_id',\n  `nid` bigint(20) NOT NULL AUTO_INCREMENT,\n  PRIMARY KEY (`nid`),\n  UNIQUE KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`),\n  KEY `idx_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_tag_relation';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = group_capacity   */\n/******************************************/\nCREATE TABLE `group_capacity` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `group_id` varchar(128) NOT NULL DEFAULT '' COMMENT 'Group ID\uff0c\u7a7a\u5b57\u7b26\u8868\u793a\u6574\u4e2a\u96c6\u7fa4',\n  `quota` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u914d\u989d\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `usage` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u4f7f\u7528\u91cf',\n  `max_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u805a\u5408\u5b50\u914d\u7f6e\u6700\u5927\u4e2a\u6570\uff0c\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u805a\u5408\u6570\u636e\u7684\u5b50\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_history_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u6700\u5927\u53d8\u66f4\u5386\u53f2\u6570\u91cf',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_group_id` (`group_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u96c6\u7fa4\u3001\u5404Group\u5bb9\u91cf\u4fe1\u606f\u8868';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = his_config_info   */\n/******************************************/\nCREATE TABLE `his_config_info` (\n  `id` bigint(64) unsigned NOT NULL,\n  `nid` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `data_id` varchar(255) NOT NULL,\n  `group_id` varchar(128) NOT NULL,\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL,\n  `md5` varchar(32) DEFAULT NULL,\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `src_user` text,\n  `src_ip` varchar(50) DEFAULT NULL,\n  `op_type` char(10) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`nid`),\n  KEY `idx_gmt_create` (`gmt_create`),\n  KEY `idx_gmt_modified` (`gmt_modified`),\n  KEY `idx_did` (`data_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u591a\u79df\u6237\u6539\u9020';\n\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = tenant_capacity   */\n/******************************************/\nCREATE TABLE `tenant_capacity` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `tenant_id` varchar(128) NOT NULL DEFAULT '' COMMENT 'Tenant ID',\n  `quota` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u914d\u989d\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `usage` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u4f7f\u7528\u91cf',\n  `max_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u805a\u5408\u5b50\u914d\u7f6e\u6700\u5927\u4e2a\u6570',\n  `max_aggr_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u805a\u5408\u6570\u636e\u7684\u5b50\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_history_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u6700\u5927\u53d8\u66f4\u5386\u53f2\u6570\u91cf',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u79df\u6237\u5bb9\u91cf\u4fe1\u606f\u8868';\n\n\nCREATE TABLE `tenant_info` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `kp` varchar(128) NOT NULL COMMENT 'kp',\n  `tenant_id` varchar(128) default '' COMMENT 'tenant_id',\n  `tenant_name` varchar(128) default '' COMMENT 'tenant_name',\n  `tenant_desc` varchar(256) DEFAULT NULL COMMENT 'tenant_desc',\n  `create_source` varchar(32) DEFAULT NULL COMMENT 'create_source',\n  `gmt_create` bigint(20) NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` bigint(20) NOT NULL COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`),\n  KEY `idx_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='tenant_info';\n\nCREATE TABLE `users` (\n    `username` varchar(50) NOT NULL PRIMARY KEY,\n    `password` varchar(500) NOT NULL,\n    `enabled` boolean NOT NULL\n);\n\nCREATE TABLE `roles` (\n    `username` varchar(50) NOT NULL,\n    `role` varchar(50) NOT NULL,\n    UNIQUE INDEX `idx_user_role` (`username` ASC, `role` ASC) USING BTREE\n);\n\nCREATE TABLE `permissions` (\n    `role` varchar(50) NOT NULL,\n    `resource` varchar(255) NOT NULL,\n    `action` varchar(8) NOT NULL,\n    UNIQUE INDEX `uk_role_permission` (`role`,`resource`,`action`) USING BTREE\n);\n\nINSERT INTO users (username, password, enabled) VALUES ('nacos', '$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu', TRUE);\n\nINSERT INTO roles (username, role) VALUES ('nacos', 'ROLE_ADMIN');\n")),(0,r.kt)("h3",{id:"\u4e0b\u8f7dnacos"},"\u4e0b\u8f7dnacos"),(0,r.kt)("p",null,"nacos\u5728GitHub\u4e0a\u6709\u4e0b\u8f7d\u5730\u5740\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://github.com/alibaba/nacos/tags%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%89%E6%8B%A9%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD%E3%80%82"},"https://github.com/alibaba/nacos/tags\uff0c\u53ef\u4ee5\u9009\u62e9\u4efb\u610f\u7248\u672c\u4e0b\u8f7d\u3002")),(0,r.kt)("p",null,"\u672c\u4f8b\u4e2d\u624d\u75281.4.1\u7248\u672c\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220204135924832.png?raw=true",alt:"image-20220204135924832"})),(0,r.kt)("h3",{id:"\u914d\u7f6enacos"},"\u914d\u7f6eNacos"),(0,r.kt)("h4",{id:"\u5728nacos\u7684conf\u76ee\u5f55"},"\u5728nacos\u7684conf\u76ee\u5f55\uff1a"),(0,r.kt)("p",null,"\u5c06cluster.conf.example\uff0c\u91cd\u547d\u540d\u4e3acluster.conf\u7136\u540e\u6dfb\u52a0\u5185\u5bb9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"127.0.0.1:8845\n127.0.0.1.8846\n127.0.0.1.8847\n")),(0,r.kt)("h4",{id:"\u4fee\u6539conf\u76ee\u5f55\u4e0b\u7684applicationproperties\u6587\u4ef6"},"\u4fee\u6539conf\u76ee\u5f55\u4e0b\u7684application.properties\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"spring.datasource.platform=mysql\n\ndb.num=1\n\ndb.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC\ndb.user.0=root\ndb.password.0=\n")),(0,r.kt)("h3",{id:"\u542f\u52a8nacos"},"\u542f\u52a8Nacos"),(0,r.kt)("p",null,"\u5c06nacos\u6587\u4ef6\u5939\u590d\u5236\u4e09\u4efd\uff0c\u5206\u522b\u547d\u540d\u4e3a\uff1anacos1\u3001nacos2\u3001nacos3"),(0,r.kt)("p",null,"\u7136\u540e\u5206\u522b\u4fee\u6539\u4e09\u4e2a\u6587\u4ef6\u5939\u4e2d\u7684application.properties\uff0c"),(0,r.kt)("p",null,"nacos1:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"server.port=8845\n")),(0,r.kt)("p",null,"nacos2:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"server.port=8846\n")),(0,r.kt)("p",null,"nacos3:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"server.port=8847\n")),(0,r.kt)("p",null,"\u7136\u540e\u5206\u522b\u542f\u52a8\u4e09\u4e2anacos\u8282\u70b9\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"startup.cmd\n")),(0,r.kt)("h3",{id:"nginx\u53cd\u5411\u4ee3\u7406"},"Nginx\u53cd\u5411\u4ee3\u7406"),(0,r.kt)("p",null,"\u4fee\u6539nginx\u7684conf/nginx.conf\u6587\u4ef6\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-nginx"},"http {\n    upstream nacos-cluster {\n        server 127.0.0.1:8845;\n        server 127.0.0.1:8846;\n        server 127.0.0.1:8847;\n    }\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        location /nacos {\n            proxy_pass http://nacos-cluster;\n        }\n    }\n}\n")),(0,r.kt)("p",null,"\u800c\u540e\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1ahttp://localhost/nacos\u5373\u53ef\u3002"),(0,r.kt)("h3",{id:"\u4fee\u6539nacos\u4e3a\u96c6\u7fa4\u6a21\u5f0f"},"\u4fee\u6539Nacos\u4e3a\u96c6\u7fa4\u6a21\u5f0f"),(0,r.kt)("p",null,"nacos1\u3001nacos2\u3001nacos3\u5747\u9700\u4fee\u6539nacos\u7684bin\u76ee\u5f55\u4e0b\u7684start.cmd\u6587\u4ef6"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220204225949478.png?raw=true",alt:"image-20220204225949478"})),(0,r.kt)("h3",{id:"\u4fee\u6539\u4ee3\u7801"},"\u4fee\u6539\u4ee3\u7801"),(0,r.kt)("p",null,"\u4ee3\u7801\u4e2dbootstrap.yml\u6587\u4ef6\u914d\u7f6e\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  application:\n    name: userservice # \u670d\u52a1\u540d\u79f0\n  profiles:\n    active: dev # \u5f00\u53d1\u73af\u5883\n  cloud:\n    nacos:\n      discovery:\n        server-addr: 127.0.0.1:80\n      config:\n        file-extension: yaml # \u6587\u4ef6\u540e\u7f00\n        server-addr: 127.0.0.1:80\n        namespace: ad04ea8d-50ee-4dd6-bf38-a71f8337c117\n")),(0,r.kt)("p",null,"\u5982\u679c\u51fa\u73b0\u6d4f\u89c8\u5668\u53ef\u4ee5\u8bbf\u95eenacos\u63a7\u5236\u9875\u9762\uff0c\u4f46\u672c\u5730\u670d\u52a1\u65e0\u6cd5\u6ce8\u518c\u7684\u95ee\u9898\uff0c\u5982\u4e0b\u95ee\u9898\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"java.net.ConnectException: Connection refused: connect\n    at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method) ~[na:1.8.0_181]\n    at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:85) ~[na:1.8.0_181]\n    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~[na:1.8.0_181]\n    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~[na:1.8.0_181]\n    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~[na:1.8.0_181]\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172) ~[na:1.8.0_181]\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.8.0_181]\n    at java.net.Socket.connect(Socket.java:589) ~[na:1.8.0_181]\n    at sun.net.NetworkClient.doConnect(NetworkClient.java:175) ~[na:1.8.0_181]\n    at sun.net.www.http.HttpClient.openServer(HttpClient.java:463) ~[na:1.8.0_181]\n    at sun.net.www.http.HttpClient.openServer(HttpClient.java:558) ~[na:1.8.0_181]\n    at sun.net.www.http.HttpClient.<init>(HttpClient.java:242) ~[na:1.8.0_181]\n    at sun.net.www.http.HttpClient.New(HttpClient.java:339) ~[na:1.8.0_181]\n    at sun.net.www.http.HttpClient.New(HttpClient.java:357) ~[na:1.8.0_181]\n    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1220) ~[na:1.8.0_181]\n    at sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1156) ~[na:1.8.0_181]\n    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1050) ~[na:1.8.0_181]\n    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:984) ~[na:1.8.0_181]\n    at com.alibaba.nacos.common.http.client.request.JdkHttpClientRequest.execute(JdkHttpClientRequest.java:112) ~[nacos-common-1.4.1.jar:na]\n    at com.alibaba.nacos.common.http.client.NacosRestTemplate.execute(NacosRestTemplate.java:482) ~[nacos-common-1.4.1.jar:na]\n    at com.alibaba.nacos.common.http.client.NacosRestTemplate.exchangeForm(NacosRestTemplate.java:427) ~[nacos-common-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.net.NamingProxy.callServer(NamingProxy.java:603) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.net.NamingProxy.reqApi(NamingProxy.java:526) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.net.NamingProxy.reqApi(NamingProxy.java:498) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.net.NamingProxy.reqApi(NamingProxy.java:493) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.net.NamingProxy.queryList(NamingProxy.java:407) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.core.HostReactor.updateService(HostReactor.java:378) [nacos-client-1.4.1.jar:na]\n    at com.alibaba.nacos.client.naming.core.HostReactor$UpdateTask.run(HostReactor.java:460) [nacos-client-1.4.1.jar:na]\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_181]\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266) [na:1.8.0_181]\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_181]\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [na:1.8.0_181]\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_181]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181]\n    at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181]\n\n")),(0,r.kt)("p",null,"\u662f\u56e0\u4e3a\u5728\u914d\u7f6e\u7684\u65f6\u5019\u8fd8\u9700\u8981\u914d\u7f6e\u4e0aspring.cloud.nacos.",(0,r.kt)("inlineCode",{parentName:"p"},"discovery"),".server-addr=xxx.xxx.xxx.xxx:80"),(0,r.kt)("h2",{id:"\u4f18\u5316"},"\u4f18\u5316"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5b9e\u9645\u90e8\u7f72\u65f6\uff0c\u9700\u8981\u7ed9\u505a\u53cd\u5411\u4ee3\u7406\u7684nginx\u670d\u52a1\u5668\u8bbe\u7f6e\u4e00\u4e2a\u57df\u540d\uff0c\u8fd9\u6837\u540e\u7eed\u5982\u679c\u6709\u670d\u52a1\u5668\u8fc1\u79fbnacos\u7684\u5ba2\u6237\u7aef\u4e5f\u65e0\u9700\u66f4\u6539\u914d\u7f6e.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Nacos\u7684\u5404\u4e2a\u8282\u70b9\u5e94\u8be5\u90e8\u7f72\u5230\u591a\u4e2a\u4e0d\u540c\u670d\u52a1\u5668\uff0c\u505a\u597d\u5bb9\u707e\u548c\u9694\u79bb"))))}p.isMDXComponent=!0}}]);