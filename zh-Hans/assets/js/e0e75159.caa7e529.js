"use strict";(self.webpackChunkmy_wiki=self.webpackChunkmy_wiki||[]).push([[2796],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=i,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return t?a.createElement(g,r(r({ref:n},p),{},{components:t})):a.createElement(g,r({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var c=2;c<o;c++)r[c]=t[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},5775:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=t(7462),i=(t(7294),t(3905));const o={},r=void 0,l={unversionedId:"Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3",id:"Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3",title:"Spring IOC\u77e5\u8bc6\u603b\u7ed3",description:"[toc]",source:"@site/docs/Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3.md",sourceDirName:"Spring",slug:"/Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3",permalink:"/MyWiki/zh-Hans/docs/Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Spring/Spring IOC\u77e5\u8bc6\u603b\u7ed3.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Spring AOP\u77e5\u8bc6\u603b\u7ed3",permalink:"/MyWiki/zh-Hans/docs/Spring/Spring AOP\u77e5\u8bc6\u603b\u7ed3"},next:{title:"Spring MVC\u77e5\u8bc6\u603b\u7ed3",permalink:"/MyWiki/zh-Hans/docs/Spring/Spring MVC\u77e5\u8bc6\u603b\u7ed3"}},s={},c=[{value:"1.1IOC\uff08\u63a7\u5236\u53cd\u8f6c\uff09",id:"11ioc\u63a7\u5236\u53cd\u8f6c",level:2},{value:"1.1.1\u63a7\u5236\u53cd\u8f6c(IoC)\u6709\u4ec0\u4e48\u4f5c\u7528",id:"111\u63a7\u5236\u53cd\u8f6cioc\u6709\u4ec0\u4e48\u4f5c\u7528",level:3},{value:"1.1.2IOC\u7684\u4f18\u70b9\u662f\u4ec0\u4e48\uff1f",id:"112ioc\u7684\u4f18\u70b9\u662f\u4ec0\u4e48",level:3},{value:"1.1.3Spring IoC \u7684\u5b9e\u73b0\u673a\u5236",id:"113spring-ioc-\u7684\u5b9e\u73b0\u673a\u5236",level:3},{value:"1.2DI\uff08\u4f9d\u8d56\u6ce8\u5165\uff09",id:"12di\u4f9d\u8d56\u6ce8\u5165",level:2},{value:"1.2.1\u4ec0\u4e48\u662fSpring\u7684\u4f9d\u8d56\u6ce8\u5165",id:"121\u4ec0\u4e48\u662fspring\u7684\u4f9d\u8d56\u6ce8\u5165",level:3},{value:"1.2.2\u4f9d\u8d56\u6ce8\u5165\u7684\u4f18\u52bf",id:"122\u4f9d\u8d56\u6ce8\u5165\u7684\u4f18\u52bf",level:3},{value:"2.1IOC\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f",id:"21ioc\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f",level:2},{value:"2.1.1xml\u914d\u7f6e",id:"211xml\u914d\u7f6e",level:3},{value:"2.1.2Java\u914d\u7f6e",id:"212java\u914d\u7f6e",level:3},{value:"2.1.3\u6ce8\u89e3\u914d\u7f6e",id:"213\u6ce8\u89e3\u914d\u7f6e",level:3},{value:"2.2DI\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f",id:"22di\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f",level:2},{value:"2.2.1setter\u65b9\u5f0f",id:"221setter\u65b9\u5f0f",level:3},{value:"2.2.2\u6784\u9020\u65b9\u6cd5\u6ce8\u5165\uff08Construct\u6ce8\u5165\uff09",id:"222\u6784\u9020\u65b9\u6cd5\u6ce8\u5165construct\u6ce8\u5165",level:3},{value:"2.2.3\u6ce8\u89e3\u6ce8\u5165",id:"223\u6ce8\u89e3\u6ce8\u5165",level:3},{value:"3.1BeanFactory",id:"31beanfactory",level:2},{value:"3.2.1BeanFactory\u4e3a\u4f55\u8981\u5b9a\u4e49\u8fd9\u4e48\u591a\u5c42\u6b21\u7684\u63a5\u53e3\u5462\uff1f",id:"321beanfactory\u4e3a\u4f55\u8981\u5b9a\u4e49\u8fd9\u4e48\u591a\u5c42\u6b21\u7684\u63a5\u53e3\u5462",level:3},{value:"3.2ApplicationContext",id:"32applicationcontext",level:2},{value:"3.2.1ApplicationContext\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b",id:"321applicationcontext\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b",level:3},{value:"3.2.2ApplicationContext\u5bb9\u5668\u6269\u5c55\u529f\u80fd\u8be6\u89e3\u4ecb\u7ecd",id:"322applicationcontext\u5bb9\u5668\u6269\u5c55\u529f\u80fd\u8be6\u89e3\u4ecb\u7ecd",level:3},{value:"3.3BeanFactory\u548cApplicationContext\u7684\u533a\u522b",id:"33beanfactory\u548capplicationcontext\u7684\u533a\u522b",level:2},{value:"3.4BeanFactory\u548c ApplicationContext\u7684\u5173\u7cfb\u8be6\u89e3",id:"34beanfactory\u548c-applicationcontext\u7684\u5173\u7cfb\u8be6\u89e3",level:2},{value:"3.5ApplicationContext\u901a\u5e38\u7684\u5b9e\u73b0",id:"35applicationcontext\u901a\u5e38\u7684\u5b9e\u73b0",level:2},{value:"4.1BeanDefinition\u7684Resource\u5b9a\u4f4d",id:"41beandefinition\u7684resource\u5b9a\u4f4d",level:2},{value:"4.2BeanDefinition\u7684\u8f7d\u5165",id:"42beandefinition\u7684\u8f7d\u5165",level:2},{value:"4.3BeanDefinition\u7684\u6ce8\u518c",id:"43beandefinition\u7684\u6ce8\u518c",level:2}],p={toc:c};function u(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"[toc]"),(0,i.kt)("h1",{id:"1\u4ec0\u4e48\u662fiocdi"},"1.\u4ec0\u4e48\u662fIOC/DI"),(0,i.kt)("h2",{id:"11ioc\u63a7\u5236\u53cd\u8f6c"},"1.1IOC\uff08\u63a7\u5236\u53cd\u8f6c\uff09"),(0,i.kt)("p",null,"\u200b\t\tIoc\u2014Inversion of Control\uff0c\u5373\u201c\u63a7\u5236\u53cd\u8f6c\u201d\uff0c",(0,i.kt)("strong",{parentName:"p"},"\u4e0d\u662f\u4ec0\u4e48\u6280\u672f\uff0c\u800c\u662f\u4e00\u79cd\t\t\u8bbe\u8ba1\u601d\u60f3"),"\u3002\u5728Java\u5f00\u53d1\u4e2d\uff0cIoc\u610f\u5473\u7740\u5c06\u4f60\u8bbe\u8ba1\u597d\u7684\u5bf9\u8c61\u4ea4\u7ed9\u5bb9\u5668\u63a7\u5236\uff0c\u800c\u4e0d\u662f\u4f20\u7edf\u7684\u5728\u4f60\u7684\u5bf9\u8c61\u5185\u90e8\u76f4\u63a5\u63a7\u5236\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u8c01\u63a7\u5236\u8c01\uff0c\u63a7\u5236\u4ec0\u4e48"),"\uff1f")),(0,i.kt)("p",null,"\u200b\t\t\u4f20\u7edfJava SE\u7a0b\u5e8f\u8bbe\u8ba1\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u5bf9\u8c61\u5185\u90e8\u901a\u8fc7new\u8fdb\u884c\u521b\u5efa\u5bf9\u8c61\uff0c\u662f\u7a0b\u5e8f\u4e3b\u52a8\u53bb\u521b\u5efa\u4f9d\u8d56\u5bf9\u8c61\uff1b\u800cIoC\u662f\u6709\u4e13\u95e8\u4e00\u4e2a\u5bb9\u5668\u6765\u521b\u5efa\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u5373\u7531Ioc\u5bb9\u5668\u6765\u63a7\u5236\u5bf9 \u8c61\u7684\u521b\u5efa\uff1b"),(0,i.kt)("p",null,"\u200b\t\t\u8c01\u63a7\u5236\u8c01\uff1f\u5f53\u7136\u662fIoC \u5bb9\u5668\u63a7\u5236\u4e86\u5bf9\u8c61\uff1b"),(0,i.kt)("p",null,"\u200b\t\t\u63a7\u5236\u4ec0\u4e48\uff1f\u90a3\u5c31\u662f\u4e3b\u8981\u63a7\u5236\u4e86\u5916\u90e8\u8d44\u6e90\u83b7\u53d6\uff08\u4e0d\u53ea\u662f\u5bf9\u8c61\u5305\u62ec\u6bd4\u5982\u6587\u4ef6\u7b49\uff09\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u4e3a\u4f55\u662f\u53cd\u8f6c\uff0c\u54ea\u4e9b\u65b9\u9762\u53cd\u8f6c\u4e86"),"?")),(0,i.kt)("p",null,"\u200b\t\t\u6709\u53cd\u8f6c\u5c31\u6709\u6b63\u8f6c\uff0c\u4f20\u7edf\u5e94\u7528\u7a0b\u5e8f\u662f\u7531\u6211\u4eec\u81ea\u5df1\u5728\u5bf9\u8c61\u4e2d\u4e3b\u52a8\u63a7\u5236\u53bb\u76f4\u63a5\u83b7\u53d6\u4f9d\u8d56\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u6b63\u8f6c\uff1b"),(0,i.kt)("p",null,"\u200b\t\t\u800c\u53cd\u8f6c\u5219\u662f\u7531\u5bb9\u5668\u6765\u5e2e\u5fd9\u521b\u5efa\u53ca\u6ce8\u5165\u4f9d\u8d56\u5bf9\u8c61\uff1b"),(0,i.kt)("p",null,"\u200b\t\t\u4e3a\u4f55\u662f\u53cd\u8f6c\uff1f\u56e0\u4e3a\u7531\u5bb9\u5668\u5e2e\u6211\u4eec\u67e5\u627e\u53ca\u6ce8\u5165\u4f9d\u8d56\u5bf9\u8c61\uff0c\u5bf9\u8c61\u53ea\u662f\u88ab\u52a8\u7684\u63a5\u53d7\u4f9d\u8d56\u5bf9\u8c61\uff0c\u6240\u4ee5\u662f\u53cd\u8f6c\uff1b"),(0,i.kt)("p",null,"\u200b\t\t\u54ea\u4e9b\u65b9\u9762\u53cd\u8f6c\u4e86\uff1f\u4f9d\u8d56\u5bf9\u8c61\u7684\u83b7\u53d6\u88ab\u53cd\u8f6c\u4e86\u3002"),(0,i.kt)("h3",{id:"111\u63a7\u5236\u53cd\u8f6cioc\u6709\u4ec0\u4e48\u4f5c\u7528"},"1.1.1\u63a7\u5236\u53cd\u8f6c(IoC)\u6709\u4ec0\u4e48\u4f5c\u7528"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7ba1\u7406\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u4f9d\u8d56\u5173\u7cfb\u7684\u7ef4\u62a4\u3002\u5bf9\u8c61\u7684\u521b\u5efa\u5e76\u4e0d\u662f\u4e00\u4ef6\u7b80\u5355\u7684\u4e8b\uff0c\u5728\u5bf9\u8c61\u5173\u7cfb\u6bd4\u8f83\u590d\u6742\u65f6\uff0c\u5982\u679c\u4f9d\u8d56\u5173\u7cfb\u9700\u8981\u7a0b\u5e8f\u733f\u6765\u7ef4\u62a4\u7684\u8bdd\uff0c\u90a3\u662f\u76f8\u5f53\u5934\u75bc\u7684"),(0,i.kt)("li",{parentName:"ul"},"\u89e3\u8026\uff0c\u7531\u5bb9\u5668\u53bb\u7ef4\u62a4\u5177\u4f53\u7684\u5bf9\u8c61"),(0,i.kt)("li",{parentName:"ul"},"\u6258\u7ba1\u4e86\u7c7b\u7684\u4ea7\u751f\u8fc7\u7a0b\uff0c\u6bd4\u5982\u6211\u4eec\u9700\u8981\u5728\u7c7b\u7684\u4ea7\u751f\u8fc7\u7a0b\u4e2d\u505a\u4e00\u4e9b\u5904\u7406\uff0c\u6700\u76f4\u63a5\u7684\u4f8b\u5b50\u5c31\u662f\u4ee3\u7406\uff0c\u5982\u679c\u6709\u5bb9\u5668\u7a0b\u5e8f\u53ef\u4ee5\u628a\u8fd9\u90e8\u5206\u5904\u7406\u4ea4\u7ed9\u5bb9\u5668\uff0c\u5e94\u7528\u7a0b\u5e8f\u5219\u65e0\u9700\u53bb\u5173\u5fc3\u7c7b\u662f\u5982\u4f55\u5b8c\u6210\u4ee3\u7406\u7684")),(0,i.kt)("h3",{id:"112ioc\u7684\u4f18\u70b9\u662f\u4ec0\u4e48"},"1.1.2IOC\u7684\u4f18\u70b9\u662f\u4ec0\u4e48\uff1f"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"IOC \u6216 \u4f9d\u8d56\u6ce8\u5165\u628a\u5e94\u7528\u7684\u4ee3\u7801\u91cf\u964d\u5230\u6700\u4f4e\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5b83\u4f7f\u5e94\u7528\u5bb9\u6613\u6d4b\u8bd5\uff0c\u5355\u5143\u6d4b\u8bd5\u4e0d\u518d\u9700\u8981\u5355\u4f8b\u548cJNDI\u67e5\u627e\u673a\u5236\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u6700\u5c0f\u7684\u4ee3\u4ef7\u548c\u6700\u5c0f\u7684\u4fb5\u5165\u6027\u4f7f\u677e\u6563\u8026\u5408\u5f97\u4ee5\u5b9e\u73b0\u3002"),(0,i.kt)("li",{parentName:"ul"},"IOC\u5bb9\u5668\u652f\u6301\u52a0\u8f7d\u670d\u52a1\u65f6\u7684\u997f\u6c49\u5f0f\u521d\u59cb\u5316\u548c\u61d2\u52a0\u8f7d\u3002")),(0,i.kt)("h3",{id:"113spring-ioc-\u7684\u5b9e\u73b0\u673a\u5236"},"1.1.3Spring IoC \u7684\u5b9e\u73b0\u673a\u5236"),(0,i.kt)("p",null,"Spring \u4e2d\u7684 IoC \u7684\u5b9e\u73b0\u539f\u7406\u5c31\u662f\u5de5\u5382\u6a21\u5f0f\u52a0\u53cd\u5c04\u673a\u5236\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'interface Fruit {\n    public abstract void eat();\n}\n\nclass Apple implements Fruit {\n    public void eat() {\n        System.out.println("Apple");\n    }\n}\n\nclass Orange implements Fruit {\n    public void eat() {\n        System.out.println("Orange");\n    }\n}\n\nclass Factory {\n    public static Fruit getInstance(String ClassName) {\n        Fruit f = null;\n        try {\n            f = (Fruit) Class.forName(ClassName).newInstance();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return f;\n    }\n}\n\nclass Client {\n    public static void main(String[] a) {\n        Fruit f = Factory.getInstance("io.github.dunwu.spring.Apple");\n        if (f != null) {\n            f.eat();\n        }\n    }\n}\n')),(0,i.kt)("h2",{id:"12di\u4f9d\u8d56\u6ce8\u5165"},"1.2DI\uff08\u4f9d\u8d56\u6ce8\u5165\uff09"),(0,i.kt)("p",null,"\u200b\t\tDI\u2014Dependency Injection\uff0c\u5373\u4f9d\u8d56\u6ce8\u5165\uff1a\u7ec4\u4ef6\u4e4b\u95f4\u4f9d\u8d56\u5173\u7cfb\u7531\u5bb9\u5668\u5728\u8fd0\u884c\u671f\u51b3\u5b9a\uff0c\u5f62\u8c61\u7684\u8bf4\uff0c\u5373\u7531\u5bb9\u5668\u52a8\u6001\u7684\u5c06\u67d0\u4e2a\u4f9d\u8d56\u5173\u7cfb\u6ce8\u5165\u5230\u7ec4\u4ef6\u4e4b\u4e2d\u3002\u4f9d\u8d56\u6ce8\u5165\u7684\u76ee\u7684\u5e76\u975e\u4e3a\u8f6f\u4ef6\u7cfb\u7edf\u5e26\u6765\u66f4\u591a\u529f\u80fd\uff0c\u800c\u662f\u4e3a\u4e86\u63d0\u5347\u7ec4\u4ef6\u91cd\u7528\u7684\u9891\u7387\uff0c\u5e76\u4e3a\u7cfb\u7edf\u642d\u5efa\u4e00\u4e2a\u7075\u6d3b\u3001\u53ef\u6269\u5c55\u7684\u5e73\u53f0\u3002\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u673a\u5236\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u7b80\u5355\u7684\u914d\u7f6e\uff0c\u800c\u65e0\u9700\u4efb\u4f55\u4ee3\u7801\u5c31\u53ef\u6307\u5b9a\u76ee\u6807\u9700\u8981\u7684\u8d44\u6e90\uff0c\u5b8c\u6210\u81ea\u8eab\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u5177\u4f53\u7684\u8d44\u6e90\u6765\u81ea\u4f55\u5904\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u8c01\u4f9d\u8d56\u4e8e\u8c01"),"\uff1f")),(0,i.kt)("p",null,"\u5f53\u7136\u662f\u5e94\u7528\u7a0b\u5e8f\u4f9d\u8d56\u4e8eIoC\u5bb9\u5668\uff1b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u4e3a\u4ec0\u4e48\u9700\u8981\u4f9d\u8d56"),"\uff1f")),(0,i.kt)("p",null,"\u5e94\u7528\u7a0b\u5e8f\u9700\u8981IoC\u5bb9\u5668\u6765\u63d0\u4f9b\u5bf9\u8c61\u9700\u8981\u7684\u5916\u90e8\u8d44\u6e90\uff1b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u8c01\u6ce8\u5165\u8c01"),"\uff1f")),(0,i.kt)("p",null,"\u5f88\u660e\u663e\u662fIoC\u5bb9\u5668\u6ce8\u5165\u5e94\u7528\u7a0b\u5e8f\u67d0\u4e2a\u5bf9\u8c61\uff0c\u5e94\u7528\u7a0b\u5e8f\u4f9d\u8d56\u7684\u5bf9\u8c61\uff1b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u6ce8\u5165\u4e86\u4ec0\u4e48"),"\uff1f")),(0,i.kt)("p",null,"\u5c31\u662f\u6ce8\u5165\u67d0\u4e2a\u5bf9\u8c61\u6240\u9700\u8981\u7684\u5916\u90e8\u8d44\u6e90\uff08\u5305\u62ec\u5bf9\u8c61\u3001\u8d44\u6e90\u3001\u5e38\u91cf\u6570\u636e\uff09\u3002"),(0,i.kt)("h3",{id:"121\u4ec0\u4e48\u662fspring\u7684\u4f9d\u8d56\u6ce8\u5165"},"1.2.1\u4ec0\u4e48\u662fSpring\u7684\u4f9d\u8d56\u6ce8\u5165"),(0,i.kt)("p",null,"\u6240\u8c13\u4f9d\u8d56\u6ce8\u5165\uff08Dependency Injection\uff09\uff0c\u5373\u7ec4\u4ef6\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u7531\u5bb9\u5668\u5728\u5e94\u7528\u7cfb\u7edf\u8fd0\u884c\u671f\u6765\u51b3\u5b9a\uff0c\u4e5f\u5c31\u662f\u7531\u5bb9\u5668\u52a8\u6001\u5730\u5c06\u67d0\u79cd\u4f9d\u8d56\u5173\u7cfb\u7684\u76ee\u6807\u5bf9\u8c61\u5b9e\u4f8b\u6ce8\u5165\u5230\u5e94\u7528\u7cfb\u7edf\u4e2d\u7684\u5404\u4e2a\u5173\u8054\u7684\u7ec4\u4ef6\u4e4b\u4e2d\u3002\u7ec4\u4ef6\u4e0d\u505a\u5b9a\u4f4d\u67e5\u8be2\uff0c\u53ea\u63d0\u4f9b\u666e\u901a\u7684Java\u65b9\u6cd5\u8ba9\u5bb9\u5668\u53bb\u51b3\u5b9a\u4f9d\u8d56\u5173\u7cfb\u3002"),(0,i.kt)("h3",{id:"122\u4f9d\u8d56\u6ce8\u5165\u7684\u4f18\u52bf"},"1.2.2\u4f9d\u8d56\u6ce8\u5165\u7684\u4f18\u52bf"),(0,i.kt)("p",null,"\u4f9d\u8d56\u6ce8\u5165\u4e4b\u6240\u4ee5\u66f4\u6d41\u884c\u662f\u56e0\u4e3a\u5b83\u662f\u4e00\u79cd\u66f4\u53ef\u53d6\u7684\u65b9\u5f0f\uff1a\u8ba9\u5bb9\u5668\u5168\u6743\u8d1f\u8d23\u4f9d\u8d56\u67e5\u8be2\uff0c\u53d7\u7ba1\u7ec4\u4ef6\u53ea\u9700\u8981\u66b4\u9732JavaBean\u7684setter\u65b9\u6cd5\u6216\u8005\u5e26\u53c2\u6570\u7684\u6784\u9020\u5668\u6216\u8005\u63a5\u53e3\uff0c\u4f7f\u5bb9\u5668\u53ef\u4ee5\u5728\u521d\u59cb\u5316\u65f6\u7ec4\u88c5\u5bf9\u8c61\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\u5176\u4e0e\u4f9d\u8d56\u67e5\u627e\u65b9\u5f0f\u76f8\u6bd4\uff0c\u4e3b\u8981\u4f18\u52bf\u4e3a\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u67e5\u627e\u5b9a\u4f4d\u64cd\u4f5c\u4e0e\u5e94\u7528\u4ee3\u7801\u5b8c\u5168\u65e0\u5173\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u4f9d\u8d56\u4e8e\u5bb9\u5668\u7684API\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5728\u4efb\u4f55\u5bb9\u5668\u4ee5\u5916\u4f7f\u7528\u5e94\u7528\u5bf9\u8c61\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u9700\u8981\u7279\u6b8a\u7684\u63a5\u53e3\uff0c\u7edd\u5927\u591a\u6570\u5bf9\u8c61\u53ef\u4ee5\u505a\u5230\u5b8c\u5168\u4e0d\u5fc5\u4f9d\u8d56\u5bb9\u5668\u3002")),(0,i.kt)("h1",{id:"2iocdi\u7684\u5b9e\u73b0\u65b9\u5f0f"},"2.IOC/DI\u7684\u5b9e\u73b0\u65b9\u5f0f"),(0,i.kt)("h2",{id:"21ioc\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"},"2.1IOC\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"),(0,i.kt)("h3",{id:"211xml\u914d\u7f6e"},"2.1.1xml\u914d\u7f6e"),(0,i.kt)("p",null,"\u200b\t\t\u5c06bean\u7684\u4fe1\u606f\u914d\u7f6e.xml\u6587\u4ef6\u91cc\uff0c\u901a\u8fc7Spring\u52a0\u8f7d\u6587\u4ef6\u4e3a\u6211\u4eec\u521b\u5efabean\u3002\u8fd9\u79cd\u65b9\u5f0f\u51fa\u73b0\u5f88\u591a\u65e9\u524d\u7684SSM\u9879\u76ee\u4e2d\uff0c\u5c06\u7b2c\u4e09\u65b9\u7c7b\u5e93\u6216\u8005\u4e00\u4e9b\u914d\u7f6e\u5de5\u5177\u7c7b\u90fd\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u914d\u7f6e\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u7531\u4e8e\u7b2c\u4e09\u65b9\u7c7b\u4e0d\u652f\u6301Spring\u6ce8\u89e3\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u4f18\u70b9"),"\uff1a \u53ef\u4ee5\u4f7f\u7528\u4e8e\u4efb\u4f55\u573a\u666f\uff0c\u7ed3\u6784\u6e05\u6670\uff0c\u901a\u4fd7\u6613\u61c2"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u7f3a\u70b9"),"\uff1a \u914d\u7f6e\u7e41\u7410\uff0c\u4e0d\u6613\u7ef4\u62a4\uff0c\u67af\u71e5\u65e0\u5473\uff0c\u6269\u5c55\u6027\u5dee")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans"\n xsi:schemaLocation="http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- services --\x3e\n    <bean id="userService" class="tech.pdai.springframework.service.UserServiceImpl">\n        <property name="userDao" ref="userDao"/>\n        \x3c!-- additional collaborators and configuration for this bean go here --\x3e\n    </bean>\n    \x3c!-- more bean definitions for services go here --\x3e\n</beans>\n')),(0,i.kt)("h3",{id:"212java\u914d\u7f6e"},"2.1.2Java\u914d\u7f6e"),(0,i.kt)("p",null,"\u200b\t\t\u5c06\u7c7b\u7684\u521b\u5efa\u4ea4\u7ed9\u6211\u4eec\u914d\u7f6e\u7684JavcConfig\u7c7b\u6765\u5b8c\u6210\uff0cSpring\u53ea\u8d1f\u8d23\u7ef4\u62a4\u548c\u7ba1\u7406\uff0c\u91c7\u7528\u7eafJava\u521b\u5efa\u65b9\u5f0f\u3002\u5176\u672c\u8d28\u4e0a\u5c31\u662f\u628a\u5728XML\u4e0a\u7684\u914d\u7f6e\u58f0\u660e\u8f6c\u79fb\u5230Java\u914d\u7f6e\u7c7b\u4e2d"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u4f18\u70b9"),"\uff1a\u9002\u7528\u4e8e\u4efb\u4f55\u573a\u666f\uff0c\u914d\u7f6e\u65b9\u4fbf\uff0c\u56e0\u4e3a\u662f\u7eafJava\u4ee3\u7801\uff0c\u6269\u5c55\u6027\u9ad8\uff0c\u5341\u5206\u7075\u6d3b"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u7f3a\u70b9"),"\uff1a\u7531\u4e8e\u662f\u91c7\u7528Java\u7c7b\u7684\u65b9\u5f0f\uff0c\u58f0\u660e\u4e0d\u660e\u663e\uff0c\u5982\u679c\u5927\u91cf\u914d\u7f6e\uff0c\u53ef\u8bfb\u6027\u6bd4\u8f83\u5dee")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class BeansConfig {\n\n    /**\n     * @return user dao\n     */\n    @Bean("userDao")\n    public UserDaoImpl userDao() {\n        return new UserDaoImpl();\n    }\n\n    /**\n     * @return user service\n     */\n    @Bean("userService")\n    public UserServiceImpl userService() {\n        UserServiceImpl userService = new UserServiceImpl();\n        userService.setUserDao(userDao());\n        return userService;\n    }\n}\n')),(0,i.kt)("h3",{id:"213\u6ce8\u89e3\u914d\u7f6e"},"2.1.3\u6ce8\u89e3\u914d\u7f6e"),(0,i.kt)("p",null,"\u200b\t\t\u901a\u8fc7\u5728\u7c7b\u4e0a\u52a0\u6ce8\u89e3\u7684\u65b9\u5f0f\uff0c\u6765\u58f0\u660e\u4e00\u4e2a\u7c7b\u4ea4\u7ed9Spring\u7ba1\u7406\uff0cSpring\u4f1a\u81ea\u52a8\u626b\u63cf\u5e26\u6709@Component\uff0c@Controller\uff0c@Service\uff0c@Repository\u8fd9\u56db\u4e2a\u6ce8\u89e3\u7684\u7c7b\uff0c\u7136\u540e\u5e2e\u6211\u4eec\u521b\u5efa\u5e76\u7ba1\u7406\uff0c\u524d\u63d0\u662f\u9700\u8981\u5148\u914d\u7f6eSpring\u7684\u6ce8\u89e3\u626b\u63cf\u5668\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u4f18\u70b9"),"\uff1a\u5f00\u53d1\u4fbf\u6377\uff0c\u901a\u4fd7\u6613\u61c2\uff0c\u65b9\u4fbf\u7ef4\u62a4\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u7f3a\u70b9"),"\uff1a\u5177\u6709\u5c40\u9650\u6027\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u7b2c\u4e09\u65b9\u8d44\u6e90\uff0c\u65e0\u6cd5\u6dfb\u52a0\u6ce8\u89e3\u3002\u53ea\u80fd\u91c7\u7528XML\u6216JavaConfig\u7684\u65b9\u5f0f\u914d\u7f6e")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Service\npublic class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    @Autowired\n    private UserDaoImpl userDao;\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return userDao.findUserList();\n    }\n\n}\n")),(0,i.kt)("h2",{id:"22di\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"},"2.2DI\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"),(0,i.kt)("h3",{id:"221setter\u65b9\u5f0f"},"2.2.1setter\u65b9\u5f0f"),(0,i.kt)("p",null,"\u5728XML\u914d\u7f6e\u65b9\u5f0f\u4e2d\uff0cproperty\u90fd\u662fsetter\u65b9\u5f0f\u6ce8\u5165\uff0c\u6bd4\u5982\u4e0b\u9762\u7684xml:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- services --\x3e\n    <bean id="userService" class="tech.pdai.springframework.service.UserServiceImpl">\n        <property name="userDao" ref="userDao"/>\n        \x3c!-- additional collaborators and configuration for this bean go here --\x3e\n    </bean>\n    \x3c!-- more bean definitions for services go here --\x3e\n</beans>\n')),(0,i.kt)("p",null,"\u672c\u8d28\u4e0a\u5305\u542b\u4e24\u6b65\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u7b2c\u4e00\u6b65\uff0c\u9700\u8981new UserServiceImpl()\u521b\u5efa\u5bf9\u8c61, \u6240\u4ee5\u9700\u8981\u9ed8\u8ba4\u6784\u9020\u51fd\u6570"),(0,i.kt)("li",{parentName:"ol"},"\u7b2c\u4e8c\u6b65\uff0c\u8c03\u7528setUserDao()\u51fd\u6570\u6ce8\u5165userDao\u7684\u503c, \u6240\u4ee5\u9700\u8981setUserDao()\u51fd\u6570")),(0,i.kt)("p",null,"\u6240\u4ee5\u5bf9\u5e94\u7684Service\u7c7b\u662f\u8fd9\u6837\u7684\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    private UserDaoImpl userDao;\n\n    /**\n     * init.\n     */\n    public UserServiceImpl() {\n    }\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return this.userDao.findUserList();\n    }\n\n    /**\n     * set dao.\n     *\n     * @param userDao user dao\n     */\n    public void setUserDao(UserDaoImpl userDao) {\n        this.userDao = userDao;\n    }\n}\n")),(0,i.kt)("p",null,"\u5728\u6ce8\u89e3\u548cJAVA\u7684\u914d\u7f6e\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    private UserDaoImpl userDao;\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return this.userDao.findUserList();\n    }\n\n    /**\n     * set dao.\n     *\n     * @param userDao user dao\n     */\n    @Autowired\n    public void setUserDao(UserDaoImpl userDao) {\n        this.userDao = userDao;\n    }\n}\n")),(0,i.kt)("h3",{id:"222\u6784\u9020\u65b9\u6cd5\u6ce8\u5165construct\u6ce8\u5165"},"2.2.2\u6784\u9020\u65b9\u6cd5\u6ce8\u5165\uff08Construct\u6ce8\u5165\uff09"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5728XML\u914d\u7f6e\u65b9\u5f0f\u4e2d"),"\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"<constructor-arg>"),"\u662f\u901a\u8fc7\u6784\u9020\u51fd\u6570\u53c2\u6570\u6ce8\u5165\uff0c\u6bd4\u5982\u4e0b\u9762\u7684xml:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \x3c!-- services --\x3e\n    <bean id="userService" class="tech.pdai.springframework.service.UserServiceImpl">\n        <constructor-arg name="userDao" ref="userDao"/>\n        \x3c!-- additional collaborators and configuration for this bean go here --\x3e\n    </bean>\n    \x3c!-- more bean definitions for services go here --\x3e\n</beans>\n')),(0,i.kt)("p",null,"\u672c\u8d28\u4e0a\u662fnew UserServiceImpl(userDao)\u521b\u5efa\u5bf9\u8c61, \u6240\u4ee5\u5bf9\u5e94\u7684service\u7c7b\u662f\u8fd9\u6837\u7684\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    private final UserDaoImpl userDao;\n\n    /**\n     * init.\n     * @param userDaoImpl user dao impl\n     */\n    public UserServiceImpl(UserDaoImpl userDaoImpl) {\n        this.userDao = userDaoImpl;\n    }\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return this.userDao.findUserList();\n    }\n}\n")),(0,i.kt)("p",null,"\u5728\u6ce8\u89e3\u548cJava\u914d\u7f6e\u65b9\u5f0f\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Service\npublic class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    private final UserDaoImpl userDao;\n\n    /**\n     * init.\n     * @param userDaoImpl user dao impl\n     */\n    @Autowired // \u8fd9\u91cc@Autowired\u4e5f\u53ef\u4ee5\u7701\u7565\n    public UserServiceImpl(final UserDaoImpl userDaoImpl) {\n        this.userDao = userDaoImpl;\n    }\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return this.userDao.findUserList();\n    }\n}\n")),(0,i.kt)("h3",{id:"223\u6ce8\u89e3\u6ce8\u5165"},"2.2.3\u6ce8\u89e3\u6ce8\u5165"),(0,i.kt)("p",null,"\u200b\t\t\u4ee5@Autowired\uff08\u81ea\u52a8\u6ce8\u5165\uff09\u6ce8\u89e3\u6ce8\u5165\u4e3a\u4f8b\uff0c\u4fee\u9970\u7b26\u6709\u4e09\u4e2a\u5c5e\u6027\uff1aConstructor\uff0cbyType\uff0cbyName\u3002\u9ed8\u8ba4\u6309\u7167byType\u6ce8\u5165\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"constructor"),"\uff1a\u901a\u8fc7\u6784\u9020\u65b9\u6cd5\u8fdb\u884c\u81ea\u52a8\u6ce8\u5165\uff0cspring\u4f1a\u5339\u914d\u4e0e\u6784\u9020\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b\u4e00\u81f4\u7684bean\u8fdb\u884c\u6ce8\u5165\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u591a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u4e00\u4e2a\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u5728\u5bb9\u5668\u4e2d\u67e5\u627e\u5230\u591a\u4e2a\u5339\u914d\u591a\u53c2\u6570\u6784\u9020\u65b9\u6cd5\u7684bean\uff0c\u90a3\u4e48spring\u4f1a\u4f18\u5148\u5c06bean\u6ce8\u5165\u5230\u591a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"byName"),"\uff1a\u88ab\u6ce8\u5165bean\u7684id\u540d\u5fc5\u987b\u4e0eset\u65b9\u6cd5\u540e\u534a\u622a\u5339\u914d\uff0c\u5e76\u4e14id\u540d\u79f0\u7684\u7b2c\u4e00\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u5fc5\u987b\u5c0f\u5199\uff0c\u8fd9\u4e00\u70b9\u4e0e\u624b\u52a8set\u6ce8\u5165\u6709\u70b9\u4e0d\u540c\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"byType"),"\uff1a\u67e5\u627e\u6240\u6709\u7684set\u65b9\u6cd5\uff0c\u5c06\u7b26\u5408\u7b26\u5408\u53c2\u6570\u7c7b\u578b\u7684bean\u6ce8\u5165\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Service\npublic class UserServiceImpl {\n\n    /**\n     * user dao impl.\n     */\n    @Autowired\n    private UserDaoImpl userDao;\n\n    /**\n     * find user list.\n     *\n     * @return user list\n     */\n    public List<User> findUserList() {\n        return userDao.findUserList();\n    }\n\n}\n")),(0,i.kt)("h1",{id:"3spring-ioc\u4f53\u7cfb\u7ed3\u6784"},"3.Spring IOC\u4f53\u7cfb\u7ed3\u6784"),(0,i.kt)("h2",{id:"31beanfactory"},"3.1BeanFactory"),(0,i.kt)("p",null,"\u200b\t\tSpring Bean\u7684\u521b\u5efa\u662f\u5178\u578b\u7684\u5de5\u5382\u6a21\u5f0f\uff0c\u8fd9\u4e00\u7cfb\u5217\u7684Bean\u5de5\u5382\uff0c\u4e5f\u5373IOC\u5bb9\u5668\u4e3a\u5f00\u53d1\u8005\u7ba1\u7406\u5bf9\u8c61\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u63d0\u4f9b\u4e86\u5f88\u591a\u4fbf\u5229\u548c\u57fa\u7840\u670d\u52a1\uff0c\u5728Spring\u4e2d\u6709\u8bb8\u591a\u7684IOC\u5bb9\u5668\u7684\u5b9e\u73b0\u4f9b\u7528\u6237\u9009\u62e9\u548c\u4f7f\u7528\uff0c\u5176\u76f8\u4e92\u5173\u7cfb\u5982\u4e0b\uff1a"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220324163610373.png?raw=true",alt:"image-20220324163610373"})),(0,i.kt)("p",null,"\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c ",(0,i.kt)("inlineCode",{parentName:"p"},"BeanFactory")," \u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\u5305\u62ec ",(0,i.kt)("inlineCode",{parentName:"p"},"StaticListableBeanFactory"),"\u3001 ",(0,i.kt)("inlineCode",{parentName:"p"},"DefaultListableBeanFactory"),"\u3001 ",(0,i.kt)("inlineCode",{parentName:"p"},"SimpleJndiBeanFactory"),"\u7b49\u4e09\u4e2a\u516c\u5171\u7c7b\uff0c\u5206\u522b\u9762\u5411",(0,i.kt)("strong",{parentName:"p"},"\u9759\u6001\u573a\u666f"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"\u9ed8\u8ba4\u679a\u4e3e\u914d\u7f6e\u573a\u666f"),"\u548c",(0,i.kt)("strong",{parentName:"p"},"JNDI"),"\u7b49\u573a\u666f\uff0c\u5bf9\u5e94\u7684\u5b9e\u73b0\u601d\u8def\u4e5f\u4e0d\u5c3d\u76f8\u540c\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"StaticListableBeanFactory"),"\u53ef\u4ee5\u770b\u505a\u662f\u57fa\u4e8e ",(0,i.kt)("inlineCode",{parentName:"li"},"Map<String\uff0cObject>"),"\u7684\u7b80\u5355\u5c01\u88c5\uff0c",(0,i.kt)("strong",{parentName:"li"},"\u4e0d\u5305\u62ecBean\u7684\u5b9e\u4f8b\u5316\u8fc7\u7a0b"),"\uff0c\u9700\u8981\u7528\u6237\u624b\u52a8\u6ce8\u518c\u540e\u624d\u53ef\u4ee5\u4f7f\u7528\uff0c\u4e0d\u5177\u5907\u4f9d\u8d56\u6ce8\u5165\u80fd\u529b\uff0c\u662f ",(0,i.kt)("inlineCode",{parentName:"li"},"BeanFactory"),"\u6700\u4e3a\u7b80\u5355\u7684\u5b9e\u73b0\uff1b"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"DefaultListableBeanFactory"),"\u662fSpring ",(0,i.kt)("inlineCode",{parentName:"li"},"BeanFactory"),"\u7684\u9ed8\u8ba4\u5b9e\u73b0"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SimpleJndiBeanFactory"),"\u5219\u662f\u57fa\u4e8eJNDI\u573a\u666f\u53d1\u73b0\u5bf9\u5e94Bean\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface BeanFactory {\n\n    //\u5bf9FactoryBean\u7684\u8f6c\u4e49\u5b9a\u4e49\uff0c\u56e0\u4e3a\u5982\u679c\u4f7f\u7528bean\u7684\u540d\u5b57\u68c0\u7d22FactoryBean\u5f97\u5230\u7684\u5bf9\u8c61\u662f\u5de5\u5382\u751f\u6210\u7684\u5bf9\u8c61\uff0c    \n    //\u5982\u679c\u9700\u8981\u5f97\u5230\u5de5\u5382\u672c\u8eab\uff0c\u9700\u8981\u8f6c\u4e49           \n    String FACTORY_BEAN_PREFIX = "&";\n\n    //\u6839\u636ebean\u7684\u540d\u5b57\uff0c\u83b7\u53d6\u5728IOC\u5bb9\u5668\u4e2d\u5f97\u5230bean\u5b9e\u4f8b    \n    Object getBean(String name) throws BeansException;\n\n    //\u6839\u636ebean\u7684\u540d\u5b57\u548cClass\u7c7b\u578b\u6765\u5f97\u5230bean\u5b9e\u4f8b\uff0c\u589e\u52a0\u4e86\u7c7b\u578b\u5b89\u5168\u9a8c\u8bc1\u673a\u5236\u3002    \n    Object getBean(String name, Class requiredType) throws BeansException;\n\n    //\u63d0\u4f9b\u5bf9bean\u7684\u68c0\u7d22\uff0c\u770b\u770b\u662f\u5426\u5728IOC\u5bb9\u5668\u6709\u8fd9\u4e2a\u540d\u5b57\u7684bean    \n    boolean containsBean(String name);\n\n    //\u6839\u636ebean\u540d\u5b57\u5f97\u5230bean\u5b9e\u4f8b\uff0c\u5e76\u540c\u65f6\u5224\u65ad\u8fd9\u4e2abean\u662f\u4e0d\u662f\u5355\u4f8b    \n    boolean isSingleton(String name) throws NoSuchBeanDefinitionException;\n\n    //\u5f97\u5230bean\u5b9e\u4f8b\u7684Class\u7c7b\u578b    \n    Class getType(String name) throws NoSuchBeanDefinitionException;\n\n    //\u5f97\u5230bean\u7684\u522b\u540d\uff0c\u5982\u679c\u6839\u636e\u522b\u540d\u68c0\u7d22\uff0c\u90a3\u4e48\u5176\u539f\u540d\u4e5f\u4f1a\u88ab\u68c0\u7d22\u51fa\u6765    \n    String[] getAliases(String name);\n\n}\n')),(0,i.kt)("h3",{id:"321beanfactory\u4e3a\u4f55\u8981\u5b9a\u4e49\u8fd9\u4e48\u591a\u5c42\u6b21\u7684\u63a5\u53e3\u5462"},"3.2.1BeanFactory\u4e3a\u4f55\u8981\u5b9a\u4e49\u8fd9\u4e48\u591a\u5c42\u6b21\u7684\u63a5\u53e3\u5462\uff1f"),(0,i.kt)("p",null,"\u200b\t\t\u4e0a\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6700\u7ec8\u7684\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\u662f DefaultListableBeanFactory\uff0c\u4ed6\u5b9e\u73b0\u4e86\u6240\u6709\u7684\u63a5\u53e3\u3002\u67e5\u9605\u8fd9\u4e9b\u63a5\u53e3\u7684\u6e90\u7801\u548c\u8bf4\u660e\u53d1\u73b0\uff0c\u6bcf\u4e2a\u63a5\u53e3\u90fd\u6709\u4ed6\u4f7f\u7528\u7684\u573a\u5408\uff0c\u5b83\u4e3b\u8981\u662f\u4e3a\u4e86\u533a\u5206\u5728 Spring \u5185\u90e8\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u5bf9\u8c61\u7684\u4f20\u9012\u548c\u8f6c\u5316\u8fc7\u7a0b\u4e2d\uff0c\u5bf9\u5bf9\u8c61\u7684\u6570\u636e\u8bbf\u95ee\u6240\u505a\u7684\u9650\u5236\u3002"),(0,i.kt)("p",null,"\u200b\t\t\u4f8b\u5982 ListableBeanFactory \u63a5\u53e3\u8868\u793a\u8fd9\u4e9b Bean \u662f\u53ef\u5217\u8868\u7684\uff0c\u800c HierarchicalBeanFactory \u8868\u793a\u7684\u662f\u8fd9\u4e9b Bean \u662f\u6709\u7ee7\u627f\u5173\u7cfb\u7684\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e2aBean \u6709\u53ef\u80fd\u6709\u7236 Bean\u3002AutowireCapableBeanFactory \u63a5\u53e3\u5b9a\u4e49 Bean \u7684\u81ea\u52a8\u88c5\u914d\u89c4\u5219\u3002\u8fd9\u4e09\u4e2a\u63a5\u53e3\u5171\u540c\u5b9a\u4e49\u4e86 Bean \u7684\u96c6\u5408\u3001Bean \u4e4b\u95f4\u7684\u5173\u7cfb\u3001\u4ee5\u53ca Bean \u884c\u4e3a."),(0,i.kt)("h2",{id:"32applicationcontext"},"3.2ApplicationContext"),(0,i.kt)("p",null,"\u200b\t\t\u6211\u4eec\u77e5\u9053ApplicationContext\u5bb9\u5668\u662f\u6269\u5c55BeanFactory\u5bb9\u5668\u800c\u6765\uff0c\u5728BeanFactory\u7684\u57fa\u672c\u8ba9IoC\u5bb9\u5668\u529f\u80fd\u66f4\u52a0\u4e30\u5bcc\u3002\u5982\u8bf4BeanFactory\u662fSping\u7684\u5fc3\u810f\uff08\u63d0\u4f9b\u4e86IOC\u5bb9\u5668\u7684\u57fa\u672c\u529f\u80fd\uff09\uff0c\u90a3\u4e48ApplicationContext\u5c31\u662f\u5b8c\u6574\u7684\u8eab\u8eaf\u4e86\uff08\u63d0\u4f9b\u66f4\u52a0\u9ad8\u7ea7\u7684\u529f\u80fd\uff09\u3002\u6240\u4ee5\u6211\u4eec\u6765\u770b\u4e00\u4e0bApplicationContext\u548c\u5b83\u7684\u57fa\u7840\u5b9e\u73b0\u7c7b\u7684\u4f53\u7cfb\u7ed3\u6784\u56fe\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220324165449450.png?raw=true",alt:"image-20220324165449450"})),(0,i.kt)("h3",{id:"321applicationcontext\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b"},"3.2.1ApplicationContext\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b"),(0,i.kt)("p",null,"ApplicationContext\u7684\u4e2d\u6587\u610f\u601d\u4e3a\u201c\u5e94\u7528\u4e0a\u4e0b\u6587\u201d\uff0c\u5b83\u7ee7\u627f\u81eaBeanFactory\uff0c\u7ed9IOC\u5bb9\u5668\u63d0\u4f9b\u66f4\u52a0\u9ad8\u7ea7\u7684\u529f\u80fd\uff0c\u6240\u4ee5\u6211\u4eec\u79f0\u5b83\u4e3a\u9ad8\u7ea7\u5bb9\u5668\uff0cApplicationContext\u63a5\u53e3\u6709\u4ee5\u4e0b\u5e38\u7528\u7684\u5b9e\u73b0\u7c7b\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u5b9e\u73b0\u7c7b"),(0,i.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"ClassPathXmlApplicationContext"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4ece\u7cfb\u7edf\u7c7b\u8def\u5f84classpath\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff0c\u9002\u7528\u4e8exml\u914d\u7f6e\u7684\u65b9\u5f0f")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"FileSystemXmlApplicationContext"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4ece\u7cfb\u7edf\u78c1\u76d8\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff08\u5fc5\u987b\u6709\u8bbf\u95ee\u6743\u9650\uff09")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"XmlWebApplicationContext"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4eceweb\u5e94\u7528\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff0c\u9002\u7528\u4e8eweb\u5e94\u7528\u7684xml\u914d\u7f6e\u65b9\u5f0f")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"AnnotationConfigApplicationContext"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4eceJava\u6ce8\u89e3\u7684\u914d\u7f6e\u7c7b\u4e2dSpring\u7684ApplicationContext\u5bb9\u5668\u3002\u4f7f\u7528\u6ce8\u89e3\u907f\u514d\u4f7f\u7528application.xml\u8fdb\u884c\u914d\u7f6e\u3002\u76f8\u6bd4XML\u914d\u7f6e\uff0c\u66f4\u52a0\u4fbf\u6377")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"AnnotationConfigWebApplicationContext"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4e13\u95e8\u4e3aweb\u5e94\u7528\u51c6\u5907\u7684\u7528\u4e8e\u8bfb\u53d6\u6ce8\u89e3\u521b\u5efa\u5bb9\u5668\u7684\u7c7b")))),(0,i.kt)("p",null,"(1)\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"ClassPathXmlApplicationContext"),"\uff1a\u4ece\u7cfb\u7edf\u7c7b\u8def\u5f84classpath\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff0c\u627e\u5230\u5e76\u88c5\u8f7d\u5b8c\u6210ApplicationContext\u7684\u5b9e\u4f8b\u5316\u5de5\u4f5c\u3002\u4f8b\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");\n')),(0,i.kt)("p",null,"(2)\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"FileSystemXmlApplicationContext"),"\uff1a\u4ece\u7cfb\u7edf\u78c1\u76d8\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff08\u5fc5\u987b\u6709\u8bbf\u95ee\u6743\u9650\uff09\u3002\u4e5f\u5c31\u662f\u8bfb\u53d6\u7cfb\u7edf\u78c1\u76d8\u6307\u5b9a\u8def\u5f84\u7684xml\u6587\u4ef6\u3002\u4f8b\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'ApplicationContext ac = new FileSystemXmlApplicationContext("c:/applicationContext.xml");\n')),(0,i.kt)("p",null,"\u5b83\u4e0eClassPathXmlApplicationContext\u7684\u533a\u522b\u5728\u4e8e\u8bfb\u53d6Spring\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\uff0cFileSystemXmlApplicationContext\u4e0d\u5728\u4ece\u7c7b\u8def\u5f84\u4e0b\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u662f\u901a\u8fc7\u5236\u5b9a\u53c2\u6570\u4ece\u7cfb\u7edf\u78c1\u76d8\u8bfb\u53d6\uff0c\u524d\u63d0\u662f\u6709\u8bbf\u95ee\u6743\u9650\u3002"),(0,i.kt)("p",null,"(3)\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"XmlWebApplicationContext"),"\uff1a\u4eceweb\u5e94\u7528\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u6216\u591a\u4e2axml\u914d\u7f6e\u6587\u4ef6\uff0c\u9002\u7528\u4e8eweb\u5e94\u7528\u7684xml\u914d\u7f6e\u65b9\u5f0f\u3002"),(0,i.kt)("p",null,"\u5728Java\u9879\u76ee\u4e2d\u63d0\u4f9bClassPathXmlApplicationContext\u7c7b\u624b\u5de5\u5b9e\u4f8b\u5316ApplicationContext\u5bb9\u5668\u901a\u5e38\u662f\u4e0d\u4e8c\u4e4b\u9009\uff0c\u4f46\u662f\u5bf9\u4e8eWeb\u9879\u76ee\u5c31\u4e0d\u884c\u4e86\uff0cWeb\u9879\u76ee\u7684\u542f\u52a8\u662f\u7531\u76f8\u5e94\u7684Web\u670d\u52a1\u5668\u8d1f\u8d23\u7684\uff0c\u56e0\u6b64\uff0c\u5728Web\u9879\u76ee\u4e2dApplicationContext\u5bb9\u5668\u7684\u5b9e\u4f8b\u5316\u5de5\u4f5c\u6700\u597d\u4ea4\u7531Web\u670d\u52a1\u5668\u6765\u5b8c\u6210\u3002Spring\u4e3a\u6b64\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"org.springframework.web.context.ContextLoaderListener"),(0,i.kt)("li",{parentName:"ul"},"org.springframework.web.context.ContexLoaderServlet\uff08\u6b64\u65b9\u6cd5\u76ee\u524d\u4ee5\u5e9f\u5f03\uff09")),(0,i.kt)("p",null,"ContextLoaderListener\u65b9\u5f0f\u53ea\u9002\u7528\u4e8eServlet2.4\u53ca\u4ee5\u4e0a\u89c4\u8303\u7684Servlet\uff0c\u5e76\u4e14\u9700\u8981Web\u73af\u5883\u3002\u6211\u4eec\u9700\u8981\u5728web.xml\u4e2d\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\x3c!--\u4ece\u7c7b\u8def\u5f84\u4e0b\u52a0\u8f7dSpring\u914d\u7f6e\u6587\u4ef6\uff0cclasspath\u7279\u6307\u7c7b\u8def\u5f84\u4e0b\u52a0\u8f7d--\x3e\n<context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:applicationContext.xml</param-value>\n</context-param>\n\x3c!--\u4ee5Listener\u7684\u65b9\u5f0f\u542f\u52a8spring\u5bb9\u5668--\x3e\n<listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n</listener>\n")),(0,i.kt)("p",null,"Spring\u5bb9\u5668\u542f\u52a8\u540e\u5c31\u53ef\u4ee5\u5728\u9879\u76ee\u4e2d\u83b7\u53d6\u5bf9\u5e94\u7684\u5b9e\u4f8b\u4e86\u3002\u4f8b\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@WebServlet("/MyServlet")\npublic class MyServlet {\n\n        public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n            //\u521b\u5efaXmlWebApplicationContext\u5bf9\u8c61\uff0c\u4f46\u8fd9\u65f6\u5e76\u6ca1\u6709\u521d\u59cb\u5316\u5bb9\u5668\n            XmlWebApplicationContext context = new XmlWebApplicationContext();\n            // \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\n            context.setConfigLocation("application.xml");\n            // \u9700\u8981\u6307\u5b9aServletContext\u5bf9\u8c61\n            context.setServletContext(request.getServletContext());\n            // \u521d\u59cb\u5316\u5bb9\u5668\n            context.refresh();\n            //\u83b7\u53d6\u5b9e\u4f8b\n            Additive additive = (Additive) context.getBean("additive");\n            additive.addAdditive();\n\n        }\n}\n')),(0,i.kt)("p",null,"(4)\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"AnnotationConfigApplicationContext"),"\uff1a\u4eceJava\u6ce8\u89e3\u7684\u914d\u7f6e\u7c7b\u4e2d\u52a0\u8f7dSpring\u7684ApplicationContext\u5bb9\u5668\u3002\u4f7f\u7528\u6ce8\u89e3\u907f\u514d\u4f7f\u7528application.xml\u8fdb\u884c\u914d\u7f6e\u3002\u76f8\u6bd4XML\u914d\u7f6e\uff0c\u66f4\u52a0\u4fbf\u6377\u3002"),(0,i.kt)("p",null,"\u521b\u5efa\u4e00\u4e2aAppConfig\u914d\u7f6e\u7c7b(OrangeJuice\u548cAdditive\u7c7b\u53c2\u8003\u4e0a\u4e00\u7ae0\u5185\u5bb9)\u3002\u4f8b\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class AppConfig {\n\n    @Bean(name = "orangeJuice")\n    public OrangeJuice orangeJuice(){\n        OrangeJuice orangeJuice = new OrangeJuice();\n        return orangeJuice;\n    }\n\n    @Bean(name = "additive")\n    public Additive additive(){\n        Additive additive = new Additive();\n        return additive;\n    }\n}\n')),(0,i.kt)("p",null,"\u6ce8\u610f\uff1a@Configuration\u548c@Bean\u6ce8\u89e3\u7684\u4ecb\u7ecd\u548c\u7406\u89e3"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"@Configuration\u53ef\u7406\u89e3\u4e3a\u7528spring\u7684\u65f6\u5019xml\u91cc\u9762\u7684\u6807\u7b7e\u3002"),(0,i.kt)("li",{parentName:"ul"},"@Bean\u53ef\u7406\u89e3\u4e3a\u7528spring\u7684\u65f6\u5019xml\u91cc\u9762\u7684\u6807\u7b7e\uff0c\u9ed8\u8ba4name\u4e3a\u65b9\u6cd5\u540d\u3002")),(0,i.kt)("p",null,"\u4f7f\u7528AnnotationConfigApplicationContext\u83b7\u53d6Spring\u5bb9\u5668\u5b9e\u4f8b\u3002\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//\u521b\u5efaAnnotationConfigApplicationContext\u5bf9\u8c61\uff0c\u6b64\u65f6\u5e76\u6ca1\u6709\u521d\u59cb\u5316\u5bb9\u5668\nAnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();\n//\u5c06AppConfig\u4e2d\u7684\u914d\u7f6e\u6ce8\u518c\u81f3\u5bb9\u5668\u4e2d\ncontext.register(AppConfig.class);\n// \u521d\u59cb\u5316\u5bb9\u5668\ncontext.refresh();\n\n//\u83b7\u53d6\u5b9e\u4f8b\u5bf9\u8c61\nOrangeJuice orangeJuice = (OrangeJuice) context.getBean("orangeJuice");\nAdditive additive = (Additive) context.getBean("additive");\norangeJuice.setAdditive(additive);\norangeJuice.needOrangeJuice();\n')),(0,i.kt)("p",null,"(5)\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"AnnotationConfigWebApplicationContext"),"\uff1a\u4e13\u95e8\u4e3aweb\u5e94\u7528\u51c6\u5907\u7684\u7528\u4e8e\u8bfb\u53d6\u6ce8\u89e3\u521b\u5efa\u5bb9\u5668\u7684\u7c7b\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u662fWeb\u9879\u76ee\u4f7f\u7528@Configuration\u7684java\u7c7b\u63d0\u4f9b\u914d\u7f6e\u4fe1\u606f\u7684\u914d\u7f6e web.xml \u914d\u7f6e\u4fee\u6539\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\x3c!--\u901a\u8fc7\u6307\u5b9acontext\u53c2\u6570\uff0c\u8ba9Spring\u4f7f\u7528AnnotationConfigWebApplicationContext\u542f\u52a8\u5bb9\u5668\n\u800c\u975eXmlWebApplicationContext\u3002\u9ed8\u8ba4\u6ca1\u914d\u7f6e\u65f6\u662f\u4f7f\u7528XmlWebApplicationContext--\x3e\n<context-param>\n    <param-name>contextClass</param-name>\n    <param-value>\n        org.springframework.web.context.support.AnnotationConfigWebApplicationContext\n    </param-value>\n</context-param>\n\x3c!--\u6307\u5b9a\u6807\u6ce8\u4e86@Configuration\u7684\u7c7b\uff0c\u591a\u4e2a\u53ef\u4ee5\u7528\u9017\u53f7\u5206\u9694--\x3e\n<context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>com.thr.AppConfig</param-value>\n</context-param>\n\x3c!--\u76d1\u542c\u5668\u5c06\u6839\u636e\u4e0a\u9762\u7684\u914d\u7f6e\u4f7f\u7528AnnotationConfigWebApplicationContext\n\u6839\u636econtextConfigLocation\u6307\u5b9a\u7684\u914d\u7f6e\u7c7b\u542f\u52a8Spring\u5bb9\u5668--\x3e\n<listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n</listener>\n")),(0,i.kt)("h3",{id:"322applicationcontext\u5bb9\u5668\u6269\u5c55\u529f\u80fd\u8be6\u89e3\u4ecb\u7ecd"},"3.2.2ApplicationContext\u5bb9\u5668\u6269\u5c55\u529f\u80fd\u8be6\u89e3\u4ecb\u7ecd"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220324165910788.png?raw=true",alt:"image-20220324165910788"})),(0,i.kt)("p",null,"ApplicationContext\u5bb9\u5668\u6b63\u662f\u56e0\u4e3a\u7ee7\u627f\u4e86\u7ea2\u6846\u4e2d\u7684\u8fd9\u4e9b\u63a5\u53e3\uff0c\u4f7f\u7528\u624d\u8ba9ApplicationContext\u5bb9\u5668\u6709\u4e86\u66f4\u52a0\u9ad8\u7ea7\u7684\u529f\u80fd\u3002\u6240\u4ee5\u4e0b\u9762\u6765\u8be6\u7ec6\u4ecb\u7ecd\u7ea2\u6846\u4e2d\u5404\u4e2a\u63a5\u53e3\uff1a"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(1)\u3001ListableBeanFactory\u2014\u2014\u53ef\u5c06Bean\u9010\u4e00\u5217\u51fa\u7684\u5de5\u5382")),(0,i.kt)("p",null,"ListableBeanFactory\u63a5\u53e3\u80fd\u591f\u5217\u51fa\u5de5\u5382\u4e2d\u6240\u6709\u7684bean\uff0c\u4e0b\u9762\u662f\u8be5\u63a5\u53e3\u7684\u6e90\u7801\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * ListableBeanFactory\u6e90\u7801\u4ecb\u7ecd\n */\npublic interface ListableBeanFactory extends BeanFactory {\n    //\u5224\u65ad\u662f\u5426\u5305\u542b\u7ed9\u5b9a\u540d\u5b57\u7684bean\u7684\u5b9a\u4e49\n    boolean containsBeanDefinition(String beanName);\n    //\u83b7\u53d6\u5de5\u5382\u4e2dbean\u7684\u5b9a\u4e49\u7684\u6570\u91cf\n    int getBeanDefinitionCount();\n    //\u83b7\u53d6\u5de5\u5382\u4e2d\u6240\u6709\u5b9a\u4e49\u4e86\u7684bean\u7684\u540d\u5b57\uff08\u5305\u62ec\u5b50\u7c7b\uff09\n    String[] getBeanDefinitionNames();\n\n    //\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u7684bean\u7684\u540d\u5b57(includeNonSingletons\u4e3afalse\u8868\u793a\u53ea\u53d6\u5355\u4f8bBean\uff0ctrue\u5219\u4e0d\u662f;\n    //allowEagerInit\u4e3atrue\u8868\u793a\u7acb\u523b\u52a0\u8f7d\uff0cfalse\u8868\u793a\u5ef6\u8fdf\u52a0\u8f7d\u3002 \u6ce8\u610f\uff1aFactoryBeans\u90fd\u662f\u7acb\u523b\u52a0\u8f7d\u7684\u3002)\n    String[] getBeanNamesForType(ResolvableType type);\n    String[] getBeanNamesForType(ResolvableType type, boolean includeNonSingletons, boolean allowEagerInit);\n    String[] getBeanNamesForType(@Nullable Class<?> type);\n    String[] getBeanNamesForType(@Nullable Class<?> type, boolean includeNonSingletons, boolean allowEagerInit);\n\n    //\u6839\u636e\u6307\u5b9a\u7684\u7c7b\u578b\u6765\u83b7\u53d6\u6240\u6709\u7684bean\u540d\u548cbean\u5bf9\u8c61\u7684Map\u96c6\u5408\uff08\u5305\u62ec\u5b50\u7c7b\uff09\n    <T> Map<String, T> getBeansOfType(@Nullable Class<T> type) throws BeansException;\n    <T> Map<String, T> getBeansOfType(@Nullable Class<T> type, boolean includeNonSingletons, boolean allowEagerInit)\n            throws BeansException;\n\n    //\u6839\u636e\u6ce8\u89e3\u7c7b\u578b\uff0c\u83b7\u53d6\u6240\u6709\u6709\u8fd9\u4e2a\u6ce8\u89e3\u7684bean\u540d\u79f0\n    String[] getBeanNamesForAnnotation(Class<? extends Annotation> annotationType);\n    //\u6839\u636e\u6ce8\u89e3\u7c7b\u578b\uff0c\u83b7\u53d6\u6240\u6709\u6709\u8fd9\u4e2a\u6ce8\u89e3\u7684bean\u540d\u548cbean\u5bf9\u8c61\u7684Map\u96c6\u5408\n    Map<String, Object> getBeansWithAnnotation(Class<? extends Annotation> annotationType) throws BeansException;\n    //\u6839\u636ebean\u540d\u548c\u6ce8\u89e3\u7c7b\u578b\u67e5\u627e\u6240\u6709\u6307\u5b9a\u7684\u6ce8\u89e3\uff08\u4f1a\u8003\u8651\u63a5\u53e3\u548c\u7236\u7c7b\u4e2d\u7684\u6ce8\u89e3\uff09\n    @Nullable\n    <A extends Annotation> A findAnnotationOnBean(String beanName, Class<A> annotationType)\n            throws NoSuchBeanDefinitionException;\n}\n")),(0,i.kt)("p",null,"\u4e0a\u9762\u7684\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u4e0d\u8003\u8651\u7956\u5148\u5de5\u5382\u4e2d\u7684bean\uff0c\u53ea\u4f1a\u8003\u8651\u5728\u5f53\u524d\u5de5\u5382\u4e2d\u5b9a\u4e49\u7684bean\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(2)\u3001HierarchicalBeanFactory\u2014\u2014\u5206\u5c42\u7684Bean\u5de5\u5382")),(0,i.kt)("p",null,"HierarchicalBeanFactory\u63a5\u53e3\u5b9a\u4e49\u4e86BeanFactory\u4e4b\u95f4\u7684\u5206\u5c42\u7ed3\u6784\uff0cConfigurableBeanFactory\u4e2d\u7684setParentBeanFactory\u65b9\u6cd5\u80fd\u8bbe\u7f6e\u7236\u7ea7\u7684BeanFactory\uff0c\u4e0b\u9762\u5217\u51fa\u4e86HierarchicalBeanFactory\u4e2d\u5b9a\u4e49\u7684\u65b9\u6cd5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * HierarchicalBeanFactory\u6e90\u7801\u4ecb\u7ecd\n */\npublic interface HierarchicalBeanFactory extends BeanFactory {\n\n    //\u83b7\u53d6\u672cBean\u5de5\u5382\u7684\u7236\u5de5\u5382\n    @Nullable\n    BeanFactory getParentBeanFactory();\n\n    //\u672c\u5730\u7684\u5de5\u5382\u662f\u5426\u5305\u542b\u6307\u5b9a\u540d\u5b57\u7684bean\n    boolean containsLocalBean(String name);\n}\n")),(0,i.kt)("p",null,"\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u90fd\u6bd4\u8f83\u76f4\u63a5\u660e\u4e86\uff0cgetParentBeanFactory\u65b9\u6cd5\u7528\u4e8e\u83b7\u53d6\u7236\u7ea7BeanFactory\u3002containsLocalBean\u7528\u4e8e\u5224\u65ad\u672c\u5730\u7684\u5de5\u5382\u662f\u5426\u5305\u542b\u6307\u5b9a\u7684bean\uff0c\u5ffd\u7565\u5728\u7956\u5148\u5de5\u5382\u4e2d\u5b9a\u4e49\u7684bean\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(3)\u3001MessageSource\u2014\u2014\u6d88\u606f\u7684\u56fd\u9645\u5316")),(0,i.kt)("p",null,"\u5728\u524d\u9762\u4e5f\u63d0\u5230\u8fc7MessageSource\uff0c\u5b83\u4e3b\u8981\u7528\u4e8e\u6d88\u606f\u7684\u56fd\u9645\u5316\uff0c\u4e0b\u9762\u662f\u8be5\u63a5\u53e3\u7684\u6e90\u7801\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// \u83b7\u53d6\u6d88\u606f\nString getMessage(String code, Object[] args, String defaultMessage, Locale locale);\nString getMessage(String code, Object[] args, Locale locale) throws NoSuchMessageException;\nString getMessage(MessageSourceResolvable resolvable, Locale locale) throws NoSuchMessageException;\n")),(0,i.kt)("p",null,"\u4ee5\u4e0a\u7684\u4e09\u4e2a\u65b9\u6cd5\u90fd\u662f\u7528\u4e8e\u83b7\u53d6\u6d88\u606f\u7684\uff0c\u7b2c\u4e00\u4e2a\u65b9\u6cd5\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u6d88\u606f\uff0c\u7b2c\u4e8c\u4e2a\u63a5\u53e3\u5982\u679c\u6ca1\u6709\u83b7\u53d6\u5230\u6307\u5b9a\u7684\u6d88\u606f\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u7b2c\u4e09\u4e2a\u63a5\u53e3\u4e2d\u7684MessageSourceResolvable\u53c2\u6570\u662f\u5bf9\u4ee3\u7801\u3001\u53c2\u6570\u503c\u3001\u9ed8\u8ba4\u503c\u7684\u4e00\u4e2a\u5c01\u88c5\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(4)\u3001ApplicationEventPublisher")),(0,i.kt)("p",null,"ApplicationEventPublisher\u63a5\u53e3\u5c01\u88c5\u4e86\u4e8b\u4ef6\u53d1\u5e03\u529f\u80fd\uff0c\u63d0\u4f9bSpring\u4e2d\u4e8b\u4ef6\u7684\u673a\u5236\u3002\u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\u5b9a\u4e49\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// \u53d1\u5e03\u4e8b\u4ef6\nvoid publishEvent(ApplicationEvent event);\nvoid publishEvent(Object event);\n")),(0,i.kt)("p",null,"\u7b2c\u4e00\u4e2a\u65b9\u6cd5\u7528\u4e8e\u53d1\u5e03\u7279\u5b9a\u4e8e\u5e94\u7528\u7a0b\u5e8f\u4e8b\u4ef6\u3002\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u80fd\u53d1\u5e03\u4efb\u610f\u7684\u4e8b\u4ef6\uff0c\u5982\u679c\u4e8b\u4ef6\u4e0d\u662fApplicationEvent\uff0c\u90a3\u4e48\u4f1a\u88ab\u5305\u88f9\u6210PayloadApplicationEvent\u4e8b\u4ef6\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(5)\u3001EnvironmentCapable")),(0,i.kt)("p",null,"EnvironmentCapable\u63d0\u4f9b\u4e86\u8bbf\u95eeEnvironment\u7684\u80fd\u529b\uff0c\u8be5\u63a5\u53e3\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"Environment getEnvironment();\n")),(0,i.kt)("p",null,"Environment\u8868\u793a\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1aprofiles\u548cproperties\u3002\u5b83\u7684\u7236\u7ea7\u63a5\u53e3PropertyResolver\u63d0\u4f9b\u4e86property\u7684\u8bbf\u95ee\u80fd\u529b\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"(6)\u3001ResourceLoader\u548cResourcePatternResolver")),(0,i.kt)("p",null,"\u9996\u5148\u6765\u770b\u4e00\u4e0bResourceLoader\uff0c\u542c\u540d\u5b57\u5c31\u77e5\u9053\u8be5\u63a5\u53e3\u662f\u7528\u6765\u52a0\u8f7d\u8d44\u6e90\u7684\u7b56\u7565\u63a5\u53e3\uff08\u4f8b\u5982\u7c7b\u8def\u5f84\u6216\u8005\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u8d44\u6e90\uff09\u3002\u8be5\u63a5\u53e3\u4e2d\u7684\u6e90\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * ResourceLoader\u6e90\u7801\u4ecb\u7ecd\n */\npublic interface ResourceLoader {\n\n    //\u7528\u4e8e\u4ece\u7c7b\u8def\u5f84\u52a0\u8f7d\u7684\u4f2aURL\u524d\u7f00:" classpath:"\u3002\n    String CLASSPATH_URL_PREFIX = ResourceUtils.CLASSPATH_URL_PREFIX;\n    //\u6839\u636e\u6307\u5b9a\u7684\u4f4d\u7f6e\u83b7\u53d6\u8d44\u6e90\n    Resource getResource(String location);\n    //\u83b7\u53d6\u8be5\u8d44\u6e90\u52a0\u8f7d\u5668\u6240\u4f7f\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\n    ClassLoader getClassLoader();\n}\n')),(0,i.kt)("p",null,"\u8be5\u63a5\u53e3\u53ea\u6709\u7b80\u5355\u660e\u4e86\u7684\u4e24\u4e2a\u65b9\u6cd5\uff0c\u4e00\u4e2a\u662f\u7528\u6765\u83b7\u53d6\u6307\u5b9a\u4f4d\u7f6e\u7684\u8d44\u6e90\uff0c\u4e00\u4e2a\u7528\u4e8e\u83b7\u53d6\u8d44\u6e90\u52a0\u8f7d\u5668\u6240\u4f7f\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\u3002"),(0,i.kt)("p",null,"Resource\u662f\u4ece\u5b9e\u9645\u7c7b\u578b\u7684\u5e95\u5c42\u8d44\u6e90\uff08\u4f8b\u5982\u6587\u4ef6\u3001\u7c7b\u8def\u5f84\u8d44\u6e90\uff09\u8fdb\u884c\u62bd\u8c61\u7684\u8d44\u6e90\u63cf\u8ff0\u7b26\u3002\u518d\u770b\u4e0bResource\u7684\u6e90\u7801\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * Resource\u6e90\u7801\u4ecb\u7ecd\n */\npublic interface Resource extends InputStreamSource {\n\n    boolean exists(); // \u8d44\u6e90\u5b9e\u9645\u4e0a\u662f\u5426\u5b58\u5728\n\n    boolean isReadable(); // \u8d44\u6e90\u662f\u5426\u53ef\u8bfb\n\n    boolean isOpen(); // \u68c0\u67e5\u8d44\u6e90\u662f\u5426\u4e3a\u6253\u5f00\u7684\u6d41\n\n    boolean isFile(); // \u8d44\u6e90\u662f\u5426\u4e3a\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u4e00\u4e2a\u6587\u4ef6\n\n    URL getURL() throws IOException; // \u83b7\u53d6url\n\n    URI getURI() throws IOException; // \u83b7\u53d6URI\n\n    File getFile() throws IOException; // \u83b7\u53d6\u6587\u4ef6\n\n    ReadableByteChannel readableChannel() throws IOException; // \u83b7\u53d6ReadableByteChannel\n\n    long contentLength() throws IOException; // \u8d44\u6e90\u7684\u5185\u5bb9\u7684\u957f\u5ea6\n\n    long lastModified() throws IOException; // \u8d44\u6e90\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\n\n    // \u76f8\u5bf9\u4e8e\u5f53\u524d\u7684\u8d44\u6e90\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\n    Resource createRelative(String relativePath) throws IOException;\n\n    String getFilename(); // \u83b7\u53d6\u8d44\u6e90\u7684\u6587\u4ef6\u540d\n\n    String getDescription(); // \u83b7\u53d6\u8d44\u6e90\u7684\u63cf\u8ff0\u4fe1\u606f\n}\n")),(0,i.kt)("p",null,"Resource\u7684\u7236\u7ea7\u63a5\u53e3\u4e3aInputStreamSource\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3aInputStream\u7684\u6765\u6e90\uff0c\u5176\u5185\u90e8\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// \u83b7\u53d6\u8f93\u5165\u6d41\nInputStream getInputStream() throws IOException; \n")),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\u5728\u6765\u770b\u4e00\u4e0bResourcePatternResolver\uff0c\u8be5\u63a5\u53e3\u7528\u4e8e\u89e3\u6790\u4e00\u4e2a\u4f4d\u7f6e\u6a21\u5f0f\uff08\u4f8b\u5982Ant\u98ce\u683c\u7684\u8def\u5f84\u6a21\u5f0f\uff09\uff0c\u8be5\u63a5\u53e3\u4e5f\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// \u5c06\u7ed9\u5b9a\u7684\u4f4d\u7f6e\u6a21\u5f0f\u89e3\u6790\u6210\u8d44\u6e90\u5bf9\u8c61\nResource[] getResources(String locationPattern) throws IOException;\n")),(0,i.kt)("h2",{id:"33beanfactory\u548capplicationcontext\u7684\u533a\u522b"},"3.3BeanFactory\u548cApplicationContext\u7684\u533a\u522b"),(0,i.kt)("p",null,"BeanFactory\u548cApplicationContext\u662fSpring IOC\u5bb9\u5668\u7684\u4e24\u5927\u6838\u5fc3\u63a5\u53e3\uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u5f53\u505aSpring\u7684\u5bb9\u5668\u3002\u5176\u4e2dApplicationContext\u662fBeanFactory\u7684\u5b50\u63a5\u53e3\uff0c\u90a3\u4e48\u5b83\u4eec\u4e24\u8005\u4e4b\u95f4\u7684\u533a\u522b\u5728\u54ea\u5462\uff1f"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u2460\u3001\u63d0\u4f9b\u7684\u529f\u80fd\u4e0d\u540c\uff1a")),(0,i.kt)("p",null,"BeanFactory\uff1a\u662fSpring\u91cc\u9762\u6700\u5e95\u5c42\u7684\u63a5\u53e3\uff0c\u5b83\u53ea\u63d0\u4f9b\u4e86IOC\u5bb9\u5668\u6700\u57fa\u672c\u7684\u529f\u80fd\uff0c\u7ed9\u5177\u4f53\u7684IOC\u5bb9\u5668\u7684\u5b9e\u73b0\u63d0\u4f9b\u4e86\u89c4\u8303\u3002\u5305\u542b\u4e86\u5404\u79cdBean\u7684\u5b9a\u4e49\uff0c\u8bfb\u53d6bean\u914d\u7f6e\u6587\u6863\uff0c\u7ba1\u7406bean\u7684\u52a0\u8f7d\u3001\u5b9e\u4f8b\u5316\uff0c\u63a7\u5236bean\u7684\u751f\u547d\u5468\u671f\uff0c\u7ef4\u62a4bean\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u7b49\u3002"),(0,i.kt)("p",null,"ApplicationContext\uff1a\u5b83\u4f5c\u4e3aBeanFactory\u7684\u5b50\u63a5\u53e3\uff0c\u9664\u4e86\u63d0\u4f9bBeanFactory\u6240\u5177\u6709\u7684\u529f\u80fd\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u66f4\u5b8c\u6574\u7684\u6846\u67b6\u529f\u80fd\u3002\u6211\u4eec\u770b\u4e00\u4e0bApplicationContext\u7c7b\u7ed3\u6784\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface ApplicationContext extends \n                            EnvironmentCapable,\n                            ListableBeanFactory,\n                            HierarchicalBeanFactory,\n                            MessageSource,\n                            ApplicationEventPublisher,\n                            ResourcePatternResolver {\n\n}\n")),(0,i.kt)("p",null,"ApplicationContext\u989d\u5916\u63d0\u4f9b\u7684\u529f\u80fd\u6709\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u652f\u6301\u56fd\u9645\u5316\uff08MessageSource\uff09"),(0,i.kt)("li",{parentName:"ol"},"\u7edf\u4e00\u7684\u8d44\u6e90\u6587\u4ef6\u8bbf\u95ee\u65b9\u5f0f\uff08ResourcePatternResolver\uff09"),(0,i.kt)("li",{parentName:"ol"},"\u63d0\u4f9b\u5728\u76d1\u542c\u5668\u4e2d\u6ce8\u518cbean\u7684\u4e8b\u4ef6\uff08ApplicationEventPublisher\uff09"),(0,i.kt)("li",{parentName:"ol"},"\u540c\u65f6\u52a0\u8f7d\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6"),(0,i.kt)("li",{parentName:"ol"},"\u8f7d\u5165\u591a\u4e2a\uff08\u6709\u7ee7\u627f\u5173\u7cfb\uff09\u4e0a\u4e0b\u6587 \uff0c\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u4e0a\u4e0b\u6587\u90fd\u4e13\u6ce8\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u5c42\u6b21\uff0c\u6bd4\u5982\u5e94\u7528\u7684web\u5c42\uff08HierarchicalBeanFactory\uff09")),(0,i.kt)("p",null,"\u2461\u3001 \u542f\u52a8\u65f6\u7684\u72b6\u6001\u4e0d\u540c\uff1a"),(0,i.kt)("p",null,"\u200b\t\tBeanFactroy\u91c7\u7528\u7684\u662f\u5ef6\u8fdf\u52a0\u8f7d\u5f62\u5f0f\u6765\u6ce8\u5165Bean\u7684\uff0c\u5373\u53ea\u6709\u5728\u4f7f\u7528\u5230\u67d0\u4e2aBean\u65f6(\u8c03\u7528getBean())\uff0c\u624d\u5bf9\u8be5Bean\u8fdb\u884c\u52a0\u8f7d\u5b9e\u4f8b\u5316\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u4e0d\u80fd\u53d1\u73b0\u4e00\u4e9b\u5b58\u5728\u7684Spring\u7684\u914d\u7f6e\u95ee\u9898\u3002\u5982\u679cBean\u7684\u67d0\u4e00\u4e2a\u5c5e\u6027\u6ca1\u6709\u6ce8\u5165BeanFacotry\u52a0\u8f7d\u540e\uff0c\u76f4\u81f3\u7b2c\u4e00\u6b21\u4f7f\u7528\u8c03\u7528getBean\u65b9\u6cd5\u624d\u4f1a\u629b\u51fa\u5f02\u5e38\u3002"),(0,i.kt)("p",null,"\u200b\t\tApplicationContext\uff0c\u5b83\u662f\u5728\u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u4e00\u6b21\u6027\u521b\u5efa\u4e86\u6240\u6709\u7684Bean\u3002\u8fd9\u6837\uff0c\u5728\u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0Spring\u4e2d\u5b58\u5728\u7684\u914d\u7f6e\u9519\u8bef\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u68c0\u67e5\u6240\u4f9d\u8d56\u5c5e\u6027\u662f\u5426\u6ce8\u5165\u3002 ApplicationContext\u542f\u52a8\u540e\u9884\u8f7d\u5165\u6240\u6709\u7684\u5355\u5b9e\u4f8bBean\uff0c\u901a\u8fc7\u9884\u8f7d\u5165\u5355\u5b9e\u4f8bbean ,\u786e\u4fdd\u5f53\u4f60\u9700\u8981\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u4e0d\u7528\u7b49\u5f85\uff0c\u56e0\u4e3a\u5b83\u4eec\u5df2\u7ecf\u521b\u5efa\u597d\u4e86\u3002\u76f8\u5bf9\u4e8e\u57fa\u672c\u7684BeanFactory\uff0cApplicationContext \u552f\u4e00\u7684\u4e0d\u8db3\u662f\u5360\u7528\u5185\u5b58\u7a7a\u95f4\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6eBean\u8f83\u591a\u65f6\uff0c\u7a0b\u5e8f\u542f\u52a8\u8f83\u6162\u3002"),(0,i.kt)("p",null,"\u2462\u3001BeanFactory\u901a\u5e38\u4ee5\u7f16\u7a0b\u7684\u65b9\u5f0f\u88ab\u521b\u5efa\uff0cApplicationContext\u8fd8\u80fd\u4ee5\u58f0\u660e\u7684\u65b9\u5f0f\u521b\u5efa\uff0c\u5982\u4f7f\u7528ContextLoader\u3002"),(0,i.kt)("p",null,"\u2463\u3001BeanFactory\u548cApplicationContext\u90fd\u652f\u6301BeanPostProcessor\u3001BeanFactoryPostProcessor\u7684\u4f7f\u7528\uff0c\u4f46\u4e24\u8005\u4e4b\u95f4\u7684\u533a\u522b\u662f\uff1aBeanFactory\u9700\u8981\u624b\u52a8\u6ce8\u518c\uff0c\u800cApplicationContext\u5219\u662f\u81ea\u52a8\u6ce8\u518c\u3002"),(0,i.kt)("h2",{id:"34beanfactory\u548c-applicationcontext\u7684\u5173\u7cfb\u8be6\u89e3"},"3.4BeanFactory\u548c ApplicationContext\u7684\u5173\u7cfb\u8be6\u89e3"),(0,i.kt)("p",null,"Spring \u4f5c\u8005 Rod Johnson \u8bbe\u8ba1\u4e86\u4e24\u4e2a\u63a5\u53e3\u7528\u4ee5\u8868\u793a\u5bb9\u5668\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"BeanFactory"),(0,i.kt)("li",{parentName:"ul"},"ApplicationContext")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"BeanFactory "),"\u7b80\u5355\u7c97\u66b4\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c31\u662f\u4e2a HashMap\uff0cKey \u662f BeanName\uff0cValue \u662f Bean \u5b9e\u4f8b\u3002\u901a\u5e38\u53ea\u63d0\u4f9b\u6ce8\u518c\uff08put\uff09\uff0c\u83b7\u53d6\uff08get\uff09\u8fd9\u4e24\u4e2a\u529f\u80fd\u3002\u6211\u4eec\u53ef\u4ee5\u79f0\u4e4b\u4e3a \u201c\u4f4e\u7ea7\u5bb9\u5668\u201d\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ApplicationContext"),"\u53ef\u4ee5\u79f0\u4e4b\u4e3a \u201c\u9ad8\u7ea7\u5bb9\u5668\u201d\u3002\u56e0\u4e3a\u4ed6\u6bd4 BeanFactory \u591a\u4e86\u66f4\u591a\u7684\u529f\u80fd\u3002\u4ed6\u7ee7\u627f\u4e86\u591a\u4e2a\u63a5\u53e3\u3002\u56e0\u6b64\u5177\u5907\u4e86\u66f4\u591a\u7684\u529f\u80fd\u3002\u4f8b\u5982\u8d44\u6e90\u7684\u83b7\u53d6\uff0c\u652f\u6301\u591a\u79cd\u6d88\u606f\uff08\u4f8b\u5982 JSP tag \u7684\u652f\u6301\uff09\uff0c\u5bf9BeanFactory \u591a\u4e86\u5de5\u5177\u7ea7\u522b\u7684\u652f\u6301\u7b49\u5f85\u3002\u6240\u4ee5\u4f60\u770b\u4ed6\u7684\u540d\u5b57\uff0c\u5df2\u7ecf\u4e0d\u662f BeanFactory \u4e4b\u7c7b\u7684\u5de5\u5382\u4e86\uff0c\u800c\u662f \u201c\u5e94\u7528\u4e0a\u4e0b\u6587\u201d\uff0c \u4ee3\u8868\u7740\u6574\u4e2a\u5927\u5bb9\u5668\u7684\u6240\u6709\u529f\u80fd\u3002\u8be5\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e00\u4e2a refresh \u65b9\u6cd5\uff0c\u6b64\u65b9\u6cd5\u662f\u6240\u6709\u9605\u8bfbSpring \u6e90\u7801\u7684\u4eba\u7684\u6700\u719f\u6089\u7684\u65b9\u6cd5\uff0c\u7528\u4e8e\u5237\u65b0\u6574\u4e2a\u5bb9\u5668\uff0c\u5373\u91cd\u65b0\u52a0\u8f7d/\u5237\u65b0\u6240\u6709\u7684 bean\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c0f\u7ed3"),"\nIoC \u5728 Spring \u91cc\uff0c\u53ea\u9700\u8981\u4f4e\u7ea7\u5bb9\u5668\u5c31\u53ef\u4ee5\u5b9e\u73b0\uff0c2 \u4e2a\u6b65\u9aa4\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u89e3\u6790\u6210 BeanDefinition \u653e\u5728 Map \u91cc\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u8c03\u7528 getBean \u7684\u65f6\u5019\uff0c\u4ece BeanDefinition \u6240\u5c5e\u7684 Map \u91cc\uff0c\u62ff\u51faClass \u5bf9\u8c61\u8fdb\u884c\u5b9e\u4f8b\u5316\uff0c\u540c\u65f6\uff0c\u5982\u679c\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u5c06\u9012\u5f52\u8c03\u7528 getBean \u65b9\u6cd5 \u2014\u2014 \u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\u3002")),(0,i.kt)("p",null,"\u4e0a\u9762\u5c31\u662f Spring \u4f4e\u7ea7\u5bb9\u5668\uff08BeanFactory\uff09\u7684 IoC\u3002"),(0,i.kt)("p",null,"\u81f3\u4e8e\u9ad8\u7ea7\u5bb9\u5668 ApplicationContext\uff0c\u4ed6\u5305\u542b\u4e86\u4f4e\u7ea7\u5bb9\u5668\u7684\u529f\u80fd\uff0c\u5f53\u4ed6\u6267\u884c refresh \u6a21\u677f\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5c06\u5237\u65b0\u6574\u4e2a\u5bb9\u5668\u7684 Bean\u3002\u540c\u65f6\u5176\u4f5c\u4e3a\u9ad8\u7ea7\u5bb9\u5668\uff0c\u5305\u542b\u4e86\u592a\u591a\u7684\u529f\u80fd\u3002\u4e00\u53e5\u8bdd\uff0c\u4ed6\u4e0d\u4ec5\u4ec5\u662f IoC\u3002\u4ed6\u652f\u6301\u4e0d\u540c\u4fe1\u606f\u6e90\u5934\uff0c\u652f\u6301BeanFactory \u5de5\u5177\u7c7b\uff0c\u652f\u6301\u5c42\u7ea7\u5bb9\u5668\uff0c\u652f\u6301\u8bbf\u95ee\u6587\u4ef6\u8d44\u6e90\uff0c\u652f\u6301\u4e8b\u4ef6\u53d1\u5e03\u901a\u77e5\uff0c\u652f\u6301\u63a5\u53e3\u56de\u8c03\u7b49\u7b49\u3002"),(0,i.kt)("h2",{id:"35applicationcontext\u901a\u5e38\u7684\u5b9e\u73b0"},"3.5ApplicationContext\u901a\u5e38\u7684\u5b9e\u73b0"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"FileSystemXmlApplicationContext \uff1a\u6b64\u5bb9\u5668\u4ece\u4e00\u4e2aXML\u6587\u4ef6\u4e2d\u52a0\u8f7dbeans \u7684\u5b9a\u4e49\uff0cXML Bean \u914d\u7f6e\u6587\u4ef6\u7684\u5168\u8def\u5f84\u540d\u5fc5\u987b\u63d0\u4f9b\u7ed9\u5b83\u7684\u6784\u9020\u51fd\u6570\u3002"),(0,i.kt)("li",{parentName:"ul"},"ClassPathXmlApplicationContext\uff1a\u6b64\u5bb9\u5668\u4e5f\u4ece\u4e00\u4e2aXML\u6587\u4ef6\u4e2d\u52a0\u8f7dbeans \u7684\u5b9a\u4e49\uff0c\u8fd9\u91cc\uff0c\u4f60\u9700\u8981\u6b63\u786e\u8bbe\u7f6eclasspath\u56e0\u4e3a\u8fd9\u4e2a\u5bb9\u5668\u5c06\u5728classpath\u91cc\u627e bean\u914d\u7f6e\u3002"),(0,i.kt)("li",{parentName:"ul"},"WebXmlApplicationContext\uff1a\u6b64\u5bb9\u5668\u52a0\u8f7d\u4e00\u4e2aXML\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5b9a\u4e49\u4e86\u4e00\u4e2aWEB\u5e94\u7528\u7684\u6240\u6709bean\u3002")),(0,i.kt)("h1",{id:"4ioc\u5bb9\u5668\u7684\u521d\u59cb\u5316\u6b65\u9aa4"},"4.IOC\u5bb9\u5668\u7684\u521d\u59cb\u5316\u6b65\u9aa4"),(0,i.kt)("p",null,"\u200b\t\tIOC \u5bb9\u5668\u521d\u59cb\u5316\u5305\u62ecBeanDefinition\u7684Resource\u5b9a\u4f4d\u3001\u8f7d\u5165\u548c\u6ce8\u518c\u4e09\u4e2a\u57fa\u672c\u8fc7\u7a0b\uff0c\u5982\u679c\u6211\u4eec\u4e86\u89e3\u5982\u4f55\u7f16\u7a0b\u5f0f\u7684\u4f7f\u7528 IOC \u5bb9\u5668\uff08\u7f16\u7a0b\u5f0f\u5c31\u662f\u4f7f\u7528DefaultListableBeanFactory\u6765\u521b\u5efa\u5bb9\u5668\uff09\uff0c\u5c31\u53ef\u4ee5\u6e05\u695a\u7684\u770b\u5230Resource\u5b9a\u4e49\u548c\u8f7d\u5165\u8fc7\u7a0b\u7684\u63a5\u53e3\u8c03\u7528\u3002"),(0,i.kt)("p",null,"IOC \u5bb9\u5668\u7684\u521d\u59cb\u5316\u5305\u62ec\u7684\u4e09\u4e2a\u8fc7\u7a0b\u4ecb\u7ecd\u5982\u4e0b\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Resource\u5b9a\u4f4d\u8fc7\u7a0b"),"\uff1a\u8fd9\u4e2aResource\u5b9a\u4f4d\u6307\u7684\u662fBeanDefinition\u7684\u8d44\u6e90\u5b9a\u4f4d\uff0c\u5c31\u662f\u5bf9\u5f00\u53d1\u8005\u7684\u914d\u7f6e\u6587\u4ef6(Xml)\u8fdb\u884c\u8d44\u6e90\u7684\u5b9a\u4f4d\uff0c\u5e76\u5c06\u5176\u5c01\u88c5\u6210Resource\u5bf9\u8c61\u3002\u5b83\u7531ResourceLoader\u901a\u8fc7\u7edf\u4e00\u7684Resource\u63a5\u53e3\u6765\u5b8c\u6210\uff0c\u8fd9\u4e2aResource\u5bf9\u5404\u79cd\u5f62\u5f0f\u7684BeanDefinition\u7684\u4f7f\u7528\u90fd\u63d0\u4f9b\u4e86\u7edf\u4e00\u63a5\u53e3\u3002\u6bd4\u5982\uff1a\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684Bean\u5b9a\u4e49\u4fe1\u606f\u53ef\u4ee5\u4f7f\u7528FileSystemResource\u6765\u8fdb\u884c\u62bd\u8c61\u3002\u5728\u7c7b\u8def\u5f84\u4e2d\u7684Bean\u5b9a\u4e49\u4fe1\u606f\u53ef\u4ee5\u4f7f\u7528ClassPathResource\u6765\u8fdb\u884c\u62bd\u8c61\u7b49\u7b49\u3002\u8fd9\u4e2a\u5b9a\u4f4d\u8fc7\u7a0b\u7c7b\u4f3c\u4e8e\u5bb9\u5668\u5bfb\u627e\u6570\u636e\u7684\u8fc7\u7a0b\uff0c\u5c31\u50cf\u7528\u6c34\u6345\u88c5\u6c34\u5148\u8981\u628a\u6c34\u627e\u5230\u4e00\u6837\u3002"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"BeanDefinition\u7684\u8f7d\u5165"),"\uff1a\u8fd9\u4e2a\u8f7d\u5165\u8fc7\u7a0b\u662f\u5c06Resource \u5b9a\u4f4d\u5230\u7684\u4fe1\u606f\uff0c\u8868\u793a\u6210IOC\u5bb9\u5668\u5185\u90e8\u7684\u6570\u636e\u7ed3\u6784\uff0c\u800c\u8fd9\u4e2a\u5bb9\u5668\u5185\u90e8\u7684\u6570\u636e\u7ed3\u6784\u5c31\u662fBeanDefinition\u3002"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"BeanDefinition\u7684\u6ce8\u518c"),"\uff1a\u8fd9\u4e2a\u6ce8\u518c\u8fc7\u7a0b\u628a\u4e0a\u9762\u8f7d\u5165\u8fc7\u7a0b\u4e2d\u89e3\u6790\u5f97\u5230\u7684BeanDeftnition\u5411IoC\u5bb9\u5668\u8fdb\u884c\u6ce8\u518c\u3002\u6ce8\u518c\u8fc7\u7a0b\u662f\u901a\u8fc7\u8c03\u7528BeanDefinitionRegistry\u63a5\u53e3\u7684\u5b9e\u73b0\u6765\u5b8c\u6210\u7684\u3002\u5728IoC\u5bb9\u5668\u5185\u90e8\u5c06BeanDefinition\u6ce8\u5165\u5230\u4e00\u4e2aHashMap\u4e2d\u53bb\uff0cIoC\u5bb9\u5668\u5c31\u662f\u901a\u8fc7\u8fd9\u4e2aHashMap\u6765\u6301\u6709\u8fd9\u4e9bBeanDefinition\u6570\u636e\u7684\u3002")),(0,i.kt)("p",null,"\u6ce8\u610f\uff1aBean\u7684\u5b9a\u4e49\u548c\u521d\u59cb\u5316\u5728 Spring IoC \u5bb9\u5668\u662f\u4e24\u5927\u6b65\u9aa4\uff0c\u5b83\u662f\u5148\u5b9a\u4e49\uff0c\u7136\u540e\u518d\u662f\u521d\u59cb\u5316\u548c\u4f9d\u8d56\u6ce8\u5165\u3002\u6240\u4ee5\u5f53Spring\u505a\u5b8c\u4e86\u4ee5\u4e0a 3 \u6b65\u540e\uff0cBean \u5c31\u5728 Spring IoC \u5bb9\u5668\u4e2d\u88ab\u5b9a\u4e49\u4e86\uff0c\u800c\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u66f4\u6ca1\u6709\u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\uff0c\u6240\u4ee5\u6b64\u65f6\u4ecd\u7136\u6ca1\u6709\u5bf9\u5e94\u7684 Bean \u7684\u5b9e\u4f8b\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u6ce8\u5165\u5176\u914d\u7f6e\u7684\u8d44\u6e90\u7ed9 Bean\uff0c\u4e5f\u5c31\u662f\u5b83\u8fd8\u4e0d\u80fd\u5b8c\u5168\u4f7f\u7528\u3002\u5bf9\u4e8e\u521d\u59cb\u5316\u548c\u4f9d\u8d56\u6ce8\u5165\uff0cSpring Bean \u8fd8\u6709\u4e00\u4e2a\u914d\u7f6e\u9009\u9879\u2014\u2014",(0,i.kt)("strong",{parentName:"p"},"\u3010lazy-init\u3011"),"\uff0c\u5176\u542b\u4e49\u5c31\u662f\uff1a\u662f\u5426\u9ed8\u8ba4\u521d\u59cb\u5316 Spring Bean\u3002\u5728\u6ca1\u6709\u4efb\u4f55\u914d\u7f6e\u7684\u60c5\u51b5\u4e0b\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u4e3adefault\uff0c\u5b9e\u9645\u503c\u4e3a false(\u9ed8\u8ba4\u975e\u61d2\u52a0\u8f7d)\uff0c\u4e5f\u5c31\u662f Spring IoC \u5bb9\u5668\u9ed8\u8ba4\u4f1a\u81ea\u52a8\u521d\u59cb\u5316 Bean\u3002\u5982\u679c\u5c06\u5176\u8bbe\u7f6e\u4e3a true\uff08\u61d2\u52a0\u8f7d\uff09\uff0c\u90a3\u4e48\u53ea\u6709\u5f53\u6211\u4eec\u4f7f\u7528 Spring IoC \u5bb9\u5668\u7684 getBean \u65b9\u6cd5\u83b7\u53d6\u5b83\u65f6\uff0c\u5b83\u624d\u4f1a\u8fdb\u884c Bean \u7684\u521d\u59cb\u5316\uff0c\u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\u3002"),(0,i.kt)("h2",{id:"41beandefinition\u7684resource\u5b9a\u4f4d"},"4.1BeanDefinition\u7684Resource\u5b9a\u4f4d"),(0,i.kt)("p",null,"\u5728Spring\u6846\u67b6\u4e2d\uff0c\u5982\u679c\u60f3\u8981\u83b7\u53d6\u7cfb\u7edf\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5c31\u5fc5\u987b\u901a\u8fc7Resource\u63a5\u53e3\u7684\u5b9e\u73b0\u6765\u5b8c\u6210\uff0cResource\u662fSping\u4e2d\u7528\u4e8e\u5c01\u88c5I/O\u64cd\u4f5c\u7684\u63a5\u53e3\u3002\u9996\u5148\u662f\u5b9a\u4e49\u4e00\u4e2aResource\u6765\u5b9a\u4f4d\u5bb9\u5668\u4f7f\u7528\u7684BeanDefinition\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684\u662fResource\u7684\u5b9e\u73b0\u7c7bClassPathResource\uff0c\u8fd9\u65f6Spring\u4f1a\u5728\u7c7b\u8def\u5f84\u4e2d\u53bb\u5bfb\u627e\u4ee5\u6587\u4ef6\u5f62\u5f0f\u5b58\u5728BeanDefinition\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'ClassPathResource resource = new ClassPathResource("beans.xml");\n')),(0,i.kt)("p",null,"\u4f46\u662f\u8fd9\u91cc\u7684Resource\u5e76\u4e0d\u80fd\u7531 DefaultListableBeanFactory \u76f4\u63a5\u4f7f\u7528\uff0c\u800c\u662f\u9700\u8981\u901a\u8fc7Spring\u4e2d\u7684 BeanDefinitionReader \u6765\u5bf9\u8fd9\u4e9b\u4fe1\u606f\u8fdb\u884c\u5904\u7406\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u770b\u5230\u4f7f\u7528 ApplicationContext \u76f8\u5bf9\u4e8e\u76f4\u63a5\u4f7f\u7528 DefaultListableBeanFactory \u7684\u597d\u5904\uff0c\u56e0\u4e3a\u5728ApplicationContext\u4e2d\uff0cSpring\u5df2\u7ecf\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u52a0\u8f7d\u4e0d\u540cResource\u7684\u8bfb\u53d6\u5668\u5b9e\u73b0\uff0c\u800c\u5728 DefaultListableBeanFactory \u53ea\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684IOC\u5bb9\u5668\uff0c\u9700\u8981\u4e3a\u5b83\u914d\u7f6e\u914d\u7f6e\u7279\u5b9a\u7684\u8bfb\u53d6\u5668\u624d\u80fd\u5b8c\u6210\u8fd9\u4e9b\u529f\u80fd\uff0c\u5f53\u7136\u4e86 \u5229\u548c\u5f0a \u662f\u5171\u5b58\u7684\uff0c\u4f7f\u7528 DefaultListableBeanFactory \u8fd9\u6837\u66f4\u5e95\u5c42\u7684IOC\u5bb9\u5668\uff0c\u80fd\u63d0\u9ad8\u5b9a\u5236IOC\u5bb9\u5668\u7684\u7684\u7075\u6d3b\u6027\u3002"),(0,i.kt)("p",null,"\u5e38\u7528\u7684Resource\u8d44\u6e90\u7c7b\u578b\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"FileSystemResource\uff1a\u4ee5\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u65b9\u5f0f\u8fdb\u884c\u8bbf\u95ee\u8d44\u6e90\uff0c\u6548\u679c\u7c7b\u4f3c\u4e8eJava\u4e2d\u7684File;"),(0,i.kt)("li",{parentName:"ul"},'ClassPathResourcee\uff1a\u4ee5\u7c7b\u8def\u5f84\u7684\u65b9\u5f0f\u8bbf\u95ee\u8d44\u6e90\uff0c\u6548\u679c\u7c7b\u4f3c\u4e8ethis.getClass().getResource("/").getPath();'),(0,i.kt)("li",{parentName:"ul"},'ServletContextResource\uff1aweb\u5e94\u7528\u6839\u76ee\u5f55\u7684\u65b9\u5f0f\u8bbf\u95ee\u8d44\u6e90\uff0c\u6548\u679c\u7c7b\u4f3c\u4e8erequest.getServletContext().getRealPath("");'),(0,i.kt)("li",{parentName:"ul"},"UrlResource\uff1a\u8bbf\u95ee\u7f51\u7edc\u8d44\u6e90\u7684\u5b9e\u73b0\u7c7b\u3002\u4f8b\u5982file: http: ftp:\u7b49\u524d\u7f00\u7684\u8d44\u6e90\u5bf9\u8c61;"),(0,i.kt)("li",{parentName:"ul"},"ByteArrayResource: \u8bbf\u95ee\u5b57\u8282\u6570\u7ec4\u8d44\u6e90\u7684\u5b9e\u73b0\u7c7b\u3002")),(0,i.kt)("p",null,"ApplicationContext\u4e0a\u6765\uff0c\u5b83\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u52a0\u8f7d\u4e0d\u540cResource\u7684\u8bfb\u53d6\u5668\u5b9e\u73b0\uff0c\u4f8b\u5982ClassPathXmlApplicationContext\u3001FileSystemXmlApplicationContext\u4ee5\u53caXmlWebApplicationContext\u7b49\u7b49\uff0c\u7b80\u5355\u7684\u4ece\u8fd9\u4e9b\u7c7b\u7684\u540d\u5b57\u4e0a\u5206\u6790\uff0c\u53ef\u4ee5\u6e05\u695a\u7684\u770b\u5230\u4ed6\u4eec\u53ef\u4ee5\u63d0\u4f9b\u54ea\u4e9b\u4e0d\u540c\u7684Resource\u8bfb\u5165\u529f\u80fd\uff0c\u6bd4\u5982\uff1aClassPathXmlApplicationContext\u53ef\u4ee5\u4ece classpath\u8f7d\u5165Resource\uff0cFileSystemXmlApplicationContext\u53ef\u4ee5\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8f7d\u5165Resource\uff0cXmlWebApplicationContext\u53ef\u4ee5\u5728Web\u5bb9\u5668\u4e2d\u8f7d\u5165Resource\u7b49\u3002"),(0,i.kt)("p",null,"\u62ffClassPathXmlApplicationContext\u6765\u4e3e\u4f8b\uff0c\u6240\u4ee5\u8fd9\u91cc\u7528\u5b83\u6765\u5206\u6790ApplicationContext\u662f\u5982\u4f55\u6765\u5b8c\u6210BeanDefinition\u7684Resource\u5b9a\u4f4d\uff0c\u9996\u5148\u6765\u770b\u4e00\u4e0bClassPathXmlApplicationContext\u7684\u6574\u7ee7\u627f\u4f53\u7cfb\uff1a"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220324202208994.png?raw=true",alt:"image-20220324202208994"})),(0,i.kt)("p",null,"\u901a\u8fc7\u4e0a\u9762\u7684\u56fe\u7247\u5e76\u4e14\u67e5\u770b\u7ee7\u627f\u5173\u7cfb\u53ef\u77e5\uff0cClassPathXmlApplicationContext\u7ee7\u627f\u4e86AbstractApplicationContext\uff0c\u6240\u4ee5\u8be5\u5b9e\u73b0\u7c7b\u5177\u5907\u4e86\u8bfb\u53d6Resource\u5b9a\u4e49\u7684BeanDefinition\u7684\u80fd\u529b\u3002\u56e0\u4e3aAbstractApplicationContext\u7684\u57fa\u7c7b\u662fDefaultResourceLoader\u3002\u800c\u4e14\u5176\u5b83\u7684\u7c7b\u5982FileSystemXmlApplicationContext\u3001XmlWebApplicationContext\u7b49\u7b49\u90fd\u5982\u51fa\u4e00\u8f99\u3002\u4e5f\u662f\u901a\u8fc7DefaultResourceLoader\u8bfb\u53d6Resource\u3002"),(0,i.kt)("p",null,"\u2460\u3001\u6211\u4eec\u77e5\u9053IOC\u5bb9\u5668\u7684\u542f\u52a8\u662f\u4ecerefresh()\u65b9\u6cd5\u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u4ecerefresh()\u65b9\u6cd5\u5f00\u59cb\uff1aClassPathXmlApplicationContext\u7c7b\u4e2d\u8c03\u7528\u7684refresh()\u65b9\u6cd5\u662f\u5176\u7ee7\u627f\u7684\u57fa\u7c7b AbstractApplicationContext\u4e2d\u7684\u5b9e\u73b0\uff0c\u6240\u4ee5\u5148\u8ddf\u8e2aAbStractApplicationContext\u4e2d\u7684refresh()\u65b9\u6cd5\uff1a"),(0,i.kt)("p",null,"\u6ce8\u610f\uff1a\u5728refresh()\u4e2d\u6211\u4eec\u5148\u91cd\u70b9\u770bobtainFreshBeanFactory()\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u8fd9\u662fIoC\u5bb9\u5668\u521d\u59cb\u5316\u7684\u5165\u53e3\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public void refresh() throws BeansException, IllegalStateException {\n    synchronized (this.startupShutdownMonitor) {\n     \n        //\u5237\u65b0\u4e0a\u4e0b\u6587\u73af\u5883\n        prepareRefresh();\n         \n        //\u6211\u4eec\u5148\u7740\u91cd\u770b\u8fd9\u4e2a\u65b9\u6cd5 \u8fd9\u662f\u521d\u59cb\u5316\u5bb9\u5668\u7684\u5730\u65b9\uff0c\u662f\u5728\u5b50\u7c7b\u4e2d\u542f\u52a8refreshBeanFactory()\n        //\u5e76\u4e14\u5728\u8fd9\u91cc\u83b7\u5f97\u65b0\u7684BeanFactory\uff0c\u89e3\u6790XML\u3001Java\u7c7b\uff0c\u5e76\u52a0\u8f7dBeanDefinition\n        ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n \n        //\u51c6\u5907bean\u5de5\u5382\uff0c\u4ee5\u4fbf\u5728\u6b64\u4e0a\u4e0b\u6587\u4e2d\u4f7f\u7528\n        prepareBeanFactory(beanFactory);\n \n        try {\n            //\u8bbe\u7f6e beanFactory \u7684\u540e\u7f6e\u5904\u7406\n            postProcessBeanFactory(beanFactory);\n            //\u8c03\u7528 BeanFactory \u7684\u540e\u5904\u7406\u5668\uff0c\u8fd9\u4e9b\u5904\u7406\u5668\u662f\u5728Bean \u5b9a\u4e49\u4e2d\u5411\u5bb9\u5668\u6ce8\u518c\u7684\n            invokeBeanFactoryPostProcessors(beanFactory);\n            //\u6ce8\u518cBean\u7684\u540e\u5904\u7406\u5668\uff0c\u5728Bean\u521b\u5efa\u8fc7\u7a0b\u4e2d\u8c03\u7528\n            registerBeanPostProcessors(beanFactory);\n            //\u5bf9\u4e0a\u4e0b\u6587\u4e2d\u7684\u6d88\u606f\u6e90\u8fdb\u884c\u521d\u59cb\u5316\n            initMessageSource();\n            //\u521d\u59cb\u5316\u4e0a\u4e0b\u6587\u4e2d\u7684\u4e8b\u4ef6\u673a\u5236\n            initApplicationEventMulticaster();\n            //\u521d\u59cb\u5316\u5176\u4ed6\u7279\u6b8a\u7684Bean\n            onRefresh();\n            //\u68c0\u67e5\u76d1\u542cBean\u5e76\u4e14\u5c06\u8fd9\u4e9b\u76d1\u542cBean\u5411\u5bb9\u5668\u6ce8\u518c\n            registerListeners();\n            //\u5b9e\u4f8b\u5316\u6240\u6709\u7684\uff08non-lazy-init\uff09\u5355\u4ef6\n            finishBeanFactoryInitialization(beanFactory);\n            //\u53d1\u5e03\u5bb9\u5668\u4e8b\u4ef6\uff0c\u7ed3\u675fRefresh\u8fc7\u7a0b\n            finishRefresh();\n        }\n \n        catch (BeansException ex) {\n            if (logger.isWarnEnabled()) {\n                logger.warn("Exception encountered during context initialization - " +\n                        "cancelling refresh attempt: " + ex);\n            }\n            destroyBeans();\n            cancelRefresh(ex);\n            throw ex;\n        }\n        finally {\n            //\u91cd\u7f6eSpring\u516c\u5171\u7684\u7f13\u5b58\n            resetCommonCaches();\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u2461\u3001\u7136\u540e\u70b9\u51fbobtainFreshBeanFactory()\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5b83\u8fd8\u5728AbstractApplicationContext\u4e2d\u5b9e\u73b0\uff0c\u8fd9\u4e2aobtainFreshBeanFactory()\u5f88\u5173\u952e\uff0c\u8fd9\u91cc\u9762\u6709 IoC\u7684Resource\u5b9a\u4f4d\u548c\u8f7d\u5165\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected ConfigurableListableBeanFactory obtainFreshBeanFactory() {\n    refreshBeanFactory();\n    return getBeanFactory();\n}\n")),(0,i.kt)("p",null,"\u8fdb\u6765\u540e\u53d1\u73b0\u5176\u8c03\u7528refreshBeanFactory\u548cgetBeanFactory\u65b9\u6cd5\uff0c\u8868\u793a\u91cd\u65b0\u83b7\u53d6\u4e00\u4e2a\u65b0\u7684BeanFactory\u5b9e\u4f8b\u3002"),(0,i.kt)("p",null," \u2462\u3001\u7ee7\u7eed\u8ddf\u8e2arefreshBeanFactory()\u65b9\u6cd5\uff0c\u70b9\u51fb\u8fdb\u5165\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected abstract void refreshBeanFactory() throws BeansException, IllegalStateException;\n")),(0,i.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u53ea\u662f\u5b9a\u4e49\u4e86\u62bd\u8c61\u65b9\u6cd5\uff0c\u65e2\u7136\u662f\u62bd\u8c61\u7684\u65b9\u6cd5\uff0c\u90a3\u4e48\u80af\u5b9a\u6709\u5177\u4f53\u7684\u5b9e\u73b0\uff0c\u90a3\u8fd9\u4e2a\u5177\u4f53\u521d\u59cb\u5316IOC\u5bb9\u5668\u7684\u5b9e\u73b0\u5728\u54ea\u5462\uff1f\u5728AbstractApplicationContext\u4e2d\u6ca1\u6709\u505a\u5177\u4f53\u5b9e\u73b0\u3002\u6211\u4eec\u4ece\u524d\u9762\u7684\u7ee7\u627f\u56fe\u53ef\u77e5\uff0cAbstractApplicationContext\u8fd8\u6709\u5f88\u591a\u5b50\u7c7b\uff0c\u6240\u4ee5\u80af\u5b9a\u662f\u4ea4\u7ed9\u5176\u5b50\u7c7b\u5b8c\u6210\uff0c\u5b9e\u73b0\u89e3\u8026\uff0c\u8ba9\u521d\u59cb\u5316IOC\u5bb9\u5668\u53d8\u5f97\u66f4\u52a0\u7075\u6d3b\u3002"),(0,i.kt)("p",null,"\u6240\u4ee5\u6211\u4eec\u4ece\u5176\u5b50\u7c7bAbstractRefreshableApplicationContext\u4e2d\u627e\u5230\u5b9e\u73b0\u7684refreshBeanFactory()\u65b9\u6cd5\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'protected final void refreshBeanFactory() throws BeansException {\n    //\u8fd9\u91cc\u5224\u65ad\uff0c\u5982\u679c\u5b58\u5728\u4e86BeanFactory,\u5219\u9500\u6bc1\u5e76\u5173\u95ed\u8be5BeanFactory\n    if (hasBeanFactory()) {\n        destroyBeans();\n        closeBeanFactory();\n    }\n    try {\n        //\u8fd9\u91cc\u7684\u521b\u5efa\u65b0\u7684BeanFactory\n        DefaultListableBeanFactory beanFactory = createBeanFactory();\n        beanFactory.setSerializationId(getId());\n        customizeBeanFactory(beanFactory);\n        //\u8f7d\u5165Bean ,\u62bd\u8c61\u65b9\u6cd5\uff0c\u59d4\u6258\u5b50\u7c7bAbstractXmlApplicationContext\u5b9e\u73b0\n        //\u540e\u9762\u4f1a\u770b\u5230\u4e00\u7cfb\u5217\u91cd\u8f7d\u7684loadBeanDefinitions\u65b9\u6cd5\n        loadBeanDefinitions(beanFactory);\n        synchronized (this.beanFactoryMonitor) {\n            this.beanFactory = beanFactory;\n        }\n    }\n    catch (IOException ex) {\n        throw new ApplicationContextException("I/O error parsing bean definition source for " + getDisplayName(), ex);\n    }\n}\n')),(0,i.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u4e3b\u8981\u5206\u4e3a\u8fd9\u4e48\u51e0\u4e2a\u6b65\u9aa4\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("ol",{parentName:"li"},(0,i.kt)("li",{parentName:"ol"},"\u9996\u5148\u5224\u65adBeanFactory\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728(\u4e0d\u4e3aNULL)\uff0c\u5219\u9500\u6bc1\u5173\u95ed\u8be5BeanFactory\u3002\u4e5f\u5c31\u662f\u6e05\u9664\u8ddfBean\u6709\u5173\u7684Map\u6216\u8005List\u7b49\u5c5e\u6027\u96c6\u5408\uff0c\u5e76\u4e14\u5c06BeanFactory\u8bbe\u7f6e\u4e3anull\uff0c\u5e8f\u5217\u5316Id\u8bbe\u7f6e\u4e3anull\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u7136\u540e\u521b\u5efa\u4e00\u4e2a\u65b0\u7684DefaultListableBeanFactory\uff08\u8fd9\u4e2a\u7c7b\u662fSpring Bean\u521d\u59cb\u5316\u7684\u6838\u5fc3\u7c7b\uff09,\u6240\u4ee5\u6211\u4eec\u770b\u4e0b\u521b\u5efaDefaultListableBeanFactory\u7684\u5730\u65b9\uff1acreateBeanFactory()\uff0c\u8fd9\u4e2a\u65b9\u6cd5 \u662f\u5728AbstractRefreshableApplicationContext\u4e2d\u5b9e\u73b0\uff0c\u6240\u4ee5AbstractApplicationContext \u8ba9\u6211\u4eec\u53ef\u4ee5\u5145\u5206\u81ea\u7531\u7684\u5b9e\u4f8b\u5316\u81ea\u5df1\u60f3\u521d\u59cb\u5316\u7684\u539f\u59cbIOC\u5bb9\u5668\u3002")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected DefaultListableBeanFactory createBeanFactory() {\n        //getInternalParentBeanFactory \u83b7\u53d6\u5f53\u524d\u5bb9\u5668\u5df2\u6709\u7684\u7236\u4eb2\u5bb9\u5668\uff0c\u6765\u4f5c\u4e3a\u65b0\u5bb9\u5668\u7684\u7236\u5bb9\u5668\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5728AbstractApplicationContext\u4e2d\u5b9e\u73b0\u7684\u3002\n        return new DefaultListableBeanFactory(getInternalParentBeanFactory());\n    }\n")),(0,i.kt)("p",null,"\u6700\u540e\u5bf9\u65b0\u5efa\u7684BeanFactory\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5305\u62ecbean\u5e8f\u5217\u5316Id\u7684\u8bbe\u7f6e\u3001bean\u7684\u7279\u6b8a\u8bbe\u7f6e\uff0cbean\u8f7d\u5165\u64cd\u4f5c\u3002\u7136\u540e\u5c06beanFactory\u8d4b\u503c\u7ed9\u672c\u7c7b\u7684beanFactory\u5c5e\u6027\u3002\u6ce8\u610f\uff1acustomizeBeanFactory(beanFactory)\u91cc\u9762\u53ea\u505a\u4e86\u4e24\u4ef6\u4e8b\uff1a\u4e00\u4e2a\u662f\u8bbe\u7f6ebean\u662f\u5426\u5141\u8bb8\u8986\u76d6\uff0c\u53e6\u4e00\u4e2a\u662f\u8bbe\u7f6ebean\u662f\u5426\u5141\u8bb8\u5faa\u574f\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u2463\u3001\u8ddf\u8e2aloadBeanDefinitions(beanFactory)\u65b9\u6cd5\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected abstract void loadBeanDefinitions(DefaultListableBeanFactory beanFactory)\n        throws BeansException, IOException;\n")),(0,i.kt)("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5177\u4f53\u5b9e\u73b0\u662f\u7531\u5b50\u7c7bAbstractXmlApplicationContext\u5177\u4f53\u5b9e\u73b0\u7684\u3002\u6240\u4ee5\u6211\u4eec\u77e5\u9053\u4e86\u8be5\u600e\u4e48\u53bb\u627e\u8fd9\u4e2aloadBeanDefinitions\u7684\u5177\u4f53\u5b9e\u73b0\u4e86\u5427\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected void loadBeanDefinitions(DefaultListableBeanFactory beanFactory) throws BeansException, IOException {\n    //\u521b\u5efa\u4e00\u4e2axml\u914d\u7f6e\u8bfb\u5199\u5668\u7528\u4e8e\u89e3\u6790xml\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684bean\n    XmlBeanDefinitionReader beanDefinitionReader = new XmlBeanDefinitionReader(beanFactory);\n \n    //\u8bbe\u7f6eBeanDefinitionReader \u7684\u76f8\u5173\u5c5e\u6027\n    //1.\u8bbe\u7f6e Environment\uff0c\u5373\u73af\u5883\uff0c\u4e0e\u5bb9\u5668\u7684\u73af\u5883\u4e00\u81f4\n    beanDefinitionReader.setEnvironment(this.getEnvironment());\n    //2.\u8bbe\u7f6e ResourceLoader\uff0c\u5373\u8d44\u6e90\u52a0\u8f7d\u5668\uff0c\u5177\u4f53\u52a0\u8f7d\u8d44\u6e90\u7684\u529f\u80fd,\u8fd9\u4e2a\u52a0\u8f7d\u5668\u5f88\u91cd\u8981,\u540e\u9762\u4f1a\u7528\u5230\n    //  \u8fd9\u91cc\u4f20\u4e00\u4e2athis\u8fdb\u53bb\uff0c\u56e0\u4e3aApplicationContext\u662f\u5b9e\u73b0\u4e86ResourceLoader\u63a5\u53e3\n    beanDefinitionReader.setResourceLoader(this);\n    //3.\u8bbe\u7f6e EntityResolver\uff0c\u5373\u5b9e\u4f53\u89e3\u6790\u5668\uff0c\u8fd9\u91cc\u7528\u4e8e\u89e3\u6790\u8d44\u6e90\u52a0\u8f7d\u5668\u52a0\u8f7d\u7684\u8d44\u6e90\u5185\u5bb9\n    beanDefinitionReader.setEntityResolver(new ResourceEntityResolver(this));\n \n    //\u8fd9\u4e2a\u65b9\u6cd5\u9ed8\u8ba4\u5b9e\u73b0\u662f\u7a7a\u7684,\u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u5b9e\u73b0\u8bfb\u53d6\u5668\u7684\u5b9a\u5236\u5316,\u9700\u8981\u5b9e\u73b0\u63a5\u53e3,\u53ef\u4ee5\u8bbe\u7f6exml\u89e3\u6790\u5b8c\u6210\u6821\u9a8c,\u5b9a\u5236\u5316\u89e3\u6790\u5668\u7b49\n    initBeanDefinitionReader(beanDefinitionReader);\n    // \u8fd9\u91cc\u5f00\u59cb\u5c31\u662f \u52a0\u8f7d\u3001\u83b7\u53d6BeanDefinition\u8d44\u6e90\u5b9a\u4f4d\uff0c\u5e76\u4e14\u662f\u8f7d\u5165\u6a21\u5757\u7684\u5f00\u59cb\u4e86\n    loadBeanDefinitions(beanDefinitionReader);\n}\n")),(0,i.kt)("p",null,"\u2464\u3001\u7ee7\u7eed\u8ddf\u8e2aloadBeanDefinitions(beanDefinitionReader)\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5728AbstractXMLApplicationContext\u4e2d\u6709\u5b9e\u73b0\uff0c\u6211\u4eec\u770b\u4e0b\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected void loadBeanDefinitions(XmlBeanDefinitionReader reader) throws BeansException, IOException {\n    //\u4ee5Resource\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u5b9a\u4f4d\u5230\u7684resource\u8d44\u6e90\u4f4d\u7f6e\uff08\u7528\u6237\u5b9a\u4e49\uff09\n    //\u4f46\u662f\u73b0\u5728\u4e0d\u4f1a\u8d70\u8fd9\u6761\u8def\uff0c\u56e0\u4e3a\u914d\u7f6e\u6587\u4ef6\u8fd8\u6ca1\u6709\u5b9a\u4f4d\u5230\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u5c01\u88c5\u6210Resource\u5bf9\u8c61\u3002\n    Resource[] configResources = getConfigResources();\n    if (configResources != null) {\n        reader.loadBeanDefinitions(configResources);//\u8f7d\u5165resources\n    }\n    //\u4ee5String\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\uff08\u5bb9\u5668\u81ea\u8eab\uff09\n    String[] configLocations = getConfigLocations();\n    if (configLocations != null) {\n        reader.loadBeanDefinitions(configLocations);//\u8f7d\u5165resources\n    }\n}\n")),(0,i.kt)("p",null,"\u8fd9\u91cc\u4e3b\u8981\u662f\u83b7\u53d6\u5230\u7528\u6237\u5b9a\u4e49\u7684resource\u8d44\u6e90\u4f4d\u7f6e\u4ee5\u53ca\u83b7\u53d6\u6240\u4ee5\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002"),(0,i.kt)("p",null,"\u2465\u3001\u8fdb\u5165\u7b2c\u4e8c\u4e2areader.loadBeanDefinitions(configLocations)\u65b9\u6cd5\u3002\u4ece\u8fd9\u91cc\u5f00\u59cb\u5c31\u662fBeanDefinitionReader\u6a21\u5757\u7684\u5b9e\u73b0\u4e86\uff0c\u4e5f\u5c31\u662fApplicationContext\u4e0a\u4e0b\u6587\u5c06BeanDefinition\u7684\u5b9a\u4f4d\u52a0\u8f7d\u5de5\u4f5c\u4ea4\u4ed8\u5230\u4e86XmlBeanDefinitionReader\u3002\u8fd9\u4e2a\u65b9\u6cd5\u662f\u7531XmlBeanDefinitionReader\u7684\u57fa\u7c7bAbstractBeanDefinitionReader\u6765\u5b9e\u73b0\u7684\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public int loadBeanDefinitions(String... locations) throws BeanDefinitionStoreException {\n    Assert.notNull(locations, "Location array must not be null");\n    int count = 0;\n    //\u5faa\u574f\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n    for (String location : locations) {\n        count += loadBeanDefinitions(location);\n    }\n    return count;\n}\n')),(0,i.kt)("p",null,"\u8fd9\u91cc\u5c31\u662f\u5faa\u73af\u52a0\u8f7dxml\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u7136\u540e\u8fd4\u56de\u603b\u4e2a\u6570\u3002"),(0,i.kt)("p",null,"\u2466\u3001\u4e0b\u9762\u6211\u4eec\u7ee7\u7eed\u8ddf\u8e2aloadBeanDefinitions(loaction)\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5b83\u662f\u8fd8\u5728AbstractBeanDefinitionReader\u7684\u7c7b\u4e2d\u5b9e\u73b0\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public int loadBeanDefinitions(String location) throws BeanDefinitionStoreException {\n        return loadBeanDefinitions(location, null);\n    }\n")),(0,i.kt)("p",null,"\u2467\u3001\u7ee7\u7eed\u8ddf\u8e2a\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 loadBeanDefinitions(location, null)\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\u8fdb\u5165\u5230 loadBeanDefinitions(String location, Set<Resource> actualResources)\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u4f9d\u7136\u5728AbstractBeanDefinitionReader\u7c7b\u4e2d\u3002\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public int loadBeanDefinitions(String location, @Nullable Set<Resource> actualResources) throws BeanDefinitionStoreException {\n    //\u8fd9\u91cc\u53d6\u5230ResourceLoader\u5bf9\u8c61\uff08\u5176\u5b9eDefaultResourceLoader\u5bf9\u8c61\uff09\n    ResourceLoader resourceLoader = getResourceLoader();\n    if (resourceLoader == null) {\n        throw new BeanDefinitionStoreException(\n                "Cannot load bean definitions from location [" + location + "]: no ResourceLoader available");\n    }\n    //\u8fd9\u91cc\u5bf9Resource\u7684\u8def\u5f84\u6a21\u5f0f\u8fdb\u884c\u89e3\u6790\uff0c\u6bd4\u5982\u6211\u4eec\u8bbe\u5b9a\u7684\u5404\u79cdAnt\u683c\u5f0f\u7684\u8def\u5f84\u5b9a\u4e49\uff0c\u5f97\u5230\u9700\u8981\u7684Resource\u96c6\u5408\uff0c\n    //\u8fd9\u4e9bResource\u96c6\u5408\u6307\u5b9a\u6211\u4eec\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684BeanDefinition\u4fe1\u606f\uff0c\u53ef\u4ee5\u662f\u591a\u4e2a\u6587\u4ef6\u3002\n    if (resourceLoader instanceof ResourcePatternResolver) {\n        try {\n            //\u628a\u5b57\u7b26\u4e32\u7c7b\u578b\u7684xml\u6587\u4ef6\u8def\u5f84\uff0c\u5f62\u5982\uff1aclasspath*:user/**/*-context.xml,\u8f6c\u6362\u6210Resource\u5bf9\u8c61\u7c7b\u578b\uff0c\n            //\u5176\u5b9e\u5c31\u662f\u7528\u6d41\u7684\u65b9\u5f0f\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u5c01\u88c5\u6210Resource\u5bf9\u8c61\n            Resource[] resources = ((ResourcePatternResolver) resourceLoader).getResources(location);\n            //\u52a0\u8f7dResource\u8d44\u6e90\u4e2d\u7684Bean,\u7136\u540e\u8fd4\u56de\u52a0\u8f7d\u6570\u91cf\uff0c\u8fd9\u4e2aloadBeanDefinitions\u5c31\u662fBean\u7684\u8f7d\u5165\u4e86\n            int count = loadBeanDefinitions(resources);\n            if (actualResources != null) {\n                Collections.addAll(actualResources, resources);\n            }\n            if (logger.isTraceEnabled()) {\n                logger.trace("Loaded " + count + " bean definitions from location pattern [" + location + "]");\n            }\n            return count;\n        }\n        catch (IOException ex) {\n            throw new BeanDefinitionStoreException(\n                    "Could not resolve bean definition resource pattern [" + location + "]", ex);\n        }\n    }\n    else {\n        // Can only load single resources by absolute URL.\n        // \u8c03\u7528DefaultResourceLoader\u7684getResource(String)\u65b9\u6cd5\u6765\u83b7\u53d6\u8d44\u6e90\u5b9a\u4f4d\uff0c\u7136\u540e\u5c01\u88c5\u6210Resource\u5bf9\u8c61,\u8fd9\u91cc\u53ea\u80fd\u52a0\u8f7d\u4e00\u4e2a\u8d44\u6e90\n        Resource resource = resourceLoader.getResource(location);\n        //\u5faa\u73af\u52a0\u8f7d\u6240\u6709\u7684\u8d44\u6e90,\u8fd4\u56de\u603b\u6570\uff0c\u8fd9\u4e2aloadBeanDefinitions\u5c31\u662fBean\u7684\u8f7d\u5165\u4e86\n        int count = loadBeanDefinitions(resource);\n        if (actualResources != null) {\n            //\u5bf9\u4e8e\u6210\u529f\u627e\u5230\u7684Resource\u5b9a\u4f4d\uff0c\u90fd\u4f1a\u6dfb\u52a0\u5230\u8fd9\u4e2a\u4f20\u5165\u7684actualResources\u53c2\u6570\u4e2d\n            actualResources.add(resource);\n        }\n        if (logger.isTraceEnabled()) {\n            logger.trace("Loaded " + count + " bean definitions from location [" + location + "]");\n        }\n        return count;\n    }\n}\n')),(0,i.kt)("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u4e3b\u8981\u5c06xml\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u5e76\u5c01\u88c5\u6210\u4e3aResource\u5bf9\u8c61\u3002\u4f46\u662f\u5b83\u662f\u600e\u4e48\u64cd\u4f5c\u7684\u5462\uff1f\u5728\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0cloadBeanDefinitions()\u65b9\u6cd5\u4e2d\u53ef\u80fd\u8c03\u7528ResourcePatternResolver\u6216DefaultResourceLoader\u4e2d\u7684getResource()\u65b9\u6cd5\uff0c\u8fd9\u4e24\u4e2a\u7c7b\u4e00\u4e2a\u662f\u7ee7\u627f\u3001\u4e00\u4e2a\u662f\u5b9e\u73b0ResourceLoader\u3002\u5176\u4e2dResourcePatternResolver\u7528\u4e8e\u89e3\u6790\u8d44\u6e90\u6587\u4ef6\u7684\u7b56\u7565\u63a5\u53e3\uff0c\u5176\u7279\u6b8a\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u5b83\u5e94\u8be5\u63d0\u4f9b\u5e26\u6709*\u53f7\u8fd9\u79cd\u901a\u914d\u7b26\u7684\u8d44\u6e90\u8def\u5f84\u3002DefaultResourceLoader\u7528\u4e8e\u7528\u6765\u52a0\u8f7d\u8d44\u6e90\uff0c\u5e76\u4e14\u5177\u4f53\u5b9e\u73b0\u4e86ResourceLoader\u4e2d\u7684\u65b9\u6cd5\u3002\u800c\u5728\u7b2c\u2463\u6b65\u7684\u65f6\u5019\uff0c\u5728\u5b9e\u4f8b\u5316XmlBeanDefinitionReader\u7684\u65f6\u5019\u5df2\u7ecf\u8bbe\u7f6eResourceLoader\uff0c\u5e76\u4e14ResourceLoad\u4e3aApplicationContext\uff0c\u7136\u540e\u4e5f\u8bbe\u7f6e\u4e86ResourcePatternResolver\u3002\u6240\u4ee5XmlBeanDefinitionReader\u6709\u4e86\u52a0\u8f7d\u8d44\u6e90\u548c\u89e3\u6790\u8d44\u6e90\u7684\u529f\u80fd\u3002"),(0,i.kt)("p",null,"\u2468\u3001\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u6765\u770bgetResource()\u65b9\u6cd5\uff0cDefaultResourceLoader\u4e2d\u7684 getResource(String)\u5b9e\u73b0\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public Resource getResource(String location) {\n    Assert.notNull(location, "Location must not be null");\n    //\u770b\u6709\u6ca1\u6709\u81ea\u5b9a\u4e49\u7684ProtocolResolver\uff0c\u5982\u679c\u6709\u5219\u5148\u6839\u636e\u81ea\u5b9a\u4e49\u7684ProtocolResolver\u89e3\u6790location\u5f97\u5230Resource\n    for (ProtocolResolver protocolResolver : getProtocolResolvers()) {\n        Resource resource = protocolResolver.resolve(location, this);\n        if (resource != null) {\n            return resource;\n        }\n    }\n    //\u6839\u636e\u8def\u5f84\u662f\u5426\u5339\u914d"/"\u6216"classpath:"\u6765\u89e3\u6790\u5f97\u5230ClassPathResource\n    if (location.startsWith("/")) {\n        return getResourceByPath(location);\n    }\n    else if (location.startsWith(CLASSPATH_URL_PREFIX)) {\n        return new ClassPathResource(location.substring(CLASSPATH_URL_PREFIX.length()), getClassLoader());\n    }\n    else {\n        try {\n            //\u8fd9\u91cc\u5904\u7406\u5e26\u6709URL\u6807\u8bc6\u7684Resource\u5b9a\u4f4d\n            URL url = new URL(location);\n            return (ResourceUtils.isFileURL(url) ? new FileUrlResource(url) : new UrlResource(url));\n        }\n        catch (MalformedURLException ex) {\n            //\u5982\u679c\u65e2\u4e0d\u662fclassPath \u4e5f\u4e0d\u662fURL\u6807\u8bc6\u7684Resource\u5b9a\u4f4d\uff08\u90a3\u5176\u5b9e\u5c31\u662f\u81ea\u5df1\u5b9e\u73b0\u7684\u4e86\uff09.\u5219\u628agetResource\u7684\u91cd\u4efb\u4ea4\u7ed9getResourceByPath\u6765\u5b8c\u6210\uff0c\n            //\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u4e2aprotected\u65b9\u6cd5\uff0c\u9ed8\u8ba4\u7684\u5b9e\u73b0\u662f\u5f97\u5230\u4e00\u4e2aClassPathContextResource\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5e38\u5e38\u4f1a\u7528\u5b50\u7c7b\u6765\u5b9e\u73b0\u4e5f\u5c31\u662fFileSystemXMLApplicationContext\n            return getResourceByPath(location);\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u901a\u8fc7\u4e0a\u8ff0\u4ee3\u7801\u53ef\u4ee5\u770b\u5230\uff0cgetResource\u6700\u540e\u53c8\u8c03\u7528\u4e86\u5b50\u7c7b\u5b9e\u73b0\u7684getResourceByPath\u65b9\u6cd5\u6216\u662f\u5b50\u7c7b\u4f20\u9012\u8fc7\u6765\u7684\u5b57\u7b26\u4e32\uff0c\u4ece\u800c\u5b9e\u73b0Resource\u5b9a\u4f4d\u3002\u4f7f\u5f97\u6574\u4e2aResource\u5b9a\u4f4d\u8fc7\u7a0b\u5c31\u8bf4\u5f97\u901a\u4e86\u3002\u603b\u7ed3\u8d77\u6765\u5c31\u662f\uff0cResource\u8d44\u6e90\u901a\u8fc7\u6700\u5916\u5c42\u7684\u5b9e\u73b0\u7c7b\u4f20\u8fdb\u6765\u7684\u5b57\u7b26\u4e32\u6216\u8005\u76f4\u63a5\u8c03\u7528getResourceByPath\u65b9\u6cd5\uff0c\u6765\u83b7\u53d6bean\u8d44\u6e90\u8def\u5f84\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e0a\u9762\u7684\u4ee3\u7801\u8fdb\u884c\u56db\u6b65\u6765\u8fdb\u884c\u4ecb\u7ecd\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7b2c\u4e00\u6b65\uff1a\u9996\u5148\u770b\u6709\u6ca1\u6709\u81ea\u5b9a\u4e49\u7684ProtocolResolver\uff0c\u5982\u679c\u6709\u5219\u5148\u6839\u636e\u81ea\u5b9a\u4e49\u7684ProtocolResolver\u89e3\u6790location\u5f97\u5230Resource,\u8fd9\u91cc\u7684protocolResolvers\u662fDefaultResourceLoader\u7c7b\u4e2d\u7684\u6210\u5458\u53d8\u91cf\uff0c\u800c\u8fd9\u4e2a\u6210\u5458\u53d8\u91cf\u662fProtocolResolver\u7c7b\u578b\u7684Set\u96c6\u5408\u3002"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"for (ProtocolResolver protocolResolver : getProtocolResolvers()) {\n    Resource resource = protocolResolver.resolve(location, this);\n    if (resource != null) {\n        return resource;\n    }\n}\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'\u7b2c\u4e8c\u6b65\uff1a\u518d\u6839\u636e\u8def\u5f84\u662f\u5426\u5339\u914d"/"\u6216"classpath:"\u6765\u89e3\u6790\u5f97\u5230ClassPathResource\u3002'),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'if (location.startsWith("/")) {\n    return getResourceByPath(location);\n}\nelse if (location.startsWith(CLASSPATH_URL_PREFIX)) {\n    return new ClassPathResource(location.substring(CLASSPATH_URL_PREFIX.length()), getClassLoader());\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7b2c\u4e09\u6b65\uff1a\u6700\u540e\u5904\u7406\u5e26\u6709URL\u6807\u8bc6\u7684Resource\u5b9a\u4f4d\uff0c\u52a0\u8f7d\u5f97\u5230\u4e00\u4e2aUrlResource\uff0c\u5982\u679c\u90fd\u4e0d\u662f\u8fd9\u4e9b\u7c7b\u578b\uff0c\u5219\u4ea4\u7ed9getResourceByPath\u6765\u5b8c\u6210\n"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"    else {\n      try {\n          // Try to parse the location as a URL...\n          URL url = new URL(location);\n          return (ResourceUtils.isFileURL(url) ? new FileUrlResource(url) : new UrlResource(url));\n      }\n      catch (MalformedURLException ex) {\n          // No URL -> resolve as resource path.\n          return getResourceByPath(location);\n      }\n    }\n    ```\n  \n- \u7b2c\u56db\u6b65\uff1a\u4e0a\u9762\u7684getResourceByPath()\u65b9\u6cd5\u4f1a\u6839\u636e\u8def\u5f84\u52a0\u8f7dResource\u5bf9\u8c61\n\n  ```java\n  protected Resource getResourceByPath(String path) {\n      return new ClassPathContextResource(path, getClassLoader());\n  }\n")),(0,i.kt)("p",null,"\u4e0a\u9762\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u4e00\u4e2aClassPathContextResource\u5bf9\u8c61\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61Spring\u5c31\u53ef\u4ee5\u8fdb\u884c\u76f8\u5173\u7684I/O\u64cd\u4f5c\u4e86\u3002"),(0,i.kt)("p",null,'\u56e0\u4e3a\u5bf9ProtocolResolver\u8fd9\u4e2a\u7c7b\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u6240\u4ee5\u6211\u53bb\u4e86\u89e3\u4e86\u4e00\u4e0b\uff0cProtocolResolver\u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f"\u534f\u8bae\u89e3\u6790\u5668"\uff0c\u8fd9\u4e2a\u63a5\u53e3\u7c7b\u91cc\u5c31\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"Resource resolve(String location, ResourceLoader resourceLoader);\n")),(0,i.kt)("p",null,"\u6211\u4eec\u5728\u7b2c\u4e00\u6b65\u7684\u65f6\u5019\u8c03\u7528\u4e86ProtocolResolver\u7684resolve\u65b9\u6cd5\uff0c\u5982\u679c\u4f60\u8981\u4f7f\u7528ProtocolResolver\u3002\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u5b9e\u73b0ProtocolResolver\u63a5\u53e3\uff0c\u7136\u540e\u5b9e\u73b0\u8be5resolve\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u89e3\u6790\u7279\u5b9a\u7684location\u5f97\u5230Resoure\u3002\u662f\u7684\uff0cProtocolResolver\u662f\u89e3\u6790location\u7684\u81ea\u5b9a\u4e49\u62d3\u5c55\u7c7b\uff0c\u6709\u4e86\u5b83\u6211\u4eec\u624d\u80fd\u968f\u610f\u4f20\u5165\u4e0d\u540c\u683c\u5f0f\u7684location\uff0c\u7136\u540e\u6839\u636e\u5bf9\u5e94\u7684\u683c\u5f0f\u53bb\u89e3\u6790\u5e76\u83b7\u5f97\u6211\u4eec\u7684Resource\u5373\u53ef\u3002"),(0,i.kt)("p",null,"\u5173\u4e8eDefaultResourceLoader\u548cProtocolResolver\u7684\u533a\u522b\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"DefaultResourceLoader\u7c7b\u7684\u4f5c\u7528\u662f\u52a0\u8f7dResource"),(0,i.kt)("li",{parentName:"ol"},"ProtocolResolver\u662f\u89e3\u6790location\u83b7\u53d6Resource\u7684\u62d3\u5c55")),(0,i.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDefaultResourceLoader\u7c7b\u4e2d\u7684protocolResolvers\u6210\u5458\u53d8\u91cf\u662f\u4e00\u4e2a\u7a7a\u7684Set\uff0c\u5373\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u6ca1\u6709ProtocolResolver\u53ef\u4ee5\u53bb\u89e3\u6790\u7684\uff0c\u53ea\u80fd\u8d70ClassPath\u548cURL\u4e24\u79cd\u65b9\u5f0f\u83b7\u5f97Resource\u3002"),(0,i.kt)("p",null,"\u81f3\u6b64\u6211\u4eec\u7684Resource\u5b9a\u4f4d\u5df2\u7ecf\u5168\u90e8\u5b8c\u6210\u4e86\u3002\u9976\u4e86\u8fd9\u4e48\u8fdc\u5c31\u662f\u4e3a\u4e86\u62ff\u5230\u8fd9\u4e2aResource\u5bf9\u8c61\uff0c\u62ff\u5230\u8fd9\u4e2a\u5bf9\u8c61\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7AbstractBeanDefinitionReader\u6d41\u64cd\u4f5c\u6765\u5b9e\u73b0Resource\u7684\u8f7d\u5165\uff0c\u6700\u540e\u901a\u8fc7AbstractApplicationContext\u7684registerListeners\u6765\u8fdb\u884c\u6ce8\u518c\u3002\u8fd9\u5c31\u662fIoC\u5bb9\u5668\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u3002\u6240\u4ee5\u4e0b\u9762\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0bResource\u7684\u8f7d\u5165\u5de5\u7a0b\u3002"),(0,i.kt)("h2",{id:"42beandefinition\u7684\u8f7d\u5165"},"4.2BeanDefinition\u7684\u8f7d\u5165"),(0,i.kt)("p",null,"\u5728\u5b8c\u6210\u5bf9Resource\u5b9a\u4f4d\u5206\u6790\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u83b7\u53d6\u7684Resource\u5bf9\u8c61\u8fdb\u884cBeanDefinition\u7684\u8f7d\u5165\u4e86\u3002\u5bf9IOC\u5bb9\u5668\u6765\u8bf4\uff0c\u8fd9\u4e2a\u8f7d\u5165\u8fc7\u7a0b\uff0c\u76f8\u5f53\u4e8e\u628a\u5b9a\u4e49\u7684bean\u5728IOC\u5bb9\u5668\u4e2d\u8f6c\u5316\u6210\u4e00\u4e2aSpring\u5185\u90e8\u8868\u793a\u7684\u6570\u636e\u7ed3\u6784\u7684\u8fc7\u7a0b\uff0c\u4e5f\u5c31\u662f\u5c06\u5176\u8f6c\u5316\u4e3aBeanDefinition\uff0cIOC\u5bb9\u5668\u5bf9Bean\u7684\u7ba1\u7406\u548c\u4f9d\u8d56\u6ce8\u5165\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u662f\u901a\u8fc7\u5bf9\u5176\u6301\u6709\u7684BeanDefinition\u8fdb\u884c\u5404\u79cd\u76f8\u5173\u64cd\u4f5c\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e9bBeanDefinition\u5728IOC\u5bb9\u5668\u4e2d\u901a\u8fc7\u4e00\u4e2aHashMap\u6765\u4fdd\u6301\u548c\u7ef4\u62a4\u3002"),(0,i.kt)("p",null,"\u6211\u4eec\u7ee7\u7eed\u8ddf\u8e2aAbstractBeanDefinitionReader\u4e2d\u7684loadBeanDefinitions\u65b9\u6cd5\uff0c\u4e4b\u524d\u8ddf\u8e2a\u5230\u7684\u662f\u5982\u4e0b\u56fe\u7684loadBeanDefinitions\u65b9\u6cd5\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220325132954351.png?raw=true",alt:"image-20220325132954351"})),(0,i.kt)("p",null,"\u2460\u3001\u7ee7\u7eed\u8ddf\u5230loadBeanDefinitions(resource)\u65b9\u6cd5\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public int loadBeanDefinitions(Resource... resources) throws BeanDefinitionStoreException {\n     Assert.notNull(resources, "Resource array must not be null");\n     int count = 0;\n     // \u5c06\u6240\u6709\u5b9a\u4f4d\u5230\u7684Resource\u8d44\u6e90\u5168\u90e8\u52a0\u8f7d\uff0c\u4ea4\u7ed9XmlBeanDefinitionReader\u5b9e\u73b0\u7684\u65b9\u6cd5\u6765\u5904\u7406\u8fd9\u4e9bresource\n     for (Resource resource : resources) {\n         count += loadBeanDefinitions(resource);\n     }\n     return count;\n }\n')),(0,i.kt)("p",null,"\u8fd9\u91cc\u5faa\u73af\u52a0\u8f7d\u5b9a\u4f4d\u5230Resource\u8d44\u6e90\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u8ddf\u524d\u9762\u5faa\u73af\u52a0\u8f7d\u8d44\u6e90\u8def\u5f84\u7c7b\u4f3c\uff0c\u4f46\u52a0\u8f7d\u7684\u5185\u5bb9\u4e0d\u4e00\u6837\u3002"),(0,i.kt)("p",null,"\u2461\u3001\u7136\u540e\u70b9\u51fb\u8fdb\u5165loadBeanDefinitions(resource)\uff0c\u8fdb\u5165\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728BeanDefinitionReader\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e24\u4e2a\u52a0\u8f7dResource\u8d44\u6e90\u7684\u65b9\u6cd5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"int loadBeanDefinitions(Resource resource) throws BeanDefinitionStoreException;\n \nint loadBeanDefinitions(Resource... resources) throws BeanDefinitionStoreException;\n")),(0,i.kt)("p",null,"\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5177\u4f53\u7531BeanDefinitionReader\u63a5\u53e3\u7684\u5b50\u7c7bXmlBeanDefinitionReader \u5b9e\u73b0\uff0c\u5176\u7ee7\u627f\u5173\u7cfb\u5982\u4e0b\u56fe\u6240\u793a\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/BlackMe2327/cloudimages27/blob/main/img/image-20220325133042158.png?raw=true",alt:"image-20220325133042158"})),(0,i.kt)("p",null,"XmlBeanDefinitionReader\u4e3b\u8981\u7528\u6765\u5c06Bean\u7684XML\u914d\u7f6e\u6587\u4ef6\u8f6c\u6362\u4e3a\u591a\u4e2aBeanDefinition\u5bf9\u8c61\u7684\u5de5\u5177\u7c7b\uff0c\u6240\u4ee5\u5b83\u4f1a\u5c06\u5b9a\u4f4d\u5230\u7684Resource\u8d44\u6e90\u8fdb\u884c\u5904\u7406\u3002\u6211\u4eec\u5148\u6765\u770b\u4e0a\u9762\u4e24\u4e2a\u5b9e\u73b0\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u8fc7\u7a0b\u662f\uff0c\u5148\u5c06resource\u5305\u88c5\u4e3aEncodeResource\u7c7b\u578b\uff0c\u7136\u540e\u7ee7\u7eed\u8fdb\u884c\u5904\u7406\uff0c\u4e3a\u751f\u6210BeanDefinition\u5bf9\u8c61\u4e3a\u540e\u9762\u505a\u51c6\u5907\uff0c\u6211\u4eec\u5728XmlBeanDefinitionReader\u7c7b\u4e2d\u627e\u5230\u5b9e\u73b0\u7684\u65b9\u6cd5\uff0c\u5176\u4e3b\u8981\u7684\u4e24\u4e2a\u65b9\u6cd5\u7684\u6e90\u7801\u5982\u4e0b\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public int loadBeanDefinitions(Resource resource) throws BeanDefinitionStoreException {\n    //\u5305\u88c5resource\u4e3aEncodeResource\u7c7b\u578b\n    return loadBeanDefinitions(new EncodedResource(resource));\n}\n \npublic int loadBeanDefinitions(EncodedResource encodedResource) throws BeanDefinitionStoreException {\n    Assert.notNull(encodedResource, "EncodedResource must not be null");\n    if (logger.isTraceEnabled()) {\n        logger.trace("Loading XML bean definitions from " + encodedResource);\n    }\n    // \u8fd9\u91cc\u4f7f\u7528threadLocal\u6765\u4fdd\u8bc1\u5e76\u53d1\u7684\u540c\u6b65\n    Set<EncodedResource> currentResources = this.resourcesCurrentlyBeingLoaded.get();\n    //\u5148\u6dfb\u52a0threadLocal\uff0c\u52a0\u8f7d\u5b8c\u4e4b\u540efinally\u4e2d\u518d\u79fb\u9664threadLocal\n    if (!currentResources.add(encodedResource)) {\n        throw new BeanDefinitionStoreException(\n                "Detected cyclic loading of " + encodedResource + " - check your import definitions!");\n    }\n    // \u901a\u8fc7resource\u5bf9\u8c61\u5f97\u5230XML\u6587\u4ef6\u5185\u5bb9\u8f93\u5165\u6d41\uff0c\u5e76\u4e3aI/O\u7684InputSource\u505a\u51c6\u5907\n    try (InputStream inputStream = encodedResource.getResource().getInputStream()) {\n        InputSource inputSource = new InputSource(inputStream);\n        if (encodedResource.getEncoding() != null) {\n            inputSource.setEncoding(encodedResource.getEncoding());\n        }\n        //\u8fd9\u91cc\u5c31\u662f\u5177\u4f53\u8bfb\u53d6Xml\u6587\u4ef6\u7684\u65b9\u6cd5\n        return doLoadBeanDefinitions(inputSource, encodedResource.getResource());\n    }\n    catch (IOException ex) {\n        throw new BeanDefinitionStoreException(\n                "IOException parsing XML document from " + encodedResource.getResource(), ex);\n    }\n    finally {\n        currentResources.remove(encodedResource);\n        if (currentResources.isEmpty()) {\n            this.resourcesCurrentlyBeingLoaded.remove();\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u2462\u3001\u63a5\u7740\u8fdb\u5165doLoadBeanDefinitions\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u662f\u5177\u4f53\u8bfb\u53d6Xml\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u4e5f\u662f\u4ece\u6307\u5b9axml\u6587\u4ef6\u4e2d\u5b9e\u9645\u8f7d\u5165BeanDefinition\u7684\u5730\u65b9\u3002\u5f53\u7136\u4e86\u8fd9\u80af\u5b9a\u662f\u5728XmlBeanDefinitionReader\u4e2d\u7684\u65b9\u6cd5\u4e86\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'protected int doLoadBeanDefinitions(InputSource inputSource, Resource resource)\n        throws BeanDefinitionStoreException {\n \n    try {\n        //\u8fd9\u91cc\u53d6\u5f97\u7684\u662fXML\u6587\u4ef6\u7684Document\u5bf9\u8c61\uff0c\u5177\u4f53\u7684\u89e3\u6790\u8fc7\u7a0b\u662f\u7531DocumentLoader\u5b8c\u6210\u7684\uff0c\n        //\u8fd9\u91cc\u4f7f\u7528\u7684DocumentLoader\u662fDefaultDocumentLoader\uff0c\u5728\u5b9a\u4e49documentLoader\u5bf9\u8c61\u65f6\u5019\u521b\u5efa\u7684\n        Document doc = doLoadDocument(inputSource, resource);\n        //\u8fd9\u91cc\u542f\u52a8\u7684\u662f\u5bf9BeanDefinition\u89e3\u6790\u7684\u8be6\u7ec6\u8fc7\u7a0b\uff0c\u4e5f\u5c31\u662f\u5c06document\u6587\u4ef6\u7684bean\u5c01\u88c5\u6210BeanDefinition\uff0c\u5e76\u6ce8\u518c\u5230\u5bb9\u5668\n        //\u542f\u52a8\u5bf9BeanDefinition\u89e3\u6790\u7684\u8be6\u7ec6\u8fc7\u7a0b\uff0c\u8fd9\u4e2a\u89e3\u6790\u4f1a\u7528\u5230Spring\u7684Bean\u914d\u7f6e\u89c4\u5219\uff0c\u662f\u6211\u4eec\u4e0b\u9762\u8be6\u7ec6\u8bb2\u89e3\u7684\u5185\u5bb9\n        int count = registerBeanDefinitions(doc, resource);\n        if (logger.isDebugEnabled()) {\n            logger.debug("Loaded " + count + " bean definitions from " + resource);\n        }\n        return count;\n    }\n    catch () {\n        \u7701\u7565......\n    }\n}\n')),(0,i.kt)("p",null,"\u2463\u3001\u4e0b\u9762\u6211\u4eec\u4e3b\u8981\u5173\u5fc3\u7684\u662fSpring\u7684BeanDefinition\u662f\u600e\u4e48\u6837\u6309\u7167Spring\u7684Bean\u8bed\u4e49\u8981\u6c42\u8fdb\u884c\u89e3\u6790 \u5e76\u8f6c\u5316\u4e3a\u5bb9\u5668\u5185\u90e8\u6570\u636e\u7ed3\u6784\u7684\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u5728registerBeanDefinitions(doc, resource)\u4e2d\u5b8c\u6210\u7684\uff0c\u5177\u4f53\u7684\u8fc7\u7a0b\u662fBeanDefinitionDocumentReader\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e2aregisterBeanDefinitions\u8fd8\u5bf9\u8f7d\u5165\u7684Bean\u6570\u91cf\u8fdb\u884c\u4e86\u7edf\u8ba1\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e5f\u662f\u5728 XmlBeanDefinitionReader \u4e2d\u81ea\u5df1\u5b9e\u73b0\u7684\uff0c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public int registerBeanDefinitions(Document doc, Resource resource) throws BeanDefinitionStoreException {\n     //\u8fd9\u91cc\u5f97\u5230\u7684BeanDefinitionDocumentReader\u5bf9\u8c61\u6765\u5bf9XML\u7684BeanDefinition\u4fe1\u606f\u8fdb\u884c\u89e3\u6790\n     BeanDefinitionDocumentReader documentReader = createBeanDefinitionDocumentReader();\n     //\u83b7\u53d6\u5bb9\u5668\u4e2dbean\u7684\u6570\u91cf\n     int countBefore = getRegistry().getBeanDefinitionCount();\n     //\u5177\u4f53\u7684\u89e3\u6790\u8fc7\u7a0b\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5b9e\u73b0    \n     documentReader.registerBeanDefinitions(doc, createReaderContext(resource));\n     return getRegistry().getBeanDefinitionCount() - countBefore;\n }\n")),(0,i.kt)("p",null,"\u6ce8\u610f\uff1aBeanDefinition\u7684\u8f7d\u5165\u5206\u6210\u4e24\u90e8\u5206\uff0c\u9996\u5148\u901a\u8fc7\u8c03\u7528XML\u7684\u89e3\u6790\u5668\uff08XmlBeanDefinitionReader\uff09\u5f97\u5230document\u5bf9\u8c61\uff0c\u4f46\u8fd9\u4e9bdocument\u5bf9\u8c61\u5e76\u6ca1\u6709 \u6309\u7167Spring\u7684Bean\u89c4\u5219\u53bb\u8fdb\u884c\u89e3\u6790\uff0c\u5728\u5b8c\u6210\u901a\u7528XML\u89e3\u6790\u4e4b\u540e\u624d\u662f\u6309\u7167Spring\u5f97 Bean\u89c4\u5219\u8fdb\u884c\u89e3\u6790\u7684\u5730\u65b9\uff0c\u8fd9\u4e2a\u6309\u7167Spring\u7684Bean\u89c4\u5219\u8fdb\u884c\u89e3\u6790\u7684\u8fc7\u7a0b\u662f\u5728documentReade\u4e2d\u5b9e\u73b0\u7684\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684documentReader\u662f\u9ed8\u8ba4\u8bbe\u7f6e\u597d\u7684DefaultBeanDefinitionDocumentReader\uff0c\u521b\u5efa\u7684\u8fc7\u7a0b\u4e5f\u662f\u5728XmlBeanDefinitionReader \u4e2d\u5b8c\u6210\u7684\uff0c\u6839\u636e\u6307\u5b9a\u7684\u9ed8\u8ba4\u65b9\u5f0f\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"private Class<? extends BeanDefinitionDocumentReader> documentReaderClass =\n      DefaultBeanDefinitionDocumentReader.class;\nprotected BeanDefinitionDocumentReader createBeanDefinitionDocumentReader() {\n   return BeanUtils.instantiateClass(this.documentReaderClass);\n}\n")),(0,i.kt)("p",null,"\u4e0a\u9762\u901a\u8fc7\u901a\u8fc7 XmlBeanDefinitionReader \u7c7b\u4e2d\u7684\u79c1\u6709\u5c5e\u6027 documentReaderClass \u83b7\u5f97\u4e00\u4e2a DefaultBeanDefinitionDocumentReader \u5b9e\u4f8b\u5bf9\u8c61\uff0c\u5e76\u4e14\u5177\u4f53\u7684\u89e3\u6790\u8fc7\u7a0b\u5728DefaultBeanDefinitionDocumentReader\u6765\u5b9e\u73b0\uff0c\u6240\u4ee5\u4e0b\u9762\u6211\u4eec\u7ee7\u7eed\u8ddf\u8e2a\u3002"),(0,i.kt)("p",null,"\u2464\u3001DefaultBeanDefinitionDocumentReader\u5b9e\u73b0\u4e86BeanDefinitionDocumentReader\u63a5\u53e3\uff0c\u5b83\u7684registerBeanDefinitions\u65b9\u6cd5\u5b9a\u4e49\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public void registerBeanDefinitions(Document doc, XmlReaderContext readerContext) {\n   this.readerContext = readerContext;\n   doRegisterBeanDefinitions(doc.getDocumentElement());\n}\n")),(0,i.kt)("p",null,"\u8fd9\u91cc\u53ea\u662f\u5c06 XML\u4e2d\u7684\u5143\u7d20\u53d6\u4e86\u51fa\u6765\uff0c\u4f46\u662f\u5177\u4f53\u7684\u6d3b\u8fd8\u662f doRegisterBeanDefinitions(root)\u6765\u5b9e\u73b0\u7684\uff0cdo\u5f00\u5934\u7684\u65b9\u6cd5\u624d\u662f\u771f\u6b63\u5e72\u6d3b\u7684\u65b9\u6cd5\u3002"),(0,i.kt)("p",null,"\u2465\u3001\u6240\u4ee5\u7ee7\u7eed\u8ddf\u8e2adoRegisterBeanDefinitions(root)\u65b9\u6cd5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'protected void doRegisterBeanDefinitions(Element root) {\n     // \u521b\u5efa\u4e86BeanDefinitionParserDelegate\u5bf9\u8c61\n     BeanDefinitionParserDelegate parent = this.delegate;\n     this.delegate = createDelegate(getReaderContext(), root, parent);\n \n    // \u5982\u679c\u662fSpring\u539f\u751f\u547d\u540d\u7a7a\u95f4\uff0c\u9996\u5148\u89e3\u6790 profile\u6807\u7b7e\uff0c\u8fd9\u91cc\u4e0d\u91cd\u8981\n     if (this.delegate.isDefaultNamespace(root)) {\n         String profileSpec = root.getAttribute(PROFILE_ATTRIBUTE);\n         if (StringUtils.hasText(profileSpec)) {\n             String[] specifiedProfiles = StringUtils.tokenizeToStringArray(\n                     profileSpec, BeanDefinitionParserDelegate.MULTI_VALUE_ATTRIBUTE_DELIMITERS);\n             if (!getReaderContext().getEnvironment().acceptsProfiles(specifiedProfiles)) {\n                 if (logger.isDebugEnabled()) {\n                     logger.debug("Skipped XML bean definition file due to specified profiles [" + profileSpec +\n                             "] not matching: " + getReaderContext().getResource());\n                 }\n                 return;\n             }\n         }\n     }\n     //\u89e3\u6790BeanDefinition\u4e4b\u524d\u505a\u7684\u4e00\u4e9b\u4e8b\u60c5\u7684\u63a5\u53e3\u89e6\u53d1\n     preProcessXml(root);\n     //\u4e3b\u8981\u770b\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6807\u7b7e\u5177\u4f53\u89e3\u6790\u8fc7\u7a0b\n     parseBeanDefinitions(root, this.delegate);\n     // \u89e3\u6790BeanDefinition\u4e4b\u540e\u53ef\u4ee5\u505a\u7684\u4e00\u4e9b\u4e8b\u60c5\u7684\u89e6\u53d1\n     postProcessXml(root);\n \n    this.delegate = parent;\n }\n')),(0,i.kt)("p",null,"\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u91cd\u70b9\u770b\u201c\u4e00\u7c7b\u4e09\u6cd5\u201d\uff0c\u4e5f\u5c31\u662fBeanDefinitionParserDelegate\u7c7b\u548cpreProcessXml\u3001parseBeanDefinitions\u3001postProcessXml\u4e09\u4e2a\u65b9\u6cd5\u3002\u5176\u4e2dBeanDefinitionParserDelegate\u7c7b\u975e\u5e38\u975e\u5e38\u91cd\u8981\uff08\u9700\u8981\u4e86\u89e3\u4ee3\u7406\u6280\u672f\uff0c\u5982JDK\u52a8\u6001\u4ee3\u7406\u3001cglib\u52a8\u6001\u4ee3\u7406\u7b49\uff09\u3002Spirng BeanDefinition\u7684\u89e3\u6790\u5c31\u662f\u5728\u8fd9\u4e2a\u4ee3\u7406\u7c7b\u4e0b\u5b8c\u6210\u7684\uff0c\u6b64\u7c7b\u5305\u542b\u4e86\u5404\u79cd\u5bf9\u7b26\u5408Spring Bean\u8bed\u4e49\u89c4\u5219\u7684\u5904\u7406\uff0c\u6bd4\u5982",(0,i.kt)("inlineCode",{parentName:"p"},"<bean></bean>\u3001<import></import>\u3001<alias><alias/>"),"\u7b49\u7684\u68c0\u6d4b\u3002\u5bf9\u4e8epreProcessXml\u3001parseBeanDefinitions\u3001postProcessXml\u8fd9\u4e09\u4e2a\u65b9\u6cd5\uff0c\u5176\u4e2dpreProcessXml\u548cpostProcessXml\u90fd\u662f\u7a7a\u65b9\u6cd5\uff0c\u610f\u601d\u662f\u5728\u89e3\u6790\u6807\u7b7e\u524d\u540e\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u6269\u5c55\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u4e5f\u662f\u4e00\u4e2a\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f\uff0c\u4f53\u73b0\u4e86Spring\u7684\u9ad8\u6269\u5c55\u6027\u3002parseBeanDefinitions\u65b9\u6cd5\u624d\u662f\u6807\u7b7e\u7684\u5177\u4f53\u89e3\u6790\u8fc7\u7a0b\u3002\u6240\u4ee5\u4e0b\u9762\u8fdb\u5165parseBeanDefinitions\u65b9\u6cd5\u770b\u5177\u4f53\u662f\u600e\u4e48\u89e3\u6790\u6807\u7b7e\u7684\u3002"),(0,i.kt)("p",null,"\u2466\u3001\u524d\u9762\u63d0\u5230Document\u5bf9\u8c61\u4e0d\u80fd\u901a\u8fc7XmlBeanDefinitionReader\uff0c\u771f\u6b63\u53bb\u89e3\u6790Document\u6587\u6863\u6811\u7684\u662f BeanDefinitionParserDelegate\u5b8c\u6210\u7684\uff0c\u8fd9\u4e2a\u89e3\u6790\u8fc7\u7a0b\u662f\u4e0eSpring\u5bf9BeanDefinition\u7684\u914d\u7f6e\u89c4\u5219\u7d27\u5bc6\u76f8\u5173\u7684\uff0cparseBeanDefinitions(root, delegate)\u65b9\u6cd5\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"protected void parseBeanDefinitions(Element root, BeanDefinitionParserDelegate delegate) {\n    if (delegate.isDefaultNamespace(root)) {\n        NodeList nl = root.getChildNodes();\n        // \u904d\u5386\u6240\u6709\u8282\u70b9\uff0c\u505a\u5bf9\u5e94\u89e3\u6790\u5de5\u4f5c\n        // \u5982\u904d\u5386\u5230<import>\u6807\u7b7e\u8282\u70b9\u5c31\u8c03\u7528importBeanDefinitionResource(ele)\u65b9\u6cd5\u5bf9\u5e94\u5904\u7406\n        // \u904d\u5386\u5230bean\u6807\u7b7e\u5c31\u8c03\u7528processBeanDefinition(ele,delegate)\u65b9\u6cd5\u5bf9\u5e94\u5904\u7406\n        for (int i = 0; i < nl.getLength(); i++) {\n            Node node = nl.item(i);\n            if (node instanceof Element) {\n                Element ele = (Element) node;\n                if (delegate.isDefaultNamespace(ele)) {\n                    //\u9ed8\u8ba4\u6807\u7b7e\u89e3\u6790\n                    parseDefaultElement(ele, delegate);\n                }\n                else {\n                    //\u81ea\u5b9a\u4e49\u6807\u7b7e\u89e3\u6790\n                    delegate.parseCustomElement(ele);\n                }\n            }\n        }\n    }\n    else {\n        delegate.parseCustomElement(root);\n    }\n}\n")),(0,i.kt)("p",null,"\u8fd9\u91cc\u6709\u4e24\u79cd\u6807\u7b7e\u7684\u89e3\u6790\uff1aSpring\u539f\u751f\u6807\u7b7e\u548c\u81ea\u5b9a\u4e49\u6807\u7b7e\uff0c\u90a3\u6765\u600e\u4e48\u533a\u5206\u8fd9\u4e24\u79cd\u6807\u7b7e\u5462\uff1f\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u6807\u7b7e\uff1a\\<bean:/",">"),(0,i.kt)("li",{parentName:"ul"},"\u81ea\u5b9a\u4e49\u6807\u7b7e\uff1a\\<context:component-scan/",">")),(0,i.kt)("p",null,"\u5982\u679c\u5e26\u6709bean\u7684\u5c31\u662fSpring\u9ed8\u8ba4\u6807\u7b7e\uff0c\u5426\u5219\u5c31\u662f\u81ea\u5b9a\u4e49\u6807\u7b7e\u3002\u4f46\u65e0\u8bba\u54ea\u79cd\u6807\u7b7e\u5728\u4f7f\u7528\u524d\u90fd\u9700\u8981\u5728Spring\u7684xml\u914d\u7f6e\u6587\u4ef6\u91cc\u58f0\u660eNamespace URI\uff0c\u8fd9\u6837\u5728\u89e3\u6790\u6807\u7b7e\u65f6\u624d\u80fd\u901a\u8fc7Namespace URI\u627e\u5230\u5bf9\u5e94\u7684NamespaceHandler\u3002\u5f15\u5165\uff1axmlns:context=",(0,i.kt)("a",{parentName:"p",href:"http://www.springframework.org/schema/contex"},"http://www.springframework.org/schema/contex")," ",(0,i.kt)("a",{parentName:"p",href:"http://www.springframework.org/schema/beans"},"http://www.springframework.org/schema/beans")),(0,i.kt)("p",null,"\u2467\u3001\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u5148\u662fisDefaultNamespace\u5224\u65ad\u662f\u4e0d\u662f\u9ed8\u8ba4\u6807\u7b7e\uff0c\u7136\u540e\u8fdb\u5165parseDefaultElement\u65b9\u6cd5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"rivate void parseDefaultElement(Element ele, BeanDefinitionParserDelegate delegate) {\n    // \u89e3\u6790<import>\u6807\u7b7e\n    if (delegate.nodeNameEquals(ele, IMPORT_ELEMENT)) {\n        importBeanDefinitionResource(ele);\n    }\n    // \u89e3\u6790<alias>\u6807\u7b7e\n    else if (delegate.nodeNameEquals(ele, ALIAS_ELEMENT)) {\n        processAliasRegistration(ele);\n    }\n    // \u89e3\u6790bean\u6807\u7b7e,\u6700\u5e38\u7528\uff0c\u8fc7\u7a0b\u6700\u590d\u6742\n    else if (delegate.nodeNameEquals(ele, BEAN_ELEMENT)) {\n        processBeanDefinition(ele, delegate);\n    }\n    // \u89e3\u6790<beans>\u6807\u7b7e\n    else if (delegate.nodeNameEquals(ele, NESTED_BEANS_ELEMENT)) {\n        // recurse\n        doRegisterBeanDefinitions(ele);\n     }\n }\n")),(0,i.kt)("p",null,"\u8fd9\u91cc\u9762\u4e3b\u8981\u662f\u5bf9import\u3001alias\u3001bean\u6807\u7b7e\u7684\u89e3\u6790\u4ee5\u53cabeans\u7684\u5b57\u6807\u7b7e\u7684\u9012\u5f52\u89e3\u6790\u3002"),(0,i.kt)("p",null,"\u2468\u3001\u8fd9\u91cc\u9488\u5bf9\u5e38\u7528\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"<bean>"),"\u6807\u7b7e\u4e2d\u7684\u65b9\u6cd5\u505a\u7b80\u5355\u4ecb\u7ecd\uff0c\u5176\u4ed6\u6807\u7b7e\u7684\u52a0\u8f7d\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u8fdb\u5165processBeanDefinition\u65b9\u6cd5\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'protected void processBeanDefinition(Element ele, BeanDefinitionParserDelegate delegate) {\n    //BeandefinitionHolder\u662fBeanDefinition\u7684\u5c01\u88c5\uff0c\u5c01\u88c5\u4e86BeanDefinition\uff0cbean\u7684\u540d\u5b57\u548c\u522b\u540d\uff0c\u7528\u5b83\u6765\u5b8c\u6210\u5411IOC\u5bb9\u5668\u6ce8\u518c\uff0c\n    //\u5f97\u5230BeanDefinitionHodler\u5c31\u610f\u5473\u7740BeanDefinition\u662f\u901a\u8fc7BeanDefinitionParseDelegate\u5bf9xml\u5143\u7d20\u6309\u7167bean\u7684\u89c4\u5219\u89e3\u6790\u5f97\u5230\u7684\n    BeanDefinitionHolder bdHolder = delegate.parseBeanDefinitionElement(ele);\n    if (bdHolder != null) {\n        bdHolder = delegate.decorateBeanDefinitionIfRequired(ele, bdHolder);\n        try {\n            // \u8fd9\u91cc\u662f\u5411IOC\u5bb9\u5668\u89e3\u6790\u6ce8\u518c\u5f97\u5230BeanDefinition\u7684\u5730\u65b9\n            BeanDefinitionReaderUtils.registerBeanDefinition(bdHolder, getReaderContext().getRegistry());\n        }\n        catch (BeanDefinitionStoreException ex) {\n            getReaderContext().error("Failed to register bean definition with name \'" +\n                    bdHolder.getBeanName() + "\'", ele, ex);\n        }\n        // \u5728BeanDefinition\u5411Ioc\u5bb9\u5668\u6ce8\u518c\u5b8c\u6210\u540e\u53d1\u9001\u6d88\u606f\n        getReaderContext().fireComponentRegistered(new BeanComponentDefinition(bdHolder));\n    }\n}\n')),(0,i.kt)("p",null,"\u2469\u3001\u8fdb\u5165parseBeanDefinitionElement(Element ele)\u65b9\u6cd5\u65b9\u6cd5\u3002"),(0,i.kt)("p",null,"\u6ce8\u610f\uff1aparseBeanDefinitionElement(Element ele)\u65b9\u6cd5\u4f1a\u8c03\u7528parseBeanDefinitionElement(ele, null)\u65b9\u6cd5\uff0c\u9700\u8981\u5f3a\u8c03\u4e00\u4e0b\u7684\u662fparseBeanDefinitionElement(ele, null)\u65b9\u6cd5\u4e2d\u4ea7\u751f\u4e86\u4e00\u4e2a\u62bd\u8c61\u7c7b\u578b\u7684BeanDefinition\u5b9e\u4f8b\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u9996\u6b21\u770b\u5230\u76f4\u63a5\u5b9a\u4e49BeanDefinition\u7684\u5730\u65b9\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u91cc\u9762\u4f1a\u5c06",(0,i.kt)("inlineCode",{parentName:"p"},"<bean>"),"\u6807\u7b7e\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\u5230BeanDefinition\u4e2d\uff0c\u5982\u679c\u5728\u89e3\u6790",(0,i.kt)("inlineCode",{parentName:"p"},"<bean>"),"\u6807\u7b7e\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9519\u8bef\u5219\u8fd4\u56denull\uff0c\u4e4b\u540e\u518d\u5bf9BeanDefinition\u8fdb\u884c\u5305\u88c5\uff0c\u5c06\u5b83\u4e0ebeanName,Alias\u7b49\u5c01\u88c5\u5230BeanDefinitionHolder \u5bf9\u8c61\u4e2d\uff0c\u7136\u540e\u8fd4\u56deBeanDefinitionHolder\u7c7b\u5bf9\u8c61\uff0c\u8be5\u90e8\u5206\u6e90\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public BeanDefinitionHolder parseBeanDefinitionElement(Element ele) {\n    return parseBeanDefinitionElement(ele, null);\n}\n \npublic BeanDefinitionHolder parseBeanDefinitionElement(Element ele, @Nullable BeanDefinition containingBean) {\n    // \u83b7\u53d6id\u548cname\u5c5e\u6027\n    String id = ele.getAttribute(ID_ATTRIBUTE);\n    String nameAttr = ele.getAttribute(NAME_ATTRIBUTE);\n    // \u83b7\u53d6\u522b\u540d\u5c5e\u6027\uff0c\u591a\u4e2a\u522b\u540d\u53ef\u7528,;\u9694\u5f00\n    List<String> aliases = new ArrayList<>();\n    if (StringUtils.hasLength(nameAttr)) {\n        String[] nameArr = StringUtils.tokenizeToStringArray(nameAttr, MULTI_VALUE_ATTRIBUTE_DELIMITERS);\n        aliases.addAll(Arrays.asList(nameArr));\n    }\n \n    String beanName = id;\n    if (!StringUtils.hasText(beanName) && !aliases.isEmpty()) {\n        beanName = aliases.remove(0);\n        if (logger.isTraceEnabled()) {\n            logger.trace("No XML \'id\' specified - using \'" + beanName +\n                    "\' as bean name and " + aliases + " as aliases");\n        }\n    }\n    // \u68c0\u67e5beanName\u662f\u5426\u91cd\u590d\n    if (containingBean == null) {\n        checkNameUniqueness(beanName, aliases, ele);\n    }\n    // \u5177\u4f53\u7684\u89e3\u6790\u5c01\u88c5\u8fc7\u7a0b\u8fd8\u5728\u8fd9\u4e2a\u65b9\u6cd5\u91cc\n    AbstractBeanDefinition beanDefinition = parseBeanDefinitionElement(ele, beanName, containingBean);\n    if (beanDefinition != null) {\n        if (!StringUtils.hasText(beanName)) {\n            try {\n                if (containingBean != null) {\n                    beanName = BeanDefinitionReaderUtils.generateBeanName(\n                            beanDefinition, this.readerContext.getRegistry(), true);\n                }\n                else {\n                    beanName = this.readerContext.generateBeanName(beanDefinition);\n                    // Register an alias for the plain bean class name, if still possible,\n                    // if the generator returned the class name plus a suffix.\n                    // This is expected for Spring 1.2/2.0 backwards compatibility.\n                    String beanClassName = beanDefinition.getBeanClassName();\n                    if (beanClassName != null &&\n                            beanName.startsWith(beanClassName) && beanName.length() > beanClassName.length() &&\n                            !this.readerContext.getRegistry().isBeanNameInUse(beanClassName)) {\n                        aliases.add(beanClassName);\n                    }\n                }\n                if (logger.isTraceEnabled()) {\n                    logger.trace("Neither XML \'id\' nor \'name\' specified - " +\n                            "using generated bean name [" + beanName + "]");\n                }\n            }\n            catch (Exception ex) {\n                error(ex.getMessage(), ele);\n                return null;\n            }\n        }\n        String[] aliasesArray = StringUtils.toStringArray(aliases);\n        return new BeanDefinitionHolder(beanDefinition, beanName, aliasesArray);\n    }\n \n    return null;\n}\n')),(0,i.kt)("p",null,"\u4e0a\u9762\u7684\u89e3\u6790\u8fc7\u7a0b\u53ef\u4ee5\u770b\u505a\u6839\u636exml\u6587\u4ef6\u5bf9",(0,i.kt)("inlineCode",{parentName:"p"},"<bean>"),"\u7684\u5b9a\u4e49\u751f\u6210BeanDefinition\u5bf9\u8c61\u7684\u8fc7\u7a0b\uff0c\u8fd9\u4e2aBeanDefinition\u5bf9\u8c61\u4e2d\u5c01\u88c5\u7684\u6570\u636e\u5927\u591a\u90fd\u662f\u4e0e",(0,i.kt)("inlineCode",{parentName:"p"},"<bean>"),"\u76f8\u5173\u7684\uff0c\u4f8b\u5982\uff1ainit-method,destory-method,factory-method,beanClass,descriptor\u3002\u6709\u4e86\u8fd9\u4e2aBeanDefinition\u4e2d\u5206\u88c5\u7684\u4fe1\u606f\uff0c\u5bb9\u5668\u624d\u80fd\u5bf9Bean\u914d\u7f6e\u8fdb\u884c\u5904\u7406\u4ee5\u53ca\u5b9e\u73b0\u5bb9\u5668\u7684\u7279\u6027\u3002\u81f3\u6b64\uff0c\u6211\u4eec\u7684BeanDefine\u5c31\u5df2\u7ecf\u8f7d\u5165\u5b8c\u6210\u4e86\u3002"),(0,i.kt)("p",null,"\u246a\u3001\u4e0b\u9762\u518d\u6765\u591a\u52a0\u4e00\u4e2a\u70b9\uff0c\u770b\u4e00\u4e0bbean\u7684\u5177\u4f53\u89e3\u6790\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public AbstractBeanDefinition parseBeanDefinitionElement(\n        Element ele, String beanName, @Nullable BeanDefinition containingBean) {\n \n    this.parseState.push(new BeanEntry(beanName));\n    // \u83b7\u53d6class\u540d\u79f0\u548c\u7236\u7c7b\u540d\u79f0\n    String className = null;\n    if (ele.hasAttribute(CLASS_ATTRIBUTE)) {\n        className = ele.getAttribute(CLASS_ATTRIBUTE).trim();\n    }\n    // \u89e3\u6790 parent \u5c5e\u6027\n    String parent = null;\n    if (ele.hasAttribute(PARENT_ATTRIBUTE)) {\n        parent = ele.getAttribute(PARENT_ATTRIBUTE);\n    }\n \n    try {\n        // \u521b\u5efaGenericBeanDefinition\u5bf9\u8c61\n        AbstractBeanDefinition bd = createBeanDefinition(className, parent);\n        // \u89e3\u6790bean\u6807\u7b7e\u7684\u5c5e\u6027\uff0c\u5e76\u628a\u89e3\u6790\u51fa\u6765\u7684\u5c5e\u6027\u8bbe\u7f6e\u5230BeanDefinition\u5bf9\u8c61\u4e2d\n        parseBeanDefinitionAttributes(ele, beanName, containingBean, bd);\n        bd.setDescription(DomUtils.getChildElementValueByTagName(ele, DESCRIPTION_ELEMENT));\n        //\u89e3\u6790bean\u4e2d\u7684meta\u6807\u7b7e\n        parseMetaElements(ele, bd);\n        //\u89e3\u6790bean\u4e2d\u7684lookup-method\u6807\u7b7e\n        parseLookupOverrideSubElements(ele, bd.getMethodOverrides());\n        //\u89e3\u6790bean\u4e2d\u7684replaced-method\u6807\u7b7e \n        parseReplacedMethodSubElements(ele, bd.getMethodOverrides());\n        //\u89e3\u6790bean\u4e2d\u7684constructor-arg\u6807\u7b7e\n        parseConstructorArgElements(ele, bd);\n        //\u89e3\u6790bean\u4e2d\u7684property\u6807\u7b7e \n        parsePropertyElements(ele, bd);\n        // \u89e3\u6790\u5b50\u5143\u7d20 qualifier \u5b50\u5143\u7d20\n        parseQualifierElements(ele, bd);\n \n        bd.setResource(this.readerContext.getResource());\n        bd.setSource(extractSource(ele));\n \n        return bd;\n    }\n    catch (ClassNotFoundException ex) {\n        error("Bean class [" + className + "] not found", ele, ex);\n    }\n    catch (NoClassDefFoundError err) {\n        error("Class that bean class [" + className + "] depends on not found", ele, err);\n    }\n    catch (Throwable ex) {\n        error("Unexpected failure during bean definition parsing", ele, ex);\n    }\n    finally {\n        this.parseState.pop();\n    }\n \n    return null;\n}\n')),(0,i.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u662f\u5177\u4f53\u751f\u6210BeanDefinition\u7684\u5730\u65b9\uff0cbean\u6807\u7b7e\u7684\u89e3\u6790\u6b65\u9aa4\u4ed4\u7ec6\u7406\u89e3\u5e76\u4e0d\u590d\u6742\uff0c\u5c31\u662f\u5c06\u4e00\u4e2a\u4e2a\u6807\u7b7e\u5c5e\u6027\u7684\u503c\u88c5\u5165\u5230\u4e86BeanDefinition\u5bf9\u8c61\u4e2d\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610fparseConstructorArgElements\u548cparsePropertyElements\u65b9\u6cd5\uff0c\u5206\u522b\u662f\u5bf9constructor-arg\u548cproperty\u6807\u7b7e\u7684\u89e3\u6790\uff0c\u89e3\u6790\u5b8c\u6210\u540e\u5206\u522b\u88c5\u5165\u4e86BeanDefinition\u5bf9\u8c61\u7684constructorArgumentValues\u548cpropertyValues\u4e2d\uff0c\u800c\u8fd9\u4e24\u4e2a\u5c5e\u6027\u5728c\u548cp\u6807\u7b7e\u7684\u89e3\u6790\u4e2d\u8fd8\u4f1a\u7528\u5230\uff0c\u800c\u4e14\u8fd8\u6d89\u53ca\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u8bbe\u8ba1\u601d\u60f3\u2014\u2014\u88c5\u9970\u5668\u6a21\u5f0f\u3002Bean\u6807\u7b7e\u89e3\u6790\u5b8c\u6210\u540e\u5c06\u751f\u6210\u7684BeanDefinition\u5bf9\u8c61\u3001bean\u7684\u540d\u79f0\u4ee5\u53ca\u522b\u540d\u4e00\u8d77\u5c01\u88c5\u5230\u4e86BeanDefinitionHolder\u5bf9\u8c61\u5e76\u8fd4\u56de\uff0c\u7136\u540e\u8c03\u7528\u4e86decorateBeanDefinitionIfRequired\u8fdb\u884c\u88c5\u9970\u3002"),(0,i.kt)("h2",{id:"43beandefinition\u7684\u6ce8\u518c"},"4.3BeanDefinition\u7684\u6ce8\u518c"),(0,i.kt)("p",null,"\u5728\u5b8c\u6210\u4e86BeanDefinition\u7684\u8f7d\u5165\u548c\u89e3\u6790\u540e\uff0c\u5c31\u8981\u5bf9\u5b83\u8fdb\u884c\u6ce8\u518c\u3002\u6211\u4eec\u77e5\u9053\u6700\u7ec8Bean\u914d\u7f6e\u4f1a\u88ab\u89e3\u6790\u6210BeanDefinition\u5e76\u4e0ebeanName\uff0cAlias\u4e00\u540c\u5c01\u88c5\u5230BeanDefinitionHolder\u7c7b\u4e2d\uff0c\u7136\u540e\u8fd4\u56de\u8fd9\u4e2a\u5bf9\u8c61\uff0c\u6240\u4ee5\u6211\u4eec\u987a\u7740BeanDefinitionHolder\u7c7b\u521b\u5efa\u7684\u5730\u65b9\uff0c\u4e5f\u5c31\u662fDefaultBeanDefinitionDocumentReader\u7684processBeanDefinition()\u65b9\u6cd5\u7ee7\u7eed\u5f80\u4e0b\u770b\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'protected void processBeanDefinition(Element ele, BeanDefinitionParserDelegate delegate) {\n    //BeandefinitionHolder\u662fBeanDefinition\u7684\u5c01\u88c5\uff0c\u5c01\u88c5\u4e86BeanDefinition\uff0cbean\u7684\u540d\u5b57\u548c\u522b\u540d\uff0c\u7528\u5b83\u6765\u5b8c\u6210\u5411IOC\u5bb9\u5668\u6ce8\u518c\uff0c\n    //\u5f97\u5230BeanDefinitionHodler\u5c31\u610f\u5473\u7740BeanDefinition\u662f\u901a\u8fc7BeanDefinitionParseDelegate\u5bf9xml\u5143\u7d20\u6309\u7167bean\u7684\u89c4\u5219\u89e3\u6790\u5f97\u5230\u7684\n    BeanDefinitionHolder bdHolder = delegate.parseBeanDefinitionElement(ele);\n    if (bdHolder != null) {\n        bdHolder = delegate.decorateBeanDefinitionIfRequired(ele, bdHolder);\n        try {\n            // \u8fd9\u91cc\u662f\u5411IOC\u5bb9\u5668\u89e3\u6790\u6ce8\u518c\u5f97\u5230BeanDefinition\u7684\u5730\u65b9\n            BeanDefinitionReaderUtils.registerBeanDefinition(bdHolder, getReaderContext().getRegistry());\n        }\n        catch (BeanDefinitionStoreException ex) {\n            getReaderContext().error("Failed to register bean definition with name \'" +\n                    bdHolder.getBeanName() + "\'", ele, ex);\n        }\n        // \u5728BeanDefinition\u5411Ioc\u5bb9\u5668\u6ce8\u518c\u5b8c\u6210\u540e\u53d1\u9001\u6d88\u606f\n        getReaderContext().fireComponentRegistered(new BeanComponentDefinition(bdHolder));\n    }\n}\n')),(0,i.kt)("p",null,"\u7136\u540e\u8ddf\u8e2a\u5230BeanDefinitionReaderUtils\u7684registerBeanDefinition()\u65b9\u6cd5\uff0c\u8fd9\u91cc\u4f1a\u4f20\u5165\u4e0a\u4e00\u6b65\u7684BeanDefinitionHolder\u5bf9\u8c61\uff0c\u5e76\u4e14\u5c06BeanDefinition\u6ce8\u518c\u5230IoC\u5bb9\u5668\u4e2d\u3002\u8fdb\u5165BeanDefinitionReaderUtils\u7c7b\u7684registerBeanDefinition\u65b9\u6cd5\u5982\u4e0b\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public static void registerBeanDefinition(\n        BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry)\n        throws BeanDefinitionStoreException {\n \n    // \u6ce8\u518cbeanDefinition!!\n    String beanName = definitionHolder.getBeanName();\n    registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());\n \n    // \u5982\u679c\u6709\u522b\u540d\u7684\u8bdd\u4e5f\u6ce8\u518c\u8fdb\u53bb\n    String[] aliases = definitionHolder.getAliases();\n    if (aliases != null) {\n        for (String alias : aliases) {\n            registry.registerAlias(beanName, alias);\n        }\n    }\n}\n")),(0,i.kt)("p",null,"\u4e4b\u540e\u4f1a\u8c03\u7528BeanDefinitionRegistry\u63a5\u53e3\u7684registerBeanDefinition( beanName, bdHolder.getBeanDefinition())\u65b9\u6cd5\uff0c\u800c\u5bf9\u4e8eIoC\u5bb9\u5668\u4e2d\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u7c7bDefaultListableBeanFactory\u5b9e\u73b0\u4e86\u8be5\u63a5\u53e3\u7684\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u7684\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u5c06BeanDefinition\u5b58\u653e\u81f3DefaultListableBeanFactory\u5bf9\u8c61\u7684beanDefinitionMap\u4e2d\uff0c\u5f53\u521d\u59cb\u5316\u5bb9\u5668\u8fdb\u884cbean\u521d\u59cb\u5316\u65f6\uff0c\u5728bean\u7684\u751f\u547d\u5468\u671f\u5206\u6790\u91cc\u5fc5\u7136\u4f1a\u5728\u8fd9\u4e2abeanDefinitionMap\u4e2d\u83b7\u53d6beanDefition\u5b9e\u4f8b\u3002\u6211\u4eec\u53ef\u4ee5\u5728DefaultListableBeanFactory\u4e2d\u770b\u5230\u6b64Map\u7684\u5b9a\u4e49\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"/** Map of bean definition objects, keyed by bean name. */\nprivate final Map<String, BeanDefinition> beanDefinitionMap = new ConcurrentHashMap<>(256);\n")),(0,i.kt)("p",null,"\u4e0b\u9762\u6211\u4eec\u5728\u6765\u770b\u4e00\u4e0b\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5982\u5c06BeanDefinition\u5b58\u653e\u81f3beanDefinitionMap\u4e2d\u7684\uff0cDefaultListableBeanFactory\u4e2d\u5b9e\u73b0\u7684registerBeanDefinition( beanName, bdHolder.getBeanDefinition() )\u65b9\u6cd5\u5177\u4f53\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public void registerBeanDefinition(String beanName, BeanDefinition beanDefinition)\n            throws BeanDefinitionStoreException {\n \n        Assert.hasText(beanName, "Bean name must not be empty");\n        Assert.notNull(beanDefinition, "BeanDefinition must not be null");\n \n        if (beanDefinition instanceof AbstractBeanDefinition) {\n            try {\n                ((AbstractBeanDefinition) beanDefinition).validate();\n            }\n            catch (BeanDefinitionValidationException ex) {\n                throw new BeanDefinitionStoreException(beanDefinition.getResourceDescription(), beanName,\n                        "Validation of bean definition failed", ex);\n            }\n        }\n \n        //\u6b64\u5904\u68c0\u67e5\u662f\u4e0d\u662f\u6709\u76f8\u540c\u540d\u5b57\u7684Bean\u5b58\u5728\n        //\u5982\u679c\u540d\u5b57\u76f8\u540c\u53c8\u4e0d\u5141\u8bb8\u8986\u76d6\uff0c\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38BeanDefinitionOverrideException\n        BeanDefinition existingDefinition = this.beanDefinitionMap.get(beanName);\n        if (existingDefinition != null) {\n            if (!isAllowBeanDefinitionOverriding()) {\n                throw new BeanDefinitionOverrideException(beanName, beanDefinition, existingDefinition);\n            }\n            else if (existingDefinition.getRole() < beanDefinition.getRole()) {\n                // e.g. was ROLE_APPLICATION, now overriding with ROLE_SUPPORT or ROLE_INFRASTRUCTURE\n                if (logger.isInfoEnabled()) {\n                    logger.info("Overriding user-defined bean definition for bean \'" + beanName +\n                            "\' with a framework-generated bean definition: replacing [" +\n                            existingDefinition + "] with [" + beanDefinition + "]");\n                }\n            }\n            else if (!beanDefinition.equals(existingDefinition)) {\n                if (logger.isDebugEnabled()) {\n                    logger.debug("Overriding bean definition for bean \'" + beanName +\n                            "\' with a different definition: replacing [" + existingDefinition +\n                            "] with [" + beanDefinition + "]");\n                }\n            }\n            else {\n                if (logger.isTraceEnabled()) {\n                    logger.trace("Overriding bean definition for bean \'" + beanName +\n                            "\' with an equivalent definition: replacing [" + existingDefinition +\n                            "] with [" + beanDefinition + "]");\n                }\n            }\n            //\u5b58\u50a8Bean\uff08Bean\u540d\u5b57\u4f5c\u4e3akey\uff0cBeanDefinition\u4f5c\u4e3avalue\uff09\n            this.beanDefinitionMap.put(beanName, beanDefinition);\n        }\n        else {\n            if (hasBeanCreationStarted()) {\n                //\u6ce8\u518c\u7684\u8fc7\u7a0b\u9700\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\n                synchronized (this.beanDefinitionMap) {\n                    //\u5c06\u83b7\u53d6\u5230\u7684BeanDefinition\u653e\u5165Map\u4e2d\uff0c\u5bb9\u5668\u64cd\u4f5c\u4f7f\u7528bean\u65f6\u901a\u8fc7\u8fd9\u4e2aHashMap\u627e\u5230\u5177\u4f53\u7684BeanDefinition\n                    //\u5b58\u50a8Bean\uff08Bean\u540d\u5b57\u4f5c\u4e3akey\uff0cBeanDefinition\u4f5c\u4e3avalue\uff09\n                    this.beanDefinitionMap.put(beanName, beanDefinition);\n                    List<String> updatedDefinitions = new ArrayList<>(this.beanDefinitionNames.size() + 1);\n                    updatedDefinitions.addAll(this.beanDefinitionNames);\n                    updatedDefinitions.add(beanName);\n                    this.beanDefinitionNames = updatedDefinitions;\n                    removeManualSingletonName(beanName);\n                }\n            }\n            else {\n                // Still in startup registration phase\n                this.beanDefinitionMap.put(beanName, beanDefinition);\n                this.beanDefinitionNames.add(beanName);\n                removeManualSingletonName(beanName);\n            }\n            this.frozenBeanDefinitionNames = null;\n        }\n \n        if (existingDefinition != null || containsSingleton(beanName)) {\n            resetBeanDefinition(beanName);\n        }\n        else if (isConfigurationFrozen()) {\n            clearByTypeCache();\n        }\n    }\n')),(0,i.kt)("p",null,"\u628a\u6240\u6709\u7684BeanDefinition(\u61d2\u52a0\u8f7d\u9664\u5916\uff09\u90fd\u5b58\u5165IOC\u5bb9\u5668\u4e2d\u7684HashMap\u540e\uff0c\u6ce8\u518c\u5c31\u7ed3\u675f\u4e86\u3002\u4f46\u662f\u6ce8\u610f\uff0c\u4ee5\u4e0a\u4ec5\u4ec5\u662fBeanDefinition\u7684\u8f7d\u5165\u3001\u8f7d\u5165\u548c\u6ce8\u518c\uff0cBean\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u5e76\u4e0d\u4f1a\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5b8c\u6210\uff01\u540e\u9762\u8fd8\u9700\u8981\u8c03\u7528\u4e00\u7cfb\u5217\u65b9\u6cd5\u624d\u4f1a\u5b8c\u6210\u521d\u59cb\u5316\u3002"))}u.isMDXComponent=!0}}]);